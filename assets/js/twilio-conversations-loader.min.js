(function e$$0(k,l,b){function g(c,d){if(!l[c]){if(!k[c]){var a="function"==typeof require&&require;if(!d&&a)return a(c,!0);if(e)return e(c,!0);a=Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a;}a=l[c]={exports:{}};k[c][0].call(a.exports,function(a){var b=k[c][1][a];return g(b?b:a)},a,a.exports,e$$0,k,l,b)}return l[c].exports}for(var e="function"==typeof require&&require,f=0;f<b.length;f++)g(b[f]);return g})({1:[function(h,k,l){function b(d,f){if(!(this instanceof b))return new b(d,
f);var m=this;e.call(this);var g=new c,h=null,k=new c,l=new a("Conversation",d._logLevel);Object.defineProperties(this,{_dialogs:{value:g},_endpoint:{value:d},_localMedia:{set:function(a){h=a}},_log:{value:l},localMedia:{enumerable:!0,get:function(){return h}},participants:{enumerable:!0,value:k},sid:{enumerable:!0,get:function(){var a=null;g.forEach(function(c){a=a||c.conversationSid});return a}}});f=f||[];f.forEach(function(a){m._addDialog(a)});return Object.freeze(this)}var g=h("./util/constants"),
e=h("events").EventEmitter;l=h("util").inherits;h("./media/track");var f=h("./participant"),c=h("./util/set"),d=h("q"),a=h("./util/log"),m=g.twilioErrors;l(b,e);b.prototype._addDialog=function(a){if(this._dialogs.has(a))return this;var c=this;this._localMedia=this.localMedia||a.localMedia;var b=new f(this,a);this._dialogs.add(a);this.participants.add(b);setTimeout(function(){c.emit("participantConnected",b);setTimeout(function(){b.on("trackAdded",function z(a){if(!c.participants.has(b))return b.removeListener("trackAdded",
z);c.emit("trackAdded",b,a)});b.on("trackRemoved",function w(a){if(!c.participants.has(b))return b.removeListener("trackRemoved",w);c.emit("trackRemoved",b,a)});b.media.audioTracks.forEach(function(a){b.emit("trackAdded",a)});b.media.videoTracks.forEach(function(a){b.emit("trackAdded",a)})})});a.once("ended",function(){c._removeDialog(a)});return this};b.prototype._removeDialog=function(a){var c=this,b=null;this.participants.forEach(function(d){d._dialog===a&&(b=d,c.participants.delete(b))});this._dialogs.delete(a);
this.emit("participantDisconnected",b);this._dialogs.length||this.emit("ended",this);return this};b.prototype.getStats=function(){var a=[];this._dialogs.forEach(function(c){a.push(c.getStats())});return d.all(a)};b.prototype.leave=function(){var a=this,c=this._endpoint,b=[];this._dialogs.forEach(function(d){b.push(d.end().then(function(){c.conversations.delete(a)},function(b){c.conversations.delete(a);throw b;}))});0===b.length&&c.conversations.delete(this);return d.all(b).then(function(){return a},
function(b){c.conversations.delete(a);throw b;})};b.prototype.invite=function(a){function c(b){b.address===a&&(e.removeListener("participantConnected",c),f.resolve(b))}a||this._log.throw(m.INVALID_ARGUMENT,"No address was provided");var b;this._dialogs.forEach(function(a){b=b||a});var e=this,f=d.defer();this.on("participantConnected",c);setTimeout(function(){e.removeListener("participantConnected",c);var b=m.CONVERSATION_INVITE_FAILED.clone("Invite to Participant timed out.");e.emit("participantFailed",
a,b);f.reject(b)},g.DEFAULT_CALL_TIMEOUT);return b.refer(a).then(function(){return f.promise},function(b){e.emit("participantFailed",a,b);e.removeListener("participantConnected",c);throw b;})};Object.freeze(b.prototype);k.exports=b},{"./media/track":5,"./participant":6,"./util/constants":19,"./util/log":21,"./util/set":23,events:31,q:144,util:35}],2:[function(h,k,l){function b(e,f){if(!(this instanceof b))return new b(e,f);var h=this;d.call(this);f=w.withDefaults(f,{debug:g.DEBUG,eventGateway:g.EVENT_GATEWAY,
userAgent:A,logLevel:"warn"});var k=f.logLevel,l=new m("Endpoint",k);try{e=new p(e)}catch(r){l.throw(c.INVALID_TOKEN,r.message)}var F=null;f.iceServers&&(w.isValidIceServerArray(f.iceServers)||l.throw(c.INVALID_ARGUMENT,"Invalid ICE Servers"),F=new n(f.iceServers));var F=(F||w.fetchIceServers(e,l)).then(function(a){a=w.separateIceServers(a);h._userAgent._stunServers=a.stunServers;h._userAgent._turnServers=a.turnServers}),B=new y,x=f.eventGateway,H=new y,G=new y,I=new f.userAgent(e,f);I.on("invite",
function(b){var c=b.conversationSid,d=b.participantSid,e=null;B.forEach(function(a){a.sid===c&&(e=e||a)});if(e)return b.accept({localMedia:e.localMedia}).then(e._addDialog.bind(e));if(G.has(c+d))return b.reject();var f=null;H.forEach(function(a){a.conversationSid===c&&a.participantSid===d&&(f=f||a)});if(f)return f._inviteServerTransactions.push(b);var m=new a(h,b);H.add(m);m._promise.then(function(a){H.delete(m);B.add(a)},function(){H.delete(m);G.add(c+d);setTimeout(function(){G.delete(c+d)},3*g.DEFAULT_CALL_TIMEOUT)});
h.emit("invite",m)});I.on("dialogCreated",function(a){new z(x,a,k)});Object.defineProperties(this,{_iceServersPromise:{value:F},_log:{value:l},_logLevel:{value:k},_options:{value:f},_userAgent:{value:I},address:{enumerable:!0,get:function(){return this._userAgent.token.address}},conversations:{enumerable:!0,value:B},isListening:{enumerable:!0,get:function(){return this._userAgent.isRegistered}},invites:{enumerable:!0,value:H},token:{enumerable:!0,get:function(){return this._userAgent.token}}});return Object.freeze(this)}
l=h("util").inherits;var g=h("./util/constants"),e=h("./conversation"),f=h("./util/cancelablepromise"),c=g.twilioErrors,d=h("events").EventEmitter;h("./webrtc/getusermedia");var a=h("./invite"),m=h("./util/log"),n=h("q"),p=h("./scopedauthenticationtoken"),y=h("es6-set"),A=h("./signaling/sipjsuseragent"),z=h("./statsreporter"),w=h("./util"),r=h("./media").LocalMedia;l(b,d);b.prototype.unlisten=function(){if(!this.isListening)return new n(this);var a=this;return this._userAgent.unregister().then(function(){return a})};
b.prototype.listen=function(a){try{a=a?new p(a,this._log):this.token}catch(b){this._log.throw(c.INVALID_TOKEN,b.message)}if(this.isListening)return new n(this);var d=this;return this._iceServersPromise.then(function(){return d._userAgent.register(a)}).then(function(){return d},function(a){var b=w.getOrNull(a,"headers.X-Twilio-Error.0.raw");(a=a.cause)?d._log.throw(c.LISTEN_FAILED,"Received SIP error: "+a):d._log.throw(c.LISTEN_FAILED,"Gateway responded with: "+b)})};b.prototype.createConversation=
function(a,b){a||this._log.throw(c.INVALID_ARGUMENT,"No address was provided");var d=b&&b.localMedia,m=b&&b.localStream,p=b&&b.localStreamConstraints;!d||d instanceof r||this._log.throw(c.INVALID_ARGUMENT,"Invalid local media");m&&"object"!==typeof m&&this._log.throw(c.INVALID_ARGUMENT,"Invalid local media stream");p&&"undefined"===typeof p.audio&&"undefined"===typeof p.video&&this._log.throw(c.INVALID_ARGUMENT,"Invalid local media stream constraints");var n,g=a.forEach?a:[a];b=w.withDefaults(b,this._options);
var h=this,d=d||r.getLocalMedia(b),d=new f(d),m=d.then(function(a){b.localMedia=a;return h._iceServersPromise}).then(function(){var a=new e(h),d=g.map(function(a){return h._userAgent.invite(a,b)}),f=d.map(function(b){return b.then(function(b){a._addDialog(b)},function(a){var b="An unknown error occurred";a.canceled?b="Conversation invite was canceled":a.rejected?b="Conversation invite was rejected":"ignored"===a?b="Conversation invite timed out":a.failed&&(b="Unable to reach Participant");h._log.throw(c.CONVERSATION_CREATE_FAILED,
b)})});n=w.any(f);return n.then(function(){h.conversations.add(a);a.once("ended",function(){h.conversations.delete(a)});return a},function(a){"canceled"===a.message&&d.forEach(function(a){a.cancel()});throw a;})},function(a){a&&-1<["PermissionDeniedError","PERMISSION_DENIED"].indexOf(a.name)&&h._log.throw(c.MEDIA_ACCESS_DENIED);throw a;});Object.defineProperties(m,{cancel:{value:function(){n?n.cancel():d.cancel()}}});return m};Object.freeze(b.prototype);k.exports=b},{"./conversation":1,"./invite":3,
"./media":4,"./scopedauthenticationtoken":7,"./signaling/sipjsuseragent":15,"./statsreporter":17,"./util":20,"./util/cancelablepromise":18,"./util/constants":19,"./util/log":21,"./webrtc/getusermedia":26,"es6-set":91,events:31,q:144,util:35}],3:[function(h,k,l){function b(a,c){if(!(this instanceof b))return new b(a,c);var d=this;e.call(this);var p=null,g=c.from,h=c.to,k=f.defer(),l=[c];Object.defineProperties(this,{_conversation:{set:function(a){p=a},get:function(){return p}},_deferred:{value:k},
_endpoint:{value:a},_inviteServerTransaction:{value:c},_inviteServerTransactions:{value:l},_promise:{value:k.promise},accepted:{enumerable:!0,get:function(){return l.reduce(function(a,b){return a||b.accepted},!1)}},canceled:{enumerable:!0,get:function(){return l.reduce(function(a,b){return a&&b.canceled},!0)}},from:{enumerable:!0,value:g},participantAddresses:{enumerable:!0,get:function(){return l.map(function(a){return a.from})}},rejected:{enumerable:!0,get:function(){return l.reduce(function(a,
b){return a||b.accepted},!1)?!1:l.reduce(function(a,b){return a||b.rejected},!1)}},conversationSid:{enumerable:!0,value:c.conversationSid},status:{enumerable:!0,get:function(){switch(!0){case this.accepted:return"accepted";case this.rejected:return"rejected";case this.canceled:return"canceled";default:return"pending"}}},to:{enumerable:!0,value:h}});c.once("canceled",function(){d.emit("canceled",d)});return Object.freeze(this)}var g=h("./conversation"),e=h("events").EventEmitter;l=h("util").inherits;
var f=h("q"),c=h("./util"),d=h("./media").LocalMedia;l(b,e);b.prototype.accept=function(a){var b=this;if(this.accepted)return new f(this._conversation);a=a||{};return d.getLocalMedia(a).then(function(d){a.localMedia=d;d=b._inviteServerTransactions.map(function(c){return c.accept(a).then(function(a){b._conversation||(b._conversation=new g(b._endpoint),b._deferred.resolve(b._conversation));b._conversation._addDialog(a);return a})});return c.race(d).then(function(){setTimeout(function(){b.emit("accepted",
b)});return b._conversation},function(a){setTimeout(function(){b.emit("failed",b)});b._deferred.reject(a);throw a;})})};b.prototype.reject=function(){var a=this;return this.rejected?new f(this):this._inviteServerTransaction.reject().then(function(){setTimeout(function(){a.emit("rejected",a)});return a},function(b){setTimeout(function(){a.emit("rejected",a)});return a})};Object.freeze(b.prototype);k.exports=b},{"./conversation":1,"./media":4,"./util":20,events:31,q:144,util:35}],4:[function(h,k,l){function b(a){f.call(this);
a=new d;var b=new m,c=new m,e=new m;Object.defineProperties(this,{attachments:{enumerable:!0,value:a},audioTracks:{enumerable:!0,value:b},mediaStreams:{enumerable:!0,value:c},videoTracks:{enumerable:!0,value:e}});return this}function g(){if(!(this instanceof g))return new g;b.call(this);var a=null;Object.defineProperties(this,{_needs:{value:new m},_nextUserMedia:{get:function(){return a},set:function(b){a=b}}});return Object.freeze(this)}function e(a){this.mediaStreams.add(a);a.getAudioTracks().forEach(function(b){b=
new n(a,b);this._addTrack(b)},this);a.getVideoTracks().forEach(function(b){b=new p(a,b);this._addTrack(b)},this);return this}var f=h("events").EventEmitter,c=h("../webrtc/getusermedia");l=h("util").inherits;var d=h("es6-map"),a=h("q"),m=h("es6-set");h=h("./track");var n=h.AudioTrack,p=h.VideoTrack;l(b,f);b.prototype._addStream=e;b.prototype._addTrack=function(a){var b=this;this.mediaStreams.add(a.mediaStream);("audio"===a.kind?this.audioTracks:this.videoTracks).add(a);a.once("ended",function(c){b._removeTrack(a)});
this.emit("trackAdded",a);return this};b.prototype._attachTrack=function(a,b,c){var d=this,e=c.attach();this instanceof g&&c instanceof n&&(e.muted=!0);a.appendChild(e);b.set(c,e);c.once("ended",function(){d._detachTrack(a,b,c)});return this};b.prototype._detachTrack=function(a,b,c){var d=b.get(c);c.detach(d);a.removeChild(d);b.delete(c);return this};b.prototype._removeTrack=function(a){this.mediaStreams.delete(a.mediaStream);("audio"===a.kind?this.audioTracks:this.videoTracks).delete(a);this.emit("trackRemoved",
a);return this};b.prototype.attach=function(a){var b=this;if((!a||"string"===typeof a)&&"undefined"===typeof document)throw Error("document is undefined");if(a&&"string"===typeof a&&(a=document.querySelector(a),!a))throw Error("document.querySelector returned nothing");a&&this.attachments.has(a)&&this.detach(a);a=a||document.createElement("div");var c=new d;[this.audioTracks,this.videoTracks].forEach(function(b){b.forEach(function(b){this._attachTrack(a,c,b)},this)},this);this.on("trackAdded",function r(d){if(!b.attachments.has(a))return b.removeListener("trackAdded",
r);b._attachTrack(a,c,d)});this.attachments.set(a,c);return a};b.prototype.detach=function(a){if(a&&"string"===typeof a&&"undefined"===typeof document)throw Error("document is undefined");if(a)if("string"===typeof a)[].forEach.call(document.querySelectorAll(a),function(a){this.detach(a)},this);else{if(this.attachments.has(a)){var b=this.attachments.get(a);this.attachments.delete(a);b.forEach(function(c,d){this._detachTrack(a,b,d)},this)}}else this.attachments.forEach(function(a,b){this.detach(b)},
this);return this};g.getLocalMedia=function(b){b=b||{};if(b.localMedia)return new a(b.localMedia);var d=new g;return b.localStream?(d.addStream(b.localStream),new a(d.addStream(b.localStream))):c(b.localStreamConstraints).then(function(a){return d.addStream(a)})};l(g,b);g.prototype.addMicrophone=function(){var b=this,d=null;this.audioTracks.forEach(function(a){d=d||"microphone"===a.label&&a});return d?new a(d):c({audio:!0,video:!1}).then(function(a){a=new n(a,a.audioTracks[0]);b._addTrack(a);return a})};
g.prototype.removeMicrophone=function(){var a=null;this.audioTracks.forEach(function(b){a=a||"microphone"===b.label&&b});return a?this._removeTrack(a):null};g.prototype.addCamera=function(){var b=this,d=null;this.videoTracks.forEach(function(a){d=d||"camera"===a.label&&a});return d?new a(d):c({audio:!1,video:!0}).then(function(a){a=new p(a,a.videoTracks[0]);b._addTrack(a);return a})};g.prototype.removeCamera=function(){var a=null;this.videoTracks.forEach(function(b){a=a||"camera"===b.label&&b});return a?
this._removeTrack(a):null};g.prototype.addStream=e;g.prototype._removeTrack=function(a){var d=this;b.prototype._removeTrack.call(this,a);a.mediaStream.stop();[this.audioTracks,this.videoTracks].forEach(function(b){b.forEach(function(b){b.mediaStream===a.mediaStream&&(this._removeTrack(b),this._needs.add(b.label),this._nextUserMedia||(this._nextUserMedia=setTimeout(function(){d._nextUserMedia=null;var a=d._needs.has("camera");d._needs.delete("camera");var b=d._needs.has("microphone");d._needs.delete("microphone");
if(a||b)a&&!b?d.addCamera():b&&!a?d.addMicrophone():c().then(d.addStream.bind(d))})))},this)},this);this._needs.delete(a.label);return a};b.LocalMedia=g;k.exports=b},{"../webrtc/getusermedia":26,"./track":5,"es6-map":36,"es6-set":91,events:31,q:144,util:35}],5:[function(h,k,l){function b(a,b){p.call(this);Object.defineProperties(this,{label:{enumerable:!0,value:"audio"===b.kind?"microphone":"camera"},kind:{enumerable:!0,value:b.kind},mediaStream:{enumerable:!0,value:a},mediaStreamTrack:{enumerable:!0,
value:b}});var c=this;b.onended=function(){c.emit("ended",c)}}function g(a,c){if(!(this instanceof g))return new g(a,c);b.call(this,a,c);Object.defineProperties(this,{muted:{enumerable:!0,get:function(){return!c.enabled},set:function(a){c.enabled=!a}},audioElements:{enumerable:!0,value:new y}});return Object.freeze(this)}function e(a){a.removeAttribute("src");return a}function f(a,b){if("undefined"!==typeof window&&"undefined"!==typeof navigator)return"function"===typeof navigator.webkitGetUserMedia?
a.src=(window.URL||window.webkitURL).createObjectURL(b):"function"===typeof navigator.mozGetUserMedia&&(a.mozSrcObject=b),a.play(),a;throw Error("Cannot attach to <audio> element");}function c(e,f){if(!(this instanceof c))return new c(e,f);b.call(this,e,f);Object.defineProperties(this,{paused:{enumerable:!0,get:function(){return!f.enabled},set:function(a){f.enabled=!a}},videoElements:{value:new y}});e.onaddtrack=function(){this.videoElements.forEach(function(b){d(b);a(b,e)})}.bind(this);return Object.freeze(this)}
function d(a){a.removeAttribute("src");return a}function a(a,b){if("undefined"!==typeof window&&"undefined"!==typeof navigator)return"function"===typeof navigator.webkitGetUserMedia?a.src=(window.URL||window.webkitURL).createObjectURL(b):"function"===typeof navigator.mozGetUserMedia&&(a.mozSrcObject=b),a.muted=!0,a.play(),a;throw Error("Cannot attach to <video> element");}function m(b,c){if((!c||"string"===typeof c)&&"undefined"===typeof document)throw Error("document is undefined");if("string"===
typeof c&&(c=document.querySelector(c),!c))throw Error("document.querySelector returned nothing");c=c||document.createElement(b.kind);var d,e;"audio"===b.kind?(d=f,e=b.audioElements):(d=a,e=b.videoElements);if(e.has(c))return c;c=d(c,b.mediaStream);e.add(c);return c}function n(a,b){if((!b||"string"===typeof b)&&"undefined"===typeof document)throw Error("document is undefined");if("string"===typeof b)return[].map.call(document.querySelectorAll(b),function(b){a.detach(b);return b});var c,f;"audio"===
a.kind?(c=e,f=a.audioElements):(c=d,f=a.videoElements);if(b)return c(b),f.delete(b),[b];var m=[];f.forEach(function(a){m.push(a);this.detach(a)},a);return m}var p=h("events").EventEmitter;l=h("util").inherits;var y=h("es6-set");l(b,p);b.prototype.stop=function(){this.mediaStreamTrack.stop();return this};l(g,b);g.prototype.attach=function(a){return m(this,a)};g.prototype.detach=function(a){return n(this,a)};l(c,b);c.prototype.attach=function(a){return m(this,a)};c.prototype.detach=function(a){return n(this,
a)};b.AudioTrack=g;b.VideoTrack=c;k.exports=b},{"es6-set":91,events:31,util:35}],6:[function(h,k,l){function b(e,f){if(!(this instanceof b))return new b(e,f);g.call(this);var c=f.remoteMedia;Object.defineProperties(this,{_dialog:{value:f},address:{enumerable:!0,value:f.remote},conversation:{enumerable:!0,value:e},media:{enumerable:!0,value:c},peerConnection:{enumerable:!0,value:f&&f.session&&f.session.mediaHandler&&f.session.mediaHandler.peerConnection||null},sid:{enumerable:!0,value:null}});c.on("trackAdded",
this.emit.bind(this,"trackAdded"));c.on("trackRemoved",this.emit.bind(this,"trackRemoved"));return Object.freeze(this)}var g=h("events").EventEmitter;h=h("util").inherits;h(b,g);Object.freeze(b.prototype);k.exports=b},{events:31,util:35}],7:[function(h,k,l){function b(e){if(e instanceof b)return e;if(!(this instanceof b))return new b(e);var c=g(e),d=null,a=!1,m=!1,n=new Date(1E3*c.exp);(c.grants||[]).forEach(function(b){var c=b.res.match(/^sip:(.*)@/);c&&(d=c[1],a=-1!==b.act.indexOf("invite"),m=-1!==
b.act.indexOf("listen"))});Object.defineProperties(this,{accountSid:{enumerable:!0,value:c.sub},address:{enumerable:!0,value:d},canInvite:{enumerable:!0,value:a},canListen:{enumerable:!0,value:m},expires:{enumerable:!0,value:n},isExpired:{enumerable:!0,get:function(){return new Date>=n}},jwt:{enumerable:!0,value:e},signingKeySid:{enumerable:!0,value:c.iss}});return Object.freeze(this)}function g(b){b=b.split(".");if(3!==b.length)throw Error("Token is invalid or malformed");b=e.base64URL.decode(b[1]);
return JSON.parse(b)}var e=h("./util");k.exports=b},{"./util":20}],8:[function(h,k,l){function b(b,a,c,f,p,h,k){function l(a,b){if(w.ended)p.removeListener("trackAdded",t),p.removeListener("trackRemoved",u);else{var c=!a,d=k.getLocalStreams();if(d){var e=!1;d.forEach(function(a){a===b.mediaStream&&(e=!0)});a&&!e?(k.addStream(b.mediaStream),w._reinvite()):c&&e&&(k.removeStream(b.mediaStream),w._reinvite())}}}var w=this;e.call(this);var r=!1,v=null;Object.defineProperties(this,{_ended:{set:function(a){r=
a}},_sampleInterval:{get:function(){return v},set:function(a){v=a}},callSid:{enumerable:!0,value:f},conversationSid:{enumerable:!0,value:c},ended:{enumerable:!0,get:function(){return r}},localMedia:{enumerable:!0,value:p},peerConnection:{enumerable:!0,value:k},remote:{enumerable:!0,value:a},remoteMedia:{enumerable:!0,value:h},userAgent:{enumerable:!0,value:b}});var t=l.bind(null,!0),u=l.bind(null,!1);p.on("trackAdded",t);p.on("trackRemoved",u);try{g(this,1E3)}catch(C){throw console.error(C),C;}return this}
function g(b,a){var c=b.peerConnection;b._sampleInterval=setInterval(function(){f(c,function(a,c){a||b.emit("stats",c)})},a);b.once("ended",function(){b._sampleInterval&&(clearInterval(b._sampleInterval),b._sampleInterval=null)})}var e=h("events").EventEmitter,f=h("../webrtc/getstatistics");l=h("util").inherits;var c=h("q");l(b,e);b.prototype.end=function(){if(this.ended)throw Error("Dialog already ended");this._ended=!0;var b=this,a=c.defer();setTimeout(function(){a.resolve(b);b.emit("ended",b)});
return a.promise};b.prototype._reinvite=function(){var b=this,a=c.defer();setTimeout(function(){a.resolve(b);b.emit("reinvite",b)});return a.promise};b.prototype.refer=function(b){return this._refer(b).then(this._onReferSuccess.bind(this),this._onReferFailure.bind(this))};b.prototype._refer=function(b){var a=this,e=c.defer();setTimeout(function(){e.resolve(a)});return e.promise};b.prototype._onReferSuccess=function(){return this};b.prototype._onReferFailure=function(b){throw b;};b.prototype.getStats=
function(){var b=this,a=c.defer();f(this.peerConnection,function(c,e){if(c)return a.reject(c);a.resolve({callsid:b.callSid,samples:[e]})});return a.promise};k.exports=b},{"../webrtc/getstatistics":25,events:31,q:144,util:35}],9:[function(h,k,l){function b(b){var c=this;g.call(this);var d=!1,a=!1,m=!1,n=!1,p=null,h=e.defer(),k=h.promise.then(function(a){p=a;setTimeout(function(){c.emit("accepted",p)});return p},function(a){switch(!0){case c.canceled:setTimeout(function(){c.emit("canceled",a)});break;
case c.rejected:setTimeout(function(){c.emit("rejected",a)});break;default:setTimeout(function(){c.emit("failed",a)})}throw a;});Object.defineProperties(this,{_accepted:{set:function(a){d=a}},_canceled:{set:function(b){a=b}},_deferred:{value:h},_failed:{set:function(a){m=a}},_promise:{value:k},_rejected:{set:function(a){n=a}},accepted:{enumerable:!0,get:function(){return d}},canceled:{enumerable:!0,get:function(){return a}},dialog:{enumerable:!0,get:function(){return p}},failed:{enumerable:!0,get:function(){return m}},
rejected:{enumerable:!0,get:function(){return n}},userAgent:{enumerable:!0,value:b}});return this}var g=h("events").EventEmitter;l=h("util").inherits;var e=h("q");b._checkInviteTransactionState=function(b){if(b.accepted)throw Error("InviteTransaction already accepted");if(b.canceled)throw Error("InviteTransaction already canceled");if(b.rejected)throw Error("InviteTransaction already rejected");if(b.failed)throw Error("InviteTransaction failed");};l(b,g);b.prototype.then=function(b,c){return this._promise.then(b,
c)};Object.freeze(b.prototype);k.exports=b},{events:31,q:144,util:35}],10:[function(h,k,l){function b(b,c,d){g.call(this,b,c,d);d=e.withDefaults(d,{});var a=d.localMedia;Object.defineProperties(this,{_media:{set:function(b){a=b}},media:{enumerable:!0,get:function(){return a}},to:{enumerable:!0,value:c}})}l=h("util").inherits;var g=h("./");h("q");var e=h("../../util");l(b,g);b.prototype.cancel=function(){var b=this;setTimeout(function(){try{g._checkInviteTransactionState(b)}catch(c){return}b._canceled=
!0;b._deferred.reject(b)});return this.then(function(){g._checkInviteTransactionState(b)},function(b){if(b.canceled)return b;g._checkInviteTransactionState(b)})};k.exports=b},{"../../util":20,"./":9,q:144,util:35}],11:[function(h,k,l){function b(b,c,d,a,e){g.call(this,b);Object.defineProperties(this,{callSid:{enumerable:!0,value:a},conversationSid:{enumerable:!0,value:d},from:{enumerable:!0,value:c},participantSid:{value:e}});return this}l=h("util").inherits;var g=h("./"),e=h("../../util");l(b,g);
b.prototype.accept=function(b){var c=this;b=e.withDefaults(b,{});setTimeout(function(){try{g._checkInviteTransactionState(c)}catch(b){return}c._accepted=!0;c._deferred.resolve(c.dialog)});return this.then(function(){g._checkInviteTransactionState(c);return c},function(b){throw b;})};b.prototype.reject=function(){var b=this;setTimeout(function(){try{g._checkInviteTransactionState(b)}catch(c){return}b._rejected=!0;b._deferred.reject(b)});return this.then(function(){g._checkInviteTransactionState(b)},
function(b){throw b;})};k.exports=b},{"../../util":20,"./":9,util:35}],12:[function(h,k,l){function b(g,p,h){if(!(this instanceof b))return new b(g,p,h);var k=this;h=d.withDefaults(h,{stunServers:g.stunServers,turnServers:g.turnServers});e.call(this,g);var l=h.callTimeout||f.DEFAULT_CALL_TIMEOUT,w=null,r=null;g.connect().then(function(){return m.getLocalMedia(h)}).then(function(b){k._media=b;var e=g.token,m="sip:"+p+"@"+f.REGISTRAR_SERVER(e.accountSid),e=d.makeInviteHeaders({p:"browser"},e,{}),C=
[];b.mediaStreams.forEach(function(a){C.push(a)});r=g._ua.invite(m,{extraHeaders:e,inviteWithoutSdp:h.inviteWithoutSdp,media:{stream:C[0]},stunServers:h.stunServers,turnServers:h.turnServers});w=setTimeout(function(){k.cancel();k._deferred.reject("ignored")},l);var q=Date.now(),E=null;r.on("progress",function(a){180===a.statusCode&&(E=Date.now())});r.once("accepted",function(e){var f=e.getHeader("X-Twilio-CallSid"),m=r.mediaHandler.peerConnection,h=new a(m);r.mediaHandler.on("addStream",function(a){h._addStream(a.stream)});
var G=E?E-q:null;e=d.parseConversationSIDFromContactHeader(e.getHeader("Contact"));f=new c(g,p,e,f,b,h,m,r,G);clearTimeout(w);k._deferred.resolve(f)});r.once("rejected",function(){k._rejected=!0;clearTimeout(w);k._deferred.reject(k)});r.once("failed",function(){k.accepted&&k.canceled||(k._failed=!0,clearTimeout(w),k._deferred.reject(k))})}).then(null,function(a){k._failed=!0;w&&clearTimeout(w);k._deferred.reject(a)});Object.defineProperties(this,{session:{enumerable:!0,get:function(){return r}}});
return Object.freeze(this)}l=h("util").inherits;var g=h("./"),e=h("./inviteclienttransaction");h("q");var f=h("../../util/constants"),c=h("../sipjsdialog"),d=h("../../util"),a=h("../../media"),m=a.LocalMedia;l(b,e);b.prototype.cancel=function(){var a=this;setTimeout(function(){try{g._checkInviteTransactionState(a)}catch(b){return}a.session.once("cancel",function(){try{g._checkInviteTransactionState(a)}catch(b){return}a._canceled=!0;a._deferred.reject(a)});a.session.cancel()});return this.then(function(){g._checkInviteTransactionState(a)},
function(a){if(a.canceled)return a;g._checkInviteTransactionState(a)})};Object.freeze(b.prototype);k.exports=b},{"../../media":4,"../../util":20,"../../util/constants":19,"../sipjsdialog":14,"./":9,"./inviteclienttransaction":10,q:144,util:35}],13:[function(h,k,l){function b(a,f){if(!(this instanceof b))return new b(a,f);var m=f.request,h=m.from.uri.user,k=c.parseConversationSIDFromContactHeader(m.getHeader("Contact")),l=m.getHeader("X-Twilio-CallSid"),m=m.getHeader("X-Twilio-ParticipantSid").split(";")[0];
e.call(this,a,h,k,l,m);Object.defineProperties(this,{session:{enumerable:!0,value:f}});var r=this;f.once("cancel",function(){try{g._checkInviteTransactionState(r)}catch(a){return}r._canceled=!0;var b=d.CONVERSATION_JOIN_FAILED.clone("Incoming Invite was canceled by the sender");r._deferred.reject(b)});f.once("failed",function(a){try{g._checkInviteTransactionState(r)}catch(b){return}r._failed=!0;a=c.getOrNull(a,"headers.X-Twilio-Error.0.raw")||"An unknown error occurred";a=d.CONVERSATION_JOIN_FAILED.clone(a);
r._deferred.reject(a)});return Object.freeze(this)}l=h("util").inherits;var g=h("./"),e=h("./inviteservertransaction");h("q");var f=h("../sipjsdialog"),c=h("../../util"),d=h("../../util/constants").twilioErrors,a=h("../../media"),m=a.LocalMedia;l(b,e);b.prototype.accept=function(b){var d=this;g._checkInviteTransactionState(this);b=c.withDefaults(b,{});m.getLocalMedia(b).then(function(c){var e=[];c.mediaStreams.forEach(function(a){e.push(a)});b.media=b.media||{};b.media.stream=e[0];d.session.accept(b);
d.session.once("accepted",function(){try{g._checkInviteTransactionState(d)}catch(b){return}var e=null,m=d.session.mediaHandler.peerConnection,n=new a(m);d.session.mediaHandler.on("addStream",function(a){n._addStream(a.stream)});(m.getRemoteStreams()||[]).forEach(n._addStream,n);if(!d.session.hasOffer)e=new f(d.userAgent,d.from,d.conversationSid,d.callSid,c,n,m,d.session,null),d._accepted=!0,d._deferred.resolve(e);else if(d.session.hasOffer&&d.session.hasAnswer)e=new f(d.userAgent,d.from,d.conversationSid,
d.callSid,c,n,m,d.session,null),d._accepted=!0,d._deferred.resolve(e);else if(d.session.hasOffer&&!d.session.hasAnswer)d.session.mediaHandler.once("addStream",function(){e=new f(d.userAgent,d.from,d.conversationSid,d.callSid,c,n,m,d.session,null);d._accepted=!0;d._deferred.resolve(e)})})});return this};b.prototype.reject=function(){var a=this;setTimeout(function(){try{g._checkInviteTransactionState(a)}catch(b){return}a.session.once("rejected",function(){try{g._checkInviteTransactionState(a)}catch(b){return}a._rejected=
!0;a._deferred.reject(a)});a.session.reject()});return this.then(function(){g._checkInviteTransactionState(a)},function(a){if(a.rejected)return a;g._checkInviteTransactionState(a)})};Object.freeze(b.prototype);k.exports=b},{"../../media":4,"../../util":20,"../../util/constants":19,"../sipjsdialog":14,"./":9,"./inviteservertransaction":11,q:144,util:35}],14:[function(h,k,l){function b(c,d,a,e,n,p,h,k,l){if(!(this instanceof b))return new b(c,d,a,e,n,p,h,k,l);var w=this;g.call(this,c,d,a,e,n,p,h);Object.defineProperties(this,
{inviteTo180:{enumerable:!0,value:l},session:{enumerable:!0,value:k}});h.oniceconnectionstatechange=function(a){switch(a.target.iceConnectionState){case "failed":return w.emit("failed",f.ICE_CONNECT_FAILED);case "disconnected":return w.emit("disconnected",f.ICE_DISCONNECTED)}};k.once("failed",function(){w._ended=!0;w.emit("failed",w)});k.once("bye",function(){w._ended=!0;w.emit("ended",w)});return Object.freeze(this)}var g=h("./dialog");l=h("util").inherits;var e=h("q"),f=h("../util/constants").twilioErrors;
l(b,g);b.prototype.end=function(){if(this.ended)throw Error("Dialog already ended");this._ended=!0;var b=this,d=e.defer();b.session.once("bye",function(){d.resolve(b);b.emit("ended",b)});b.session.bye();return d.promise};b.prototype._reinvite=function(){this.session.sendReinvite()};b.prototype._refer=function(b){var d=this,a=e.defer();d.session.refer(b,{receiveResponse:function(b){202==b.status_code?a.resolve(d):a.reject(b)}});return a.promise};Object.freeze(b.prototype);k.exports=b},{"../util/constants":19,
"./dialog":8,q:144,util:35}],15:[function(h,k,l){function b(d,p){if(!(this instanceof b))return new b(d,p);var h=d.accountSid,k=d.address+"@"+e.REGISTRAR_SERVER(h);p=m.withDefaults(p,{debug:e.DEBUG,inviteClientTransactionFactory:c,registrarServer:e.REGISTRAR_SERVER(h),wsServer:e.WS_SERVER(h),uaFactory:f.UA});var h=/^wss:\/\//.test(p.wsServer),l=g.call(this,new p.uaFactory({autostart:!1,log:{builtinEnabled:p.debug},register:!1,registrarServer:p.registrarServer,traceSip:p.debug,uri:k,wsServers:p.wsServer,
hackWssInTransport:h})),w=[],r=[];Object.defineProperties(this,{_ua:{value:l},_stunServers:{set:function(a){w=a;m.overwriteArray(l.configuration.stunServers,w)}},_turnServers:{set:function(a){r=a;m.overwriteArray(l.configuration.turnServers,r)}},stunServers:{enumerable:!0,get:function(){return w}},turnServers:{enumerable:!0,get:function(){return r}}});a.call(this,d,p);return Object.freeze(this)}function g(a){var b=this;a.on("invite",function(a){a=new d(b,a);b._handleInviteServerTransaction(a)});return a}
var e=h("../util/constants");l=h("util").inherits;h("q");h("../conversation");h("../scopedauthenticationtoken");var f=h("sip.js");h("./sipjsdialog.js");var c=h("./invitetransaction/sipjsinviteclienttransaction.js"),d=h("./invitetransaction/sipjsinviteservertransaction"),a=h("./useragent"),m=h("../util");l(b,a);b.prototype._register=function(a){function b(){var d=m.makeRegisterHeaders(a);c._ua.register({extraHeaders:d})}var c=this;return this.connect().then(function(){return m.promiseFromEvents(b,
c._ua,"registered","registrationFailed")})};b.prototype._unregister=function(){function a(){var d=m.makeRegisterHeaders(c);b._ua.unregister({extraHeaders:d})}var b=this,c=b.token;return this.connect().then(function(){return m.promiseFromEvents(a,b._ua,"unregistered")})};b.prototype._connect=function(){var a=this;return m.promiseFromEvents(function(){a._ua.start()},this._ua,"connected","disconnected")};b.prototype._disconnect=function(){var a=this;return m.promiseFromEvents(function(){a._ua.stop()},
this._ua,"disconnected")};Object.freeze(b.prototype);k.exports=b},{"../conversation":1,"../scopedauthenticationtoken":7,"../util":20,"../util/constants":19,"./invitetransaction/sipjsinviteclienttransaction.js":12,"./invitetransaction/sipjsinviteservertransaction":13,"./sipjsdialog.js":14,"./useragent":16,q:144,"sip.js":162,util:35}],16:[function(h,k,l){function b(a,b){g.call(this);b=d.withDefaults(b,{inviteClientTransactionFactory:e});var f=!1,p=!1;Object.defineProperties(this,{_inviteClientTransactionFactory:{value:b.inviteClientTransactionFactory},
_isConnected:{set:function(a){p=a}},_isRegistered:{set:function(a){f=a}},_token:{set:function(b){a=b}},callTimeout:{value:b&&b.callTimeout},dialogs:{enumerable:!0,value:new c},inviteClientTransactions:{enumerable:!0,value:new c},inviteServerTransactions:{enumerable:!0,value:new c},isConnected:{enumerable:!0,get:function(){return p}},isRegistered:{enumerable:!0,get:function(){return f}},token:{enumerable:!0,get:function(){return a}}});if(!this.stunServers){var h=[];Object.defineProperties(this,{_stunServers:{set:function(a){h=
a}},stunServers:{enumerable:!0,get:function(){return h}}})}if(!this.turnServers){var k=[];Object.defineProperties(this,{_turnServers:{set:function(a){k=a}},turnServers:{enumerable:!0,get:function(){return k}}})}return this}var g=h("events").EventEmitter;l=h("util").inherits;var e=h("./invitetransaction/inviteclienttransaction"),f=h("q");h("../scopedauthenticationtoken");var c=h("es6-set"),d=h("../util");h("../util/constants");l(b,g);b.prototype.connect=function(){if(this.isConnected){var a=f.defer();
setTimeout(a.resolve);return a.promise}return this._connect().then(this._onConnectSuccess.bind(this),this._onConnectFailure.bind(this))};b.prototype._connect=function(){var a=f.defer();setTimeout(a.resolve);return a.promise};b.prototype._onConnectSuccess=function(){this.isConnected||this.emit("connected",this);this._isConnected=!0;return this};b.prototype._onConnectFailure=function(a){throw a;};b.prototype.disconnect=function(){if(this.isConnected){var a=f.defer();setTimeout(a.resolve);return a.promise}return this._disconnect().then(this._onDisconnectSuccess.bind(this),
this._onDisconnectFailure.bind(this))};b.prototype._disconnect=function(){var a=f.defer();setTimeout(a.resolve);return a.promise};b.prototype._onDisconnectSuccess=function(){this.isConnected&&this.emit("disconnected",this);this._isConnected=!1;return this};b.prototype._onDisconnectFailure=function(a){throw a;};b.prototype.register=function(a){a=a||this.token;return this._register(a).then(this._onRegisterSuccess.bind(this,a),this._onRegisterFailure.bind(this))};b.prototype._register=function(a){a=
f.defer();setTimeout(a.resolve);return a.promise};b.prototype._onRegisterSuccess=function(a){this._isRegistered=!0;this._token=a;this.emit("registered",this);return this};b.prototype._onRegisterFailure=function(a){this.emit("registrationFailed",this);throw a;};b.prototype.unregister=function(){return this._unregister().then(this._onUnregisterSuccess.bind(this),this._onUnregisterFailure.bind(this))};b.prototype._unregister=function(){var a=f.defer();setTimeout(a.resolve);return a.promise};b.prototype._onUnregisterSuccess=
function(){this._isRegistered=!1;this.emit("unregistered",this);return this};b.prototype._onUnregisterFailure=function(a){throw a;};b.prototype.invite=function(a,b){b=d.withDefaults(b,{callTimeout:this.callTimeout,stunServers:this.stunServers,turnServers:this.turnServers});var c=new this._inviteClientTransactionFactory(this,a,b);this.inviteClientTransactions.add(c);c.then(this._onInviteSuccess.bind(this,c),this._onInviteFailure.bind(this,c));return c};b.prototype._onInviteSuccess=function(a,b){this.inviteClientTransactions.delete(a);
return this._dialogCreated(b)};b.prototype._onInviteFailure=function(a,b){this.inviteClientTransactions.delete(a);throw b;};b.prototype._handleInviteServerTransaction=function(a){this.inviteServerTransactions.add(a);a.then(this._onAcceptSuccess.bind(this,a),this._onAcceptFailure.bind(this,a));setTimeout(this.emit.bind(this,"invite",a))};b.prototype._onAcceptSuccess=function(a,b){this.inviteServerTransactions.delete(a);return this._dialogCreated(b)};b.prototype._dialogCreated=function(a){var b=this;
this.dialogs.add(a);a.once("disconnected",function(c){b.emit("dialogDisconnected",a)});a.once("failed",function(c){b.dialogs.delete(a);b.emit("dialogFailed",a)});a.once("ended",function(){b.dialogs.delete(a);b.emit("dialogEnded",a)});this.emit("dialogCreated",a);return a};b.prototype._onAcceptFailure=function(a,b){this.inviteServerTransactions.delete(a);throw b;};k.exports=b},{"../scopedauthenticationtoken":7,"../util":20,"../util/constants":19,"./invitetransaction/inviteclienttransaction":10,"es6-set":91,
events:31,q:144,util:35}],17:[function(h,k,l){(function(b){function g(a,b,c){if(!(this instanceof g))return new g(a,b,c);var d=this,m=!1,p=[],h=b.userAgent.token;c=new n("StatsReporter",c||"warn");Object.defineProperties(this,{_log:{value:c},dialog:{enumerable:!0,value:b},eventGateway:{enumerable:!0,value:a},token:{enumerable:!0,value:h}});b.on("stats",function(a){m&&10<=p.length?(a=p.splice(0,p.length),e(d,a)):p.push(a)});b.once("ended",function(){if(m){var a=p.splice(0,p.length);e(d,a)}});f(this).then(function(){m=
!0})}function e(a,b){var d=a._log;return c("https://"+a.eventGateway+"/v1/Calls/"+a.dialog.callSid+"/Statistics",a.token.jwt,{callsid:a.dialog.callSid,samples:b}).then(d.debug.bind(d,"Post to gateway succeeded"),d.debug.bind(d,"Post to gateway failed"))}function f(b){var d=b._log;return c("https://"+b.eventGateway+"/v1/Calls",b.token.jwt,{callsid:b.dialog.callSid,sip:{invite_to_180:b.dialog.inviteTo180},platform:{name:p.name,version:p.version,media_engine:"WebRTC",sdk:a}}).then(d.debug.bind(d,"Initial post to gateway succeeded"),
d.debug.bind(d,"Initial post to gateway failed"))}function c(a,b,c){return m.post({url:a,body:c,headers:{"Content-Type":"application/json","X-Twilio-Token":b}})}var d=h("./util"),a=h("../package.json").version,m=h("./util/request"),n=h("./util/log"),p={name:"Unknown",version:"0.0"};"undefined"!==typeof navigator&&navigator.userAgent?p=d.parseUserAgent(navigator.userAgent):"undefined"!==typeof b&&(p={name:"Node",version:b.version.node});k.exports=g}).call(this,h("_process"))},{"../package.json":179,
"./util":20,"./util/log":21,"./util/request":22,_process:33}],18:[function(h,k,l){function b(e){if(!(this instanceof b))return new b(e);if("function"===typeof e.cancel)return e;var f=g.defer(),c=g.all([e,f.promise]),d=g.defer();Object.defineProperties(this,{_deferred:{value:d}});e.then(function(){f.resolve()});c.then(function(a){d.resolve(a[0])},function(a){d.reject(a)})}var g=h("q");b.prototype.then=function(){var b=this._deferred.promise;return b.then.apply(b,arguments)};b.prototype.catch=function(){var b=
this._deferred.promise;return b.catch.apply(b,arguments)};b.prototype.cancel=function(){return this._deferred.reject(Error("canceled"))};k.exports=b},{q:144}],19:[function(h,k,l){l=h("q");k.exports.REALM=".dev";k.exports.CHUNDER_PORT=10193;k.exports.CLIENT_VERSION=2;k.exports.DEBUG=!1;k.exports.EVENT_GATEWAY="eventgw.twilio.com";k.exports.REGISTRAR_SERVER=function(b){return b+".endpoint.twilio.com"};k.exports.WS_SERVER=function(b){return"wss://public-endpoint0.us1.twilio.com"};k.exports.DEFAULT_PEER_NAME=
"Anonymous";k.exports.DEFAULT_CALL_TIMEOUT=3E4;k.exports.DEFAULT_ICE_SERVERS=new l([{url:"stun:global.stun.twilio.com:3478?transport=udp"}]);k.exports.headers={X_TWILIO_ACCOUNTSID:"X-Twilio-Accountsid",X_TWILIO_APIVERSION:"X-Twilio-Apiversion",X_TWILIO_CALLSID:"X-Twilio-Callsid",X_TWILIO_CLIENT:"X-Twilio-Client",X_TWILIO_CLIENTVERSION:"X-Twilio-Clientversion",X_TWILIO_PARAMS:"X-Twilio-Params",X_TWILIO_TOKEN:"X-Twilio-Token",X_TWILIO_USERNAME:"X-Twilio-Username",X_TWILIO_PASSWORD:"X-Twilio-Password",
X_TWILIO_SESSION:"X-Twilio-Session"};k.exports.SOUNDS={incoming:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/incoming.mp3",outgoing:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/outgoing.mp3",disconnect:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/disconnect.mp3",dtmf0:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-0.mp3",dtmf1:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-1.mp3",dtmf2:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-2.mp3",
dtmf3:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-3.mp3",dtmf4:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-4.mp3",dtmf5:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-5.mp3",dtmf6:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-6.mp3",dtmf7:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-7.mp3",dtmf8:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-8.mp3",dtmf9:"//static.twilio.com/libs/twiliojs/refs/82278dd/sounds/dtmf-9.mp3"};
var b=h("./twilioerror");k.exports.twilioErrors=Array.prototype.reduce.call([{name:"GATEWAY_CONNECTION_FAILED",message:"Could not connect to Twilio's servers"},{name:"GATEWAY_DISCONNECTED",message:"Connection to Twilio's servers was lost"},{name:"INVALID_ARGUMENT",message:"One or more arguments passed were invalid"},{name:"INVALID_TOKEN",message:"The token is invalid or malformed"},{name:"LISTEN_FAILED",message:"Failed to listen with the supplied token"},{name:"CONVERSATION_CREATE_FAILED",message:"Failed to create Conversation"},
{name:"CONVERSATION_INVITE_FAILED",message:"Failed to add Participant to Conversation"},{name:"CONVERSATION_JOIN_FAILED",message:"Failed to join Conversation"},{name:"SDP_NEGOTIATION_FAILED",message:"Failed to negotiate media with Participant(s)"},{name:"ICE_CONNECT_FAILED",message:"Could not find match for all candidates"},{name:"ICE_DISCONNECTED",message:"Liveliness check has failed; may be recoverable"},{name:"MEDIA_ACCESS_DENIED",message:"Could not get access to microphone or camera"}],function(g,
e){g[e.name]=new b(e);return g},{})},{"./twilioerror":24,q:144}],20:[function(h,k,l){(function(b,g){function e(a){var b="",c;for(c in a)b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]);return b}function f(a){return 0===a.length?[[]]:[a].concat(f(a.slice(1)))}function c(a){var b=[],c=[];a&&a.forEach(function(a){if(a.url){var d=a.url.split(":")[0];"stun"===d||"stuns"===d?b.push(a):"turn"!==d&&"turns"!==d||c.push(a)}});b=b.map(function(a){return a.url.split("?")[0]});c=c.map(function(a){return{urls:a.url.split("?")[0],
username:a.username,password:a.credential}});return{stunServers:b,turnServers:c}}h("util");var d=h("./cancelablepromise"),a=h("./constants"),m=a.twilioErrors,n=a.headers,p=h("es6-map"),l=h("q"),A=h("./request"),z="function"===typeof atob?atob:function(a){return(new g(a,"base64")).toString("ascii")},w="function"===typeof btoa?btoa:function(a){return(new g(a)).toString("base64")},r={decode:z,encode:w},v={decode:function(a){var b={};return function(){var c=Array.prototype.slice.call(arguments,0);return b[c]?
b[c]:b[c]=a.apply(null,c)}}(function(a){var b=a.length%4;0<b&&(a+=Array(4-b+1).join("="));a=a.replace(/-/g,"+").replace(/_/g,"/");return z(a)})},p=new p;k.exports.base64=r;k.exports.base64URL=v;k.exports.deepClone=function(a){return JSON.parse(JSON.stringify(a))};k.exports.fromURLFormEncoded=function(a){if(!a)return{};var b={};a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].split("="),e=decodeURIComponent(d[0]),d=d[1]?decodeURIComponent(d[1]):null;b[e]=d}return b};k.exports.makeInviteHeaders=
function(b,c,d,f){b=[n.X_TWILIO_TOKEN+": "+c.jwt,n.X_TWILIO_CLIENT+": "+JSON.stringify(b),n.X_TWILIO_CLIENTVERSION+": "+a.CLIENT_VERSION];d&&b.push(n.X_TWILIO_PARAMS+": "+e(d));return b};k.exports.makeRegisterHeaders=function(c){var d="undefined"===typeof navigator?{}:navigator;return[n.X_TWILIO_TOKEN+": "+c.jwt,n.X_TWILIO_CLIENT+": "+JSON.stringify({p:"browser",v:b.env.SDKVER||"unknown",browser:{userAgent:d.userAgent||"unknown",platform:d.platform||"unknown"},plugin:"rtc"}),n.X_TWILIO_CLIENTVERSION+
": "+a.CLIENT_VERSION]};k.exports.makeTarget=function(b){return"sip:"+b+"@"+a.CHUNDER_HOST};k.exports.makeURI=function(b,c){return encodeURIComponent(c||a.DEFAULT_PEER_NAME)+"@"+b+".chunder.twilio.com"};k.exports.toURLFormEncoded=e;k.exports.requireNoBrowserify=function(a){return eval("require('"+a+"')")};k.exports.getKeys=function(a){var b=[],c;for(c in a)b.push(c);return b};k.exports.getValues=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};k.exports.makeUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};k.exports.race=function(a){function b(a){e&&(e=!1,d.resolve(a))}function c(a){e&&(e=!1,d.reject(a))}var d=l.defer(),e=!0;a.forEach(function(a){a.done(b,c)});return d.promise};k.exports.any=function(a){function b(a){f&&(f=!1,e.resolve(a))}function c(b){m.push(b);m.length===a.length&&e.reject(b)}a=a.map(d);var e=l.defer();e.promise=new d(e.promise);var f=!0,m=[];a.forEach(function(a){a.then(b,c)});var g=e.promise.cancel.bind(e.promise);
Object.defineProperties(e.promise,{cancel:{value:function(){f&&(f=!1,a.forEach(function(a){a.cancel()}),g())}}});return e.promise};k.exports.withDefaults=function(a,b){a=a||{};for(var c in b)c in a||(a[c]=b[c]);return a};k.exports.extend=function(a,b){a=a||{};for(var c in b)a[c]=b[c];return a};k.exports.tails=f;k.exports.sessionRegistry=p;k.exports.return=function(a){return function(){return a}};k.exports.separateIceServers=c;k.exports.getStunServers=function(a){return c(a).stunServers};k.exports.getTurnServers=
function(a){return c(a).turnServers};k.exports.promiseFromEvents=function(a,b,c,d){function e(){var a=[].slice.call(arguments);d&&b.off(d,f);m.resolve.apply(null,a)}function f(){var a=[].slice.call(arguments);b.off(c,e);m.reject.apply(null,a)}var m=l.defer();b.once(c,e);if(d)b.once(d,f);a();return m.promise};k.exports.parseConversationSIDFromContactHeader=function(a){return(a=a.match(/^<sip:(.*)@(.*)$/))?a[1]:null};k.exports.emitNext=function(){var a=[].slice.call(arguments),b=a[0],a=a.slice(1);setTimeout(function(){b.emit.call(b,
a)});return b};k.exports.getOrNull=function(a,b){return b.split(".").reduce(function(a,b){return a?a[b]:null},a)};k.exports.isValidIceServerArray=function(a){return"undefined"===typeof a.forEach?!1:a.reduce(function(a,b){return a&&"undefined"!==typeof b.url},!0)};k.exports.parseUserAgent=function(a){var b=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)\.(\d+)/i)||[],b={name:b[1],version:b[2]+"."+b[3]};if(/trident/i.test(b.name))return a=/\brv[ :]+(\d+)\.(\d+)/g.exec(a)||[],{name:"IE",
version:a[1]?a[1]+"."+a[2]:""};if("Chrome"===b.name&&(a=a.match(/\b(OPR|Edge)\/(\d+)\.(\d+)/),null!==a))return{name:"Opera",version:a[2]+"."+a[3]};"MSIE"===b.name&&(b.name="IE");return b};k.exports.fetchIceServers=function(b,c,d){b={url:"https://"+(d||"api.twilio.com")+"/2010-04-01/Accounts/"+b.accountSid+"/Tokens.json",headers:{Authorization:"Basic "+w("Token:"+b.jwt)}};return A.post(b).then(function(a){return JSON.parse(a).ice_servers},function(b){c&&c.warn(m.ICE_FETCH_FAILED,"Failed to fetch ephemeral TURN server credential",
b);return a.DEFAULT_ICE_SERVERS})};k.exports.overwriteArray=function(a,b){a.splice(0,a.length);b.forEach(function(b){a.push(b)})}}).call(this,h("_process"),h("buffer").Buffer)},{"./cancelablepromise":18,"./constants":19,"./request":22,_process:33,buffer:27,"es6-map":36,q:144,util:35}],21:[function(h,k,l){function b(e,f){if(!(this instanceof b))return new b(e);f=f?b.getLevelByName(f):b.INFO;Object.defineProperties(this,{logLevel:{value:f},name:{value:e}})}h("./");h("./twilioerror");var g=h("./constants").twilioErrors;
Object.defineProperties(b,{DEBUG:{value:0},INFO:{value:1},WARN:{value:2},ERROR:{value:3},OFF:{value:4},_levels:{value:[{name:"DEBUG",logFn:console.log},{name:"INFO",logFn:console.info},{name:"WARN",logFn:console.warn},{name:"ERROR",logFn:console.error},{name:"OFF",logFn:function(){}}]}});b.getLevelByName=function(e){if(!isNaN(e))return parseInt(e,10);e=e.toUpperCase();if(-1===["OFF","ERROR","WARN","INFO","DEBUG"].indexOf(e))throw g.INVALID_ARGUMENT.clone('Log level must be one of: ["off", "error", "warn", "info", "debug"]');
return b[e]};b.prototype.log=function(e,f){this.logLevel<=e&&b._levels[e].logFn.apply(console,[this.name,b._levels[e].name].concat(f));return this};b.prototype.debug=function(){return this.log.call(this,b.DEBUG,[].slice.call(arguments))};b.prototype.info=function(){return this.log.call(this,b.INFO,[].slice.call(arguments))};b.prototype.warn=function(){return this.log.call(this,b.WARN,[].slice.call(arguments))};b.prototype.error=function(){return this.log.call(this,b.ERROR,[].slice.call(arguments))};
b.prototype.throw=function(e,f){e.clone&&(e=e.clone(f));this.log.call(this,b.ERROR,e);throw e;};k.exports=b},{"./":20,"./constants":19,"./twilioerror":24}],22:[function(h,k,l){function b(b,c){var d=g.defer(),a=new e;a.open(b,c.url,!0);a.onreadystatechange=function(){4===a.readyState&&(200<=a.status&&300>a.status?d.resolve(a.responseText):d.reject(a.responseText))};for(var m in c.headers)a.setRequestHeader(m,c.headers[m]);a.send(JSON.stringify(c.body));return d.promise}var g=h("q"),e="undefined"===
typeof XMLHttpRequest?h("xmlhttprequest").XMLHttpRequest:XMLHttpRequest;b.get=function(e){return b("GET",e)};b.post=function(e){return b("POST",e)};k.exports=b},{q:144,xmlhttprequest:178}],23:[function(h,k,l){var b=h("es6-set");b.prototype.map=function(g,e){g=e?g.bind(e):g;var f=new b;this.forEach(function(b){f.add(g(b))});return f};k.exports=b},{"es6-set":91}],24:[function(h,k,l){function b(b,e){Object.defineProperties(this,{_errorData:{value:b},name:{value:b.name},message:{value:e||b.message}})}
h=h("util").inherits;h(b,Error);b.prototype.toString=function(){return[this.name,this.message].join(" | ")};b.prototype.clone=function(g){return new b(this._errorData,g)};k.exports=b},{util:35}],25:[function(h,k,l){function b(a,b){var c=[],d=null,e=[],m=null;a.result().forEach(function(a){var b=null;switch(a.type){case "googCandidatePair":a:{for(var b={},p={},h=a.names(),k=a.timestamp?Math.floor(a.timestamp/1E3):null,l=0;l<h.length;l++){var y=h[l],B=a.stat(y);switch(y){case "googActiveConnection":if("true"!==
B){b=null;break a}break;case "googChannelId":b.connection=B;break;case "googLocalAddress":B.split&&(y=B.split(":"),n(b,"local","address",y[0]),n(b,"local","port",Number(y[1])));break;case "googLocalCandidateType":n(b,"local","type",B);break;case "googRemoteAddress":B.split&&(y=B.split(":"),n(b,"remote","address",y[0]),n(b,"remote","port",Number(y[1])));break;case "googRemoteCandidateType":n(b,"remote","type",B);break;case "googRtt":b.rtt=Number(B);break;case "":break;default:p[y]=B}}b.timestamp=k;
b=f(b,p)}b&&(d=d||b.known);break;case "ssrc":b=g(a);c.push(b.known);break;default:e.push(a)}b&&b.known&&"timestamp"in b.known&&(m=m||b.known.timestamp,delete b.known.timestamp)});b(null,{timestamp:m,tracks:c,transport:d})}function g(a){var b={},c={},d=a.names(),e=null,m=null,g=a.timestamp?Math.floor(a.timestamp/1E3):null;d.forEach(function(d){var f=a.stat(d);switch(d){case "audioInputLevel":m="audio";n(b,"audio","inlvl",Number(f));break;case "audioOutputLevel":m="audio";n(b,"audio","outlvl",Number(f));
break;case "bytesReceived":e="receiving";n(b,"bytes","recv",Number(f));break;case "bytesSent":e="sending";n(b,"bytes","sent",Number(f));break;case "googCodecName":""!==f&&(b.codecName=f);break;case "googFrameHeightReceived":e="receiving";m="video";n(b,"video","height_recv",Number(f));break;case "googFrameHeightSent":e="sending";m="video";n(b,"video","height_sent",Number(f));break;case "googFrameWidthReceived":e="receiving";m="video";n(b,"video","width_recv",Number(f));break;case "googFrameWidthSent":e=
"sending";m="video";n(b,"video","width_sent",Number(f));break;case "googFrameRateDecoded":e="receiving";m="video";n(b,"video","fps_recv",Number(f));break;case "googFrameRateSent":e="sending";m="video";n(b,"video","fps_sent",Number(f));break;case "googJitterBufferMs":b.googJitterBufferMs=Number(f);break;case "googJitterReceived":d=Number(f);-1!==d&&(b.jitter=d);break;case "googRtt":d=Number(f);-1!==d&&(b.rtt=d);break;case "packetsLost":e="sending";-1!==Number(f)&&n(b,"packets","lost",Number(f));break;
case "packetsReceived":e="receiving";n(b,"packets","recv",Number(f));break;case "packetsSent":e="sending";n(b,"packets","sent",Number(f));break;case "ssrc":b[d]=f;break;case "transportId":b.connection=f;break;default:c[d]=f}});e&&(b.direction=e);m&&(b.media=m);b.timestamp=g;return f(b,c)}function e(a,b){var d=[],e=[],g=null,n={},h={},k;a.forEach(function(a){var b=null;switch(a.type){case "inboundrtp":var c={direction:"receiving"},b={},m;for(m in a){var p=a[m];switch(m){case "mozRtt":c.rtt=p;break;
case "timestamp":c[m]=Math.floor(p/1E3);break;case "jitter":c[m]=1E3*p;break;case "framerateMean":c.fps=Math.round(p);break;case "mediaType":c.media=p;break;case "bytesReceived":case "packetsLost":case "packetsReceived":case "ssrc":c[m]=p;break;default:b[m]=p}}b=f(c,b);break;case "outboundrtp":if(!1===a.isRemote){m={direction:"sending"};b={};for(c in a)switch(p=a[c],c){case "timestamp":m[c]=Math.floor(p/1E3);break;case "mediaType":m.media=p;break;case "bytesSent":case "packetsSent":case "ssrc":m[c]=
p;break;default:b[c]=p}b=f(m,b)}break;case "candidatepair":m=k&&k.componentId;!a.selected||m&&-1!==m.indexOf("video")||(k=a);break;case "localcandidate":n[a.id]=a;break;case "remotecandidate":h[a.id]=a;break;default:e.push(a)}b&&(g=g||b.known.timestamp,delete b.known.timestamp,d.push(b))});if(0===d.length||0===(d=c(d)).length)return b(null,{timestamp:g,ssrcs:[]});var l=n[k.localCandidateId],C=h[k.remoteCandidateId],l={local:{address:l.ipAddress,port:l.portNumber,type:"host"===l.candidateType?"local":
l.candidateType},remote:{address:C.ipAddress,port:C.portNumber,type:"host"===C.candidateType?"local":C.candidateType}},l={timestamp:g,tracks:d.map(m),transport:l};b(null,l)}function f(a,b){var c=null;d(a)||(c=c||{},c.known=a);d(b)||(c=c||{},c.unknown=b);return c}function c(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d.known&&b.push(d.known)}return b}function d(a){if(!a)return!0;for(var b in a)return!1;return!0}function a(a,b){return function(){var c=Array.prototype.slice.call(arguments);c.push(b);
return a.apply(null,c)}}function m(a){var b={ssrc:a.ssrc,media:a.media,direction:a.direction,codecName:a.codecName,packets:{lost:a.packetsLost,recvtot:a.packetsReceived,senttot:a.packetsSent},bytes:{recvtot:a.bytesReceived,senttot:a.bytesSent},jitter:a.jitter,rtt:a.rtt};if("audioInputLevel"in a||"audioOutputLevel"in a)b.audio={inlvl:a.audioInputLevel,outlvl:a.audioOutputLevel};if("fps"in a||"width"in a||"height"in a)b.video={fps:a.fps,width:a.width,height:a.height};return b}function n(){var a=[].slice.call(arguments,
0),b=a[0],c=a.slice(1,a.length-1),d=a[a.length-1],e=b;c.forEach(function(a,b){var f=b==c.length-1?d:{};e=e[a]=e[a]||f});return b}k.exports=function(c,d){var f=Error("WebRTC statistics are unsupported");null===c||"undefined"===typeof navigator||"function"!==typeof c.getStats?d(f):navigator.webkitGetUserMedia?c.getStats(a(b,d),d):navigator.mozGetUserMedia?c.getStats(null,a(e,d),d):d(f)}},{}],26:[function(h,k,l){var b=h("q");k.exports=function(g){var e=b.defer();g=g||{audio:!0,video:!0};var f=e.resolve.bind(e),
c=e.reject.bind(e);"undefined"!==typeof window&&"undefined"!==typeof navigator?"function"===typeof navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(g,f,c):"function"===typeof navigator.mozGetUserMedia&&navigator.mozGetUserMedia(g,f,c):c(Error("getUserMedia is not supported"));return e.promise}},{q:144}],27:[function(h,k,l){function b(a){if(!(this instanceof b))return 1<arguments.length?new b(a,arguments[1]):new b(a);this.length=0;this.parent=void 0;if("number"===typeof a){var c;c=e(this,
0>a?0:f(a)|0);if(!b.TYPED_ARRAY_SUPPORT)for(var m=0;m<a;m++)c[m]=0;return c}if("string"===typeof a){c=this;m=1<arguments.length?arguments[1]:"utf8";if("string"!==typeof m||""===m)m="utf8";var n=d(a,m)|0;c=e(c,n);c.write(a,m);return c}return g(this,a)}function g(a,c){if(b.isBuffer(c)){var d=a,m=f(c.length)|0,d=e(d,m);c.copy(d,0,0,m);return d}if(E(c)){for(var d=a,m=f(c.length)|0,d=e(d,m),g=0;g<m;g+=1)d[g]=c[g]&255;return d}if(null==c)throw new TypeError("must start with number, buffer, array or string");
if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer){d=a;m=f(c.length)|0;d=e(d,m);for(g=0;g<m;g+=1)d[g]=c[g]&255;return d}if(c.length){d=a;m=f(c.length)|0;d=e(d,m);for(g=0;g<m;g+=1)d[g]=c[g]&255;return d}d=a;g=0;"Buffer"===c.type&&E(c.data)&&(m=c.data,g=f(m.length)|0);for(var d=e(d,g),n=0;n<g;n+=1)d[n]=m[n]&255;return d}function e(a,c){b.TYPED_ARRAY_SUPPORT?a=b._augment(new Uint8Array(c)):(a.length=c,a._isBuffer=!0);0!==c&&c<=b.poolSize>>>1&&(a.parent=B);return a}function f(a){if(a>=
F)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+F.toString(16)+" bytes");return a|0}function c(a,d){if(!(this instanceof c))return new c(a,d);var e=new b(a,d);delete e.parent;return e}function d(a,b){"string"!==typeof a&&(a=String(a));if(0===a.length)return 0;switch(b||"utf8"){case "ascii":case "binary":case "raw":return a.length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*a.length;case "hex":return a.length>>>1;case "utf8":case "utf-8":return r(a).length;
case "base64":return C.toByteArray(w(a)).length;default:return a.length}}function a(a,b,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function m(a,c,d,e,f,m){if(!b.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(c>f||c<m)throw new RangeError("value is out of bounds");if(d+e>a.length)throw new RangeError("index out of range");}function n(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-
c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function p(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function y(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range");}function A(a,b,c,d,e){e||y(a,b,c,4,3.4028234663852886E38,-3.4028234663852886E38);q.write(a,b,c,d,23,4);return c+4}function z(a,b,c,d,e){e||
y(a,b,c,8,1.7976931348623157E308,-1.7976931348623157E308);q.write(a,b,c,d,52,8);return c+8}function w(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(H,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="=";return a}function r(a,b){b=b||Infinity;for(var c,d=a.length,e=null,f=[],m=0;m<d;m++){c=a.charCodeAt(m);if(55295<c&&57344>c)if(e)if(56320>c){-1<(b-=3)&&f.push(239,191,189);e=c;continue}else c=e-55296<<10|c-56320|65536,e=null;else{56319<c?-1<(b-=3)&&f.push(239,191,189):m+1===d?-1<(b-=
3)&&f.push(239,191,189):e=c;continue}else e&&(-1<(b-=3)&&f.push(239,191,189),e=null);if(128>c){if(0>--b)break;f.push(c)}else if(2048>c){if(0>(b-=2))break;f.push(c>>6|192,c&63|128)}else if(65536>c){if(0>(b-=3))break;f.push(c>>12|224,c>>6&63|128,c&63|128)}else if(2097152>c){if(0>(b-=4))break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw Error("Invalid code point");}return f}function v(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b}function t(a,b,c,d){for(var e=
0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function u(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var C=h("base64-js"),q=h("ieee754"),E=h("is-array");l.Buffer=b;l.SlowBuffer=c;l.INSPECT_MAX_BYTES=50;b.poolSize=8192;var F=1073741823,B={};b.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);b.foo=function(){return 42};return 42===b.foo()&&"function"===typeof b.subarray&&0===(new Uint8Array(1)).subarray(1,1).byteLength}catch(c){return!1}}();
b.isBuffer=function(a){return!(null==a||!a._isBuffer)};b.compare=function(a,c){if(!b.isBuffer(a)||!b.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(a===c)return 0;for(var d=a.length,e=c.length,f=0,m=Math.min(d,e);f<m&&a[f]===c[f];)++f;f!==m&&(d=a[f],e=c[f]);return d<e?-1:e<d?1:0};b.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};b.concat=function(a,c){if(!E(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new b(0);if(1===a.length)return a[0];var d;if(void 0===c)for(d=c=0;d<a.length;d++)c+=a[d].length;var e=new b(c),f=0;for(d=0;d<a.length;d++){var m=a[d];m.copy(e,f);f+=m.length}return e};b.byteLength=d;b.prototype.length=void 0;b.prototype.parent=void 0;b.prototype.toString=function(a,b,c){var d=!1;b|=0;c=void 0===c||Infinity===c?this.length:c|0;a||(a="utf8");0>
b&&(b=0);c>this.length&&(c=this.length);if(c<=b)return"";for(;;)switch(a){case "hex":a=b;b=this.length;if(!a||0>a)a=0;if(!c||0>c||c>b)c=b;for(b="";a<c;a++)d=this[a],d=16>d?"0"+d.toString(16):d.toString(16),b+=d;return b;case "utf8":case "utf-8":a=b;d=b="";for(c=Math.min(this.length,c);a<c;a++)127>=this[a]?(b+=u(d)+String.fromCharCode(this[a]),d=""):d+="%"+this[a].toString(16);return b+u(d);case "ascii":a=b;b="";for(c=Math.min(this.length,c);a<c;a++)b+=String.fromCharCode(this[a]&127);return b;case "binary":a=
b;b="";for(c=Math.min(this.length,c);a<c;a++)b+=String.fromCharCode(this[a]);return b;case "base64":return a=b,c=0===a&&c===this.length?C.fromByteArray(this):C.fromByteArray(this.slice(a,c)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(b,c);a="";for(b=0;b<c.length;b+=2)a+=String.fromCharCode(c[b]+256*c[b+1]);return a;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}};b.prototype.equals=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");
return this===a?!0:0===b.compare(this,a)};b.prototype.inspect=function(){var a="",b=l.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... "));return"<Buffer "+a+">"};b.prototype.compare=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:b.compare(this,a)};b.prototype.indexOf=function(a,c){function d(a,b,c){for(var e=-1,f=0;c+f<a.length;f++)if(a[c+f]===b[-1===e?0:f-e]){if(-1===e&&(e=f),f-e+1===
b.length)return c+e}else e=-1;return-1}2147483647<c?c=2147483647:-2147483648>c&&(c=-2147483648);c>>=0;if(0===this.length||c>=this.length)return-1;0>c&&(c=Math.max(this.length+c,0));if("string"===typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,c);if(b.isBuffer(a))return d(this,a,c);if("number"===typeof a)return b.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,c):d(this,[a],c);throw new TypeError("val must be string, number or Buffer");
};b.prototype.get=function(a){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(a)};b.prototype.set=function(a,b){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(a,b)};b.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"===typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b|=0,isFinite(c)?(c|=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b;b=
c|0;c=e}e=this.length-b;if(void 0===c||c>e)c=e;if(0<a.length&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(e=!1;;)switch(d){case "hex":b=Number(b)||0;d=this.length-b;c?(c=Number(c),c>d&&(c=d)):c=d;d=a.length;if(0!==d%2)throw Error("Invalid hex string");c>d/2&&(c=d/2);for(d=0;d<c;d++){e=parseInt(a.substr(2*d,2),16);if(isNaN(e))throw Error("Invalid hex string");this[b+d]=e}return d;case "utf8":case "utf-8":return t(r(a,this.length-b),this,
b,c);case "ascii":return t(v(a),this,b,c);case "binary":return t(v(a),this,b,c);case "base64":return t(C.toByteArray(w(a)),this,b,c);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=this.length-b;for(var f=void 0,f=e=void 0,m=[],g=0;g<a.length&&!(0>(d-=2));g++)f=a.charCodeAt(g),e=f>>8,f%=256,m.push(f),m.push(e);return t(m,this,b,c);default:if(e)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();e=!0}};b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||
this,0)}};b.prototype.slice=function(a,c){var d=this.length;a=~~a;c=void 0===c?d:~~c;0>a?(a+=d,0>a&&(a=0)):a>d&&(a=d);0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d);c<a&&(c=a);if(b.TYPED_ARRAY_SUPPORT)d=b._augment(this.subarray(a,c));else for(var e=c-a,d=new b(e,void 0),f=0;f<e;f++)d[f]=this[f+a];d.length&&(d.parent=this.parent||this);return d};b.prototype.readUIntLE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=this[b];for(var e=1,f=0;++f<c&&(e*=256);)d+=this[b+f]*e;return d};b.prototype.readUIntBE=function(b,
c,d){b|=0;c|=0;d||a(b,c,this.length);d=this[b+--c];for(var e=1;0<c&&(e*=256);)d+=this[b+--c]*e;return d};b.prototype.readUInt8=function(b,c){c||a(b,1,this.length);return this[b]};b.prototype.readUInt16LE=function(b,c){c||a(b,2,this.length);return this[b]|this[b+1]<<8};b.prototype.readUInt16BE=function(b,c){c||a(b,2,this.length);return this[b]<<8|this[b+1]};b.prototype.readUInt32LE=function(b,c){c||a(b,4,this.length);return(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]};b.prototype.readUInt32BE=
function(b,c){c||a(b,4,this.length);return 16777216*this[b]+(this[b+1]<<16|this[b+2]<<8|this[b+3])};b.prototype.readIntLE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=this[b];for(var e=1,f=0;++f<c&&(e*=256);)d+=this[b+f]*e;d>=128*e&&(d-=Math.pow(2,8*c));return d};b.prototype.readIntBE=function(b,c,d){b|=0;c|=0;d||a(b,c,this.length);d=c;for(var e=1,f=this[b+--d];0<d&&(e*=256);)f+=this[b+--d]*e;f>=128*e&&(f-=Math.pow(2,8*c));return f};b.prototype.readInt8=function(b,c){c||a(b,1,this.length);return this[b]&
128?-1*(255-this[b]+1):this[b]};b.prototype.readInt16LE=function(b,c){c||a(b,2,this.length);var d=this[b]|this[b+1]<<8;return d&32768?d|4294901760:d};b.prototype.readInt16BE=function(b,c){c||a(b,2,this.length);var d=this[b+1]|this[b]<<8;return d&32768?d|4294901760:d};b.prototype.readInt32LE=function(b,c){c||a(b,4,this.length);return this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24};b.prototype.readInt32BE=function(b,c){c||a(b,4,this.length);return this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]};
b.prototype.readFloatLE=function(b,c){c||a(b,4,this.length);return q.read(this,b,!0,23,4)};b.prototype.readFloatBE=function(b,c){c||a(b,4,this.length);return q.read(this,b,!1,23,4)};b.prototype.readDoubleLE=function(b,c){c||a(b,8,this.length);return q.read(this,b,!0,52,8)};b.prototype.readDoubleBE=function(b,c){c||a(b,8,this.length);return q.read(this,b,!1,52,8)};b.prototype.writeUIntLE=function(a,b,c,d){a=+a;b|=0;c|=0;d||m(this,a,b,c,Math.pow(2,8*c),0);d=1;var e=0;for(this[b]=a&255;++e<c&&(d*=256);)this[b+
e]=a/d&255;return b+c};b.prototype.writeUIntBE=function(a,b,c,d){a=+a;b|=0;c|=0;d||m(this,a,b,c,Math.pow(2,8*c),0);d=c-1;var e=1;for(this[b+d]=a&255;0<=--d&&(e*=256);)this[b+d]=a/e&255;return b+c};b.prototype.writeUInt8=function(a,c,d){a=+a;c|=0;d||m(this,a,c,1,255,0);b.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[c]=a;return c+1};b.prototype.writeUInt16LE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,2,65535,0);b.TYPED_ARRAY_SUPPORT?(this[c]=a,this[c+1]=a>>>8):n(this,a,c,!0);return c+2};b.prototype.writeUInt16BE=
function(a,c,d){a=+a;c|=0;d||m(this,a,c,2,65535,0);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a):n(this,a,c,!1);return c+2};b.prototype.writeUInt32LE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,4,4294967295,0);b.TYPED_ARRAY_SUPPORT?(this[c+3]=a>>>24,this[c+2]=a>>>16,this[c+1]=a>>>8,this[c]=a):p(this,a,c,!0);return c+4};b.prototype.writeUInt32BE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,4,4294967295,0);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a):p(this,a,c,!1);
return c+4};b.prototype.writeIntLE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),m(this,a,b,c,d-1,-d));d=0;var e=1,f=0>a?1:0;for(this[b]=a&255;++d<c&&(e*=256);)this[b+d]=(a/e>>0)-f&255;return b+c};b.prototype.writeIntBE=function(a,b,c,d){a=+a;b|=0;d||(d=Math.pow(2,8*c-1),m(this,a,b,c,d-1,-d));d=c-1;var e=1,f=0>a?1:0;for(this[b+d]=a&255;0<=--d&&(e*=256);)this[b+d]=(a/e>>0)-f&255;return b+c};b.prototype.writeInt8=function(a,c,d){a=+a;c|=0;d||m(this,a,c,1,127,-128);b.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));
0>a&&(a=255+a+1);this[c]=a;return c+1};b.prototype.writeInt16LE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,2,32767,-32768);b.TYPED_ARRAY_SUPPORT?(this[c]=a,this[c+1]=a>>>8):n(this,a,c,!0);return c+2};b.prototype.writeInt16BE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,2,32767,-32768);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a):n(this,a,c,!1);return c+2};b.prototype.writeInt32LE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,4,2147483647,-2147483648);b.TYPED_ARRAY_SUPPORT?(this[c]=a,this[c+1]=a>>>8,this[c+
2]=a>>>16,this[c+3]=a>>>24):p(this,a,c,!0);return c+4};b.prototype.writeInt32BE=function(a,c,d){a=+a;c|=0;d||m(this,a,c,4,2147483647,-2147483648);0>a&&(a=4294967295+a+1);b.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a):p(this,a,c,!1);return c+4};b.prototype.writeFloatLE=function(a,b,c){return A(this,a,b,!0,c)};b.prototype.writeFloatBE=function(a,b,c){return A(this,a,b,!1,c)};b.prototype.writeDoubleLE=function(a,b,c){return z(this,a,b,!0,c)};b.prototype.writeDoubleBE=
function(a,b,c){return z(this,a,b,!1,c)};b.prototype.copy=function(a,c,d,e){d||(d=0);e||0===e||(e=this.length);c>=a.length&&(c=a.length);c||(c=0);0<e&&e<d&&(e=d);if(e===d||0===a.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length);a.length-c<e-d&&(e=a.length-c+d);e-=d;if(1E3>e||!b.TYPED_ARRAY_SUPPORT)for(var f=
0;f<e;f++)a[f+c]=this[f+d];else a._set(this.subarray(d,d+e),c);return e};b.prototype.fill=function(a,b,c){a||(a=0);b||(b=0);c||(c=this.length);if(c<b)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");if("number"===typeof a)for(;b<c;b++)this[b]=a;else{a=r(a.toString());for(var d=a.length;b<c;b++)this[b]=a[b%d]}return this}};b.prototype.toArrayBuffer=function(){if("undefined"!==
typeof Uint8Array){if(b.TYPED_ARRAY_SUPPORT)return(new b(this)).buffer;for(var a=new Uint8Array(this.length),c=0,d=a.length;c<d;c+=1)a[c]=this[c];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser");};var x=b.prototype;b._augment=function(a){a.constructor=b;a._isBuffer=!0;a._set=a.set;a.get=x.get;a.set=x.set;a.write=x.write;a.toString=x.toString;a.toLocaleString=x.toString;a.toJSON=x.toJSON;a.equals=x.equals;a.compare=x.compare;a.indexOf=x.indexOf;a.copy=x.copy;
a.slice=x.slice;a.readUIntLE=x.readUIntLE;a.readUIntBE=x.readUIntBE;a.readUInt8=x.readUInt8;a.readUInt16LE=x.readUInt16LE;a.readUInt16BE=x.readUInt16BE;a.readUInt32LE=x.readUInt32LE;a.readUInt32BE=x.readUInt32BE;a.readIntLE=x.readIntLE;a.readIntBE=x.readIntBE;a.readInt8=x.readInt8;a.readInt16LE=x.readInt16LE;a.readInt16BE=x.readInt16BE;a.readInt32LE=x.readInt32LE;a.readInt32BE=x.readInt32BE;a.readFloatLE=x.readFloatLE;a.readFloatBE=x.readFloatBE;a.readDoubleLE=x.readDoubleLE;a.readDoubleBE=x.readDoubleBE;
a.writeUInt8=x.writeUInt8;a.writeUIntLE=x.writeUIntLE;a.writeUIntBE=x.writeUIntBE;a.writeUInt16LE=x.writeUInt16LE;a.writeUInt16BE=x.writeUInt16BE;a.writeUInt32LE=x.writeUInt32LE;a.writeUInt32BE=x.writeUInt32BE;a.writeIntLE=x.writeIntLE;a.writeIntBE=x.writeIntBE;a.writeInt8=x.writeInt8;a.writeInt16LE=x.writeInt16LE;a.writeInt16BE=x.writeInt16BE;a.writeInt32LE=x.writeInt32LE;a.writeInt32BE=x.writeInt32BE;a.writeFloatLE=x.writeFloatLE;a.writeFloatBE=x.writeFloatBE;a.writeDoubleLE=x.writeDoubleLE;a.writeDoubleBE=
x.writeDoubleBE;a.fill=x.fill;a.inspect=x.inspect;a.toArrayBuffer=x.toArrayBuffer;return a};var H=/[^+\/0-9A-z\-]/g},{"base64-js":28,ieee754:29,"is-array":30}],28:[function(h,k,l){(function(b){function g(b){b=b.charCodeAt(0);if(43===b||45===b)return 62;if(47===b||95===b)return 63;if(48>b)return-1;if(58>b)return b-48+52;if(91>b)return b-65;if(123>b)return b-97+26}var e="undefined"!==typeof Uint8Array?Uint8Array:Array;b.toByteArray=function(b){function c(a){p[h++]=a}var d,a,m,n,p;if(0<b.length%4)throw Error("Invalid string. Length must be a multiple of 4");
d=b.length;n="="===b.charAt(d-2)?2:"="===b.charAt(d-1)?1:0;p=new e(3*b.length/4-n);a=0<n?b.length-4:b.length;var h=0;for(d=0;d<a;d+=4)m=g(b.charAt(d))<<18|g(b.charAt(d+1))<<12|g(b.charAt(d+2))<<6|g(b.charAt(d+3)),c((m&16711680)>>16),c((m&65280)>>8),c(m&255);2===n?(m=g(b.charAt(d))<<2|g(b.charAt(d+1))>>4,c(m&255)):1===n&&(m=g(b.charAt(d))<<10|g(b.charAt(d+1))<<4|g(b.charAt(d+2))>>2,c(m>>8&255),c(m&255));return p};b.fromByteArray=function(b){var c,d=b.length%3,a="",e,g;c=0;for(g=b.length-d;c<g;c+=3)e=
(b[c]<<16)+(b[c+1]<<8)+b[c+2],e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e&63),a+=e;switch(d){case 1:e=b[b.length-1];a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e<<
4&63);a+="==";break;case 2:e=(b[b.length-2]<<8)+b[b.length-1],a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>10),a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>4&63),a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e<<2&63),a+="="}return a}})("undefined"===typeof l?this.base64js={}:l)},{}],29:[function(h,k,l){l.read=function(b,g,e,f,c){var d;d=8*c-f-1;var a=(1<<d)-1,m=a>>1,n=-7;c=e?c-1:0;var p=e?-1:1,h=b[g+
c];c+=p;e=h&(1<<-n)-1;h>>=-n;for(n+=d;0<n;e=256*e+b[g+c],c+=p,n-=8);d=e&(1<<-n)-1;e>>=-n;for(n+=f;0<n;d=256*d+b[g+c],c+=p,n-=8);if(0===e)e=1-m;else{if(e===a)return d?NaN:Infinity*(h?-1:1);d+=Math.pow(2,f);e-=m}return(h?-1:1)*d*Math.pow(2,e-f)};l.write=function(b,g,e,f,c,d){var a,m=8*d-c-1,n=(1<<m)-1,p=n>>1,h=23===c?Math.pow(2,-24)-Math.pow(2,-77):0;d=f?0:d-1;var k=f?1:-1,l=0>g||0===g&&0>1/g?1:0;g=Math.abs(g);isNaN(g)||Infinity===g?(g=isNaN(g)?1:0,f=n):(f=Math.floor(Math.log(g)/Math.LN2),1>g*(a=Math.pow(2,
-f))&&(f--,a*=2),g=1<=f+p?g+h/a:g+h*Math.pow(2,1-p),2<=g*a&&(f++,a/=2),f+p>=n?(g=0,f=n):1<=f+p?(g=(g*a-1)*Math.pow(2,c),f+=p):(g=g*Math.pow(2,p-1)*Math.pow(2,c),f=0));for(;8<=c;b[e+d]=g&255,d+=k,g/=256,c-=8);f=f<<c|g;for(m+=c;0<m;b[e+d]=f&255,d+=k,f/=256,m-=8);b[e+d-k]|=128*l}},{}],30:[function(h,k,l){var b=Object.prototype.toString;k.exports=Array.isArray||function(g){return!!g&&"[object Array]"==b.call(g)}},{}],31:[function(h,k,l){function b(){this._events=this._events||{};this._maxListeners=this._maxListeners||
void 0}function g(b){return"function"===typeof b}function e(b){return"object"===typeof b&&null!==b}k.exports=b;b.EventEmitter=b;b.prototype._events=void 0;b.prototype._maxListeners=void 0;b.defaultMaxListeners=10;b.prototype.setMaxListeners=function(b){if("number"!==typeof b||0>b||isNaN(b))throw TypeError("n must be a positive number");this._maxListeners=b;return this};b.prototype.emit=function(b){var c,d,a,m;this._events||(this._events={});if("error"===b&&(!this._events.error||e(this._events.error)&&
!this._events.error.length)){c=arguments[1];if(c instanceof Error)throw c;throw TypeError('Uncaught, unspecified "error" event.');}d=this._events[b];if(void 0===d)return!1;if(g(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:c=arguments.length;a=Array(c-1);for(m=1;m<c;m++)a[m-1]=arguments[m];d.apply(this,a)}else if(e(d)){c=arguments.length;a=Array(c-1);for(m=1;m<c;m++)a[m-1]=arguments[m];d=d.slice();
c=d.length;for(m=0;m<c;m++)d[m].apply(this,a)}return!0};b.prototype.addListener=function(f,c){var d;if(!g(c))throw TypeError("listener must be a function");this._events||(this._events={});this._events.newListener&&this.emit("newListener",f,g(c.listener)?c.listener:c);this._events[f]?e(this._events[f])?this._events[f].push(c):this._events[f]=[this._events[f],c]:this._events[f]=c;e(this._events[f])&&!this._events[f].warned&&(d=void 0!==this._maxListeners?this._maxListeners:b.defaultMaxListeners)&&0<
d&&this._events[f].length>d&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),"function"===typeof console.trace&&console.trace());return this};b.prototype.on=b.prototype.addListener;b.prototype.once=function(b,c){function d(){this.removeListener(b,d);a||(a=!0,c.apply(this,arguments))}if(!g(c))throw TypeError("listener must be a function");var a=!1;d.listener=
c;this.on(b,d);return this};b.prototype.removeListener=function(b,c){var d,a,m;if(!g(c))throw TypeError("listener must be a function");if(!this._events||!this._events[b])return this;d=this._events[b];m=d.length;a=-1;if(d===c||g(d.listener)&&d.listener===c)delete this._events[b],this._events.removeListener&&this.emit("removeListener",b,c);else if(e(d)){for(;0<m--;)if(d[m]===c||d[m].listener&&d[m].listener===c){a=m;break}if(0>a)return this;1===d.length?(d.length=0,delete this._events[b]):d.splice(a,
1);this._events.removeListener&&this.emit("removeListener",b,c)}return this};b.prototype.removeAllListeners=function(b){var c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[b]&&delete this._events[b],this;if(0===arguments.length){for(c in this._events)"removeListener"!==c&&this.removeAllListeners(c);this.removeAllListeners("removeListener");this._events={};return this}c=this._events[b];if(g(c))this.removeListener(b,c);else for(;c.length;)this.removeListener(b,
c[c.length-1]);delete this._events[b];return this};b.prototype.listeners=function(b){return this._events&&this._events[b]?g(this._events[b])?[this._events[b]]:this._events[b].slice():[]};b.listenerCount=function(b,c){return b._events&&b._events[c]?g(b._events[c])?1:b._events[c].length:0}},{}],32:[function(h,k,l){k.exports="function"===typeof Object.create?function(b,g){b.super_=g;b.prototype=Object.create(g.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:function(b,g){b.super_=
g;var e=function(){};e.prototype=g.prototype;b.prototype=new e;b.prototype.constructor=b}},{}],33:[function(h,k,l){function b(){if(!f){f=!0;for(var b,d=e.length;d;){b=e;e=[];for(var a=-1;++a<d;)b[a]();d=e.length}f=!1}}function g(){}h=k.exports={};var e=[],f=!1;h.nextTick=function(c){e.push(c);f||setTimeout(b,0)};h.title="browser";h.browser=!0;h.env={};h.argv=[];h.version="";h.versions={};h.on=g;h.addListener=g;h.once=g;h.off=g;h.removeListener=g;h.removeAllListeners=g;h.emit=g;h.binding=function(b){throw Error("process.binding is not supported");
};h.cwd=function(){return"/"};h.chdir=function(b){throw Error("process.chdir is not supported");};h.umask=function(){return 0}},{}],34:[function(h,k,l){k.exports=function(b){return b&&"object"===typeof b&&"function"===typeof b.copy&&"function"===typeof b.fill&&"function"===typeof b.readUInt8}},{}],35:[function(h,k,l){(function(b,g){function e(b,d){var e={seen:[],stylize:c};3<=arguments.length&&(e.depth=arguments[2]);4<=arguments.length&&(e.colors=arguments[3]);w(d)?e.showHidden=d:d&&l._extend(e,d);
t(e.showHidden)&&(e.showHidden=!1);t(e.depth)&&(e.depth=2);t(e.colors)&&(e.colors=!1);t(e.customInspect)&&(e.customInspect=!0);e.colors&&(e.stylize=f);return a(e,b,e.depth)}function f(a,b){var c=e.styles[b];return c?"\u001b["+e.colors[c][0]+"m"+a+"\u001b["+e.colors[c][1]+"m":a}function c(a,b){return a}function d(a){var b={};a.forEach(function(a,c){b[a]=!0});return b}function a(b,c,e){if(b.customInspect&&c&&F(c.inspect)&&c.inspect!==l.inspect&&(!c.constructor||c.constructor.prototype!==c)){var f=c.inspect(e,
b);v(f)||(f=a(b,f,e));return f}if(f=m(b,c))return f;var g=Object.keys(c),h=d(g);b.showHidden&&(g=Object.getOwnPropertyNames(c));if(E(c)&&(0<=g.indexOf("message")||0<=g.indexOf("description")))return n(c);if(0===g.length){if(F(c))return b.stylize("[Function"+(c.name?": "+c.name:"")+"]","special");if(u(c))return b.stylize(RegExp.prototype.toString.call(c),"regexp");if(q(c))return b.stylize(Date.prototype.toString.call(c),"date");if(E(c))return n(c)}var f="",r=!1,B=["{","}"];z(c)&&(r=!0,B=["[","]"]);
F(c)&&(f=" [Function"+(c.name?": "+c.name:"")+"]");u(c)&&(f=" "+RegExp.prototype.toString.call(c));q(c)&&(f=" "+Date.prototype.toUTCString.call(c));E(c)&&(f=" "+n(c));if(0===g.length&&(!r||0==c.length))return B[0]+f+B[1];if(0>e)return u(c)?b.stylize(RegExp.prototype.toString.call(c),"regexp"):b.stylize("[Object]","special");b.seen.push(c);g=r?p(b,c,e,h,g):g.map(function(a){return k(b,c,e,h,a,r)});b.seen.pop();return A(g,f,B)}function m(a,b){if(t(b))return a.stylize("undefined","undefined");if(v(b)){var c=
"'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}if(r(b))return a.stylize(""+b,"number");if(w(b))return a.stylize(""+b,"boolean");if(null===b)return a.stylize("null","null")}function n(a){return"["+Error.prototype.toString.call(a)+"]"}function p(a,b,c,d,e){for(var f=[],m=0,g=b.length;m<g;++m)Object.prototype.hasOwnProperty.call(b,String(m))?f.push(k(a,b,c,d,String(m),!0)):f.push("");e.forEach(function(e){e.match(/^\d+$/)||f.push(k(a,
b,c,d,e,!0))});return f}function k(b,c,d,e,f,m){var g,n;c=Object.getOwnPropertyDescriptor(c,f)||{value:c[f]};c.get?n=c.set?b.stylize("[Getter/Setter]","special"):b.stylize("[Getter]","special"):c.set&&(n=b.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(e,f)||(g="["+f+"]");n||(0>b.seen.indexOf(c.value)?(n=null===d?a(b,c.value,null):a(b,c.value,d-1),-1<n.indexOf("\n")&&(n=m?n.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+n.split("\n").map(function(a){return"   "+
a}).join("\n"))):n=b.stylize("[Circular]","special"));if(t(g)){if(m&&f.match(/^\d+$/))return n;g=JSON.stringify(""+f);g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=b.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=b.stylize(g,"string"))}return g+": "+n}function A(a,b,c){var d=0;return 60<a.reduce(function(a,b){d++;0<=b.indexOf("\n")&&d++;return a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+
" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function z(a){return Array.isArray(a)}function w(a){return"boolean"===typeof a}function r(a){return"number"===typeof a}function v(a){return"string"===typeof a}function t(a){return void 0===a}function u(a){return C(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function C(a){return"object"===typeof a&&null!==a}function q(a){return C(a)&&"[object Date]"===Object.prototype.toString.call(a)}function E(a){return C(a)&&("[object Error]"===Object.prototype.toString.call(a)||
a instanceof Error)}function F(a){return"function"===typeof a}function B(a){return 10>a?"0"+a.toString(10):a.toString(10)}function x(){var a=new Date,b=[B(a.getHours()),B(a.getMinutes()),B(a.getSeconds())].join(":");return[a.getDate(),O[a.getMonth()],b].join(" ")}var H=/%[sdj%]/g;l.format=function(a){if(!v(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,b=String(a).replace(H,function(a){if("%%"===a)return"%";if(c>=f)return a;
switch(a){case "%s":return String(d[c++]);case "%d":return Number(d[c++]);case "%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),m=d[c];c<f;m=d[++c])b=null!==m&&C(m)?b+(" "+e(m)):b+(" "+m);return b};l.deprecate=function(a,c){if(t(g.process))return function(){return l.deprecate(a,c).apply(this,arguments)};if(!0===b.noDeprecation)return a;var d=!1;return function(){if(!d){if(b.throwDeprecation)throw Error(c);b.traceDeprecation?console.trace(c):console.error(c);d=
!0}return a.apply(this,arguments)}};var G={},I;l.debuglog=function(a){t(I)&&(I=b.env.NODE_DEBUG||"");a=a.toUpperCase();if(!G[a])if((new RegExp("\\b"+a+"\\b","i")).test(I)){var c=b.pid;G[a]=function(){var b=l.format.apply(l,arguments);console.error("%s %d: %s",a,c,b)}}else G[a]=function(){};return G[a]};l.inspect=e;e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,
39]};e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};l.isArray=z;l.isBoolean=w;l.isNull=function(a){return null===a};l.isNullOrUndefined=function(a){return null==a};l.isNumber=r;l.isString=v;l.isSymbol=function(a){return"symbol"===typeof a};l.isUndefined=t;l.isRegExp=u;l.isObject=C;l.isDate=q;l.isError=E;l.isFunction=F;l.isPrimitive=function(a){return null===a||"boolean"===typeof a||"number"===typeof a||"string"===
typeof a||"symbol"===typeof a||"undefined"===typeof a};l.isBuffer=h("./support/isBuffer");var O="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");l.log=function(){console.log("%s - %s",x(),l.format.apply(l,arguments))};l.inherits=h("inherits");l._extend=function(a,b){if(!b||!C(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,h("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":34,
_process:33,inherits:32}],36:[function(h,k,l){k.exports=h("./is-implemented")()?Map:h("./polyfill")},{"./is-implemented":37,"./polyfill":90}],37:[function(h,k,l){k.exports=function(){var b;if("function"!==typeof Map)return!1;try{b=new Map([["raz","one"],["dwa","two"],["trzy","three"]])}catch(g){return!1}if(3!==b.size||"function"!==typeof b.clear||"function"!==typeof b.delete||"function"!==typeof b.entries||"function"!==typeof b.forEach||"function"!==typeof b.get||"function"!==typeof b.has||"function"!==
typeof b.keys||"function"!==typeof b.set||"function"!==typeof b.values)return!1;b=b.entries().next();return!1===b.done&&b.value&&"raz"===b.value[0]&&"one"===b.value[1]?!0:!1}},{}],38:[function(h,k,l){h="undefined"===typeof Map?!1:"[object Map]"===Object.prototype.toString.call(Map.prototype);k.exports=h},{}],39:[function(h,k,l){k.exports=h("es5-ext/object/primitive-set")("key","value","key+value")},{"es5-ext/object/primitive-set":64}],40:[function(h,k,l){l=h("es5-ext/object/set-prototype-of");var b=
h("d"),g=h("es6-iterator"),e=h("es6-symbol").toStringTag,f=h("./iterator-kinds"),c=Object.defineProperties,d=g.prototype._unBind,a;a=k.exports=function(d,e){if(!(this instanceof a))return new a(d,e);g.call(this,d.__mapKeysData__,d);e&&f[e]||(e="key+value");c(this,{__kind__:b("",e),__values__:b("w",d.__mapValuesData__)})};l&&l(a,g);a.prototype=Object.create(g.prototype,{constructor:b(a),_resolve:b(function(a){return"value"===this.__kind__?this.__values__[a]:"key"===this.__kind__?this.__list__[a]:[this.__list__[a],
this.__values__[a]]}),_unBind:b(function(){this.__values__=null;d.call(this)}),toString:b(function(){return"[object Map Iterator]"})});Object.defineProperty(a.prototype,e,b("c","Map Iterator"))},{"./iterator-kinds":39,d:42,"es5-ext/object/set-prototype-of":65,"es6-iterator":77,"es6-symbol":86}],41:[function(h,k,l){var b=h("es5-ext/object/copy"),g=h("es5-ext/object/map"),e=h("es5-ext/object/valid-callable"),f=h("es5-ext/object/valid-value"),c=Function.prototype.bind,d=Object.defineProperty,a=Object.prototype.hasOwnProperty,
m;m=function(m,g,h){var k=f(g)&&e(g.value),l;l=b(g);delete l.writable;delete l.value;l.get=function(){if(a.call(this,m))return k;g.value=c.call(k,null==h?this:this[h]);d(this,m,g);return this[m]};return l};k.exports=function(a,b){return g(a,function(a,c){return m(c,a,b)})}},{"es5-ext/object/copy":54,"es5-ext/object/map":62,"es5-ext/object/valid-callable":68,"es5-ext/object/valid-value":69}],42:[function(h,k,l){var b=h("es5-ext/object/assign"),g=h("es5-ext/object/normalize-options"),e=h("es5-ext/object/is-callable"),
f=h("es5-ext/string/#/contains");(k.exports=function(c,d){var a,e,n,p;2>arguments.length||"string"!==typeof c?(p=d,d=c,c=null):p=arguments[2];null==c?(a=n=!0,e=!1):(a=f.call(c,"c"),e=f.call(c,"e"),n=f.call(c,"w"));a={value:d,configurable:a,enumerable:e,writable:n};return p?b(g(p),a):a}).gs=function(c,d,a,m){var n;"string"!==typeof c&&(m=a,a=d,d=c,c=null);null==d?d=void 0:e(d)?null==a?a=void 0:e(a)||(m=a,a=void 0):(m=d,d=a=void 0);null==c?(n=!0,c=!1):(n=f.call(c,"c"),c=f.call(c,"e"));d={get:d,set:a,
configurable:n,enumerable:c};return m?b(g(m),d):d}},{"es5-ext/object/assign":51,"es5-ext/object/is-callable":57,"es5-ext/object/normalize-options":63,"es5-ext/string/#/contains":70}],43:[function(h,k,l){var b=h("../../object/valid-value");k.exports=function(){b(this).length=0;return this}},{"../../object/valid-value":69}],44:[function(h,k,l){var b=h("../../number/to-pos-integer"),g=h("../../object/valid-value"),e=Array.prototype.indexOf,f=Object.prototype.hasOwnProperty,c=Math.abs,d=Math.floor;k.exports=
function(a){var m,n,p;if(a===a)return e.apply(this,arguments);n=b(g(this).length);m=arguments[1];for(m=isNaN(m)?0:0<=m?d(m):b(this.length)-d(c(m));m<n;++m)if(f.call(this,m)&&(p=this[m],p!==p))return m;return-1}},{"../../number/to-pos-integer":49,"../../object/valid-value":69}],45:[function(h,k,l){k.exports=h("./is-implemented")()?Math.sign:h("./shim")},{"./is-implemented":46,"./shim":47}],46:[function(h,k,l){k.exports=function(){var b=Math.sign;return"function"!==typeof b?!1:1===b(10)&&-1===b(-20)}},
{}],47:[function(h,k,l){k.exports=function(b){b=Number(b);return isNaN(b)||0===b?b:0<b?1:-1}},{}],48:[function(h,k,l){var b=h("../math/sign"),g=Math.abs,e=Math.floor;k.exports=function(f){if(isNaN(f))return 0;f=Number(f);return 0!==f&&isFinite(f)?b(f)*e(g(f)):f}},{"../math/sign":45}],49:[function(h,k,l){var b=h("./to-integer"),g=Math.max;k.exports=function(e){return g(0,b(e))}},{"./to-integer":48}],50:[function(h,k,l){var b=h("./is-callable"),g=h("./valid-callable"),e=h("./valid-value"),f=Function.prototype.call,
c=Object.keys,d=Object.prototype.propertyIsEnumerable;k.exports=function(a,m){return function(n,p,h,k){var l;n=Object(e(n));g(p);l=c(n);k&&l.sort(b(k)?k.bind(n):void 0);return l[a](function(a,b){return d.call(n,a)?f.call(p,h,n[a],a,n,b):m})}}},{"./is-callable":57,"./valid-callable":68,"./valid-value":69}],51:[function(h,k,l){k.exports=h("./is-implemented")()?Object.assign:h("./shim")},{"./is-implemented":52,"./shim":53}],52:[function(h,k,l){k.exports=function(){var b=Object.assign,g;if("function"!==
typeof b)return!1;g={foo:"raz"};b(g,{bar:"dwa"},{trzy:"trzy"});return"razdwatrzy"===g.foo+g.bar+g.trzy}},{}],53:[function(h,k,l){var b=h("../keys"),g=h("../valid-value"),e=Math.max;k.exports=function(f,c){var d,a,m=e(arguments.length,2),n;f=Object(g(f));n=function(a){try{f[a]=c[a]}catch(b){d||(d=b)}};for(a=1;a<m;++a)c=arguments[a],b(c).forEach(n);if(void 0!==d)throw d;return f}},{"../keys":59,"../valid-value":69}],54:[function(h,k,l){var b=h("./assign"),g=h("./valid-value");k.exports=function(e){var f=
Object(g(e));return f!==e?f:b({},e)}},{"./assign":51,"./valid-value":69}],55:[function(h,k,l){var b=Object.create,g;h("./set-prototype-of/is-implemented")()||(g=h("./set-prototype-of/shim"));k.exports=function(){var e,f,c;if(!g||1!==g.level)return b;e={};f={};c={configurable:!1,enumerable:!1,writable:!0,value:void 0};Object.getOwnPropertyNames(Object.prototype).forEach(function(b){f[b]="__proto__"===b?{configurable:!0,enumerable:!1,writable:!0,value:void 0}:c});Object.defineProperties(e,f);Object.defineProperty(g,
"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e});return function(c,a){return b(null===c?e:c,a)}}()},{"./set-prototype-of/is-implemented":66,"./set-prototype-of/shim":67}],56:[function(h,k,l){k.exports=h("./_iterate")("forEach")},{"./_iterate":50}],57:[function(h,k,l){k.exports=function(b){return"function"===typeof b}},{}],58:[function(h,k,l){var b={function:!0,object:!0};k.exports=function(g){return null!=g&&b[typeof g]||!1}},{}],59:[function(h,k,l){k.exports=h("./is-implemented")()?
Object.keys:h("./shim")},{"./is-implemented":60,"./shim":61}],60:[function(h,k,l){k.exports=function(){try{return Object.keys("primitive"),!0}catch(b){return!1}}},{}],61:[function(h,k,l){var b=Object.keys;k.exports=function(g){return b(null==g?g:Object(g))}},{}],62:[function(h,k,l){var b=h("./valid-callable"),g=h("./for-each"),e=Function.prototype.call;k.exports=function(f,c,d){var a={};b(c);g(f,function(b,f,g,h){a[f]=e.call(c,d,b,f,g,h)});return a}},{"./for-each":56,"./valid-callable":68}],63:[function(h,
k,l){var b=Array.prototype.forEach,g=Object.create;k.exports=function(e){var f=g(null);b.call(arguments,function(b){if(null!=b){b=Object(b);var d=f,a;for(a in b)d[a]=b[a]}});return f}},{}],64:[function(h,k,l){var b=Array.prototype.forEach,g=Object.create;k.exports=function(e){var f=g(null);b.call(arguments,function(b){f[b]=!0});return f}},{}],65:[function(h,k,l){k.exports=h("./is-implemented")()?Object.setPrototypeOf:h("./shim")},{"./is-implemented":66,"./shim":67}],66:[function(h,k,l){var b=Object.create,
g=Object.getPrototypeOf,e={};k.exports=function(f){var c=Object.setPrototypeOf;return"function"!==typeof c?!1:g(c((f||b)(null),e))===e}},{}],67:[function(h,k,l){var b=h("../is-object"),g=h("../valid-value"),e=Object.prototype.isPrototypeOf,f=Object.defineProperty,c={configurable:!0,enumerable:!1,writable:!0,value:void 0},d;d=function(a,c){g(a);if(null===c||b(c))return a;throw new TypeError("Prototype must be null or an object");};k.exports=function(a){var b,g;if(!a)return null;2===a.level?a.set?(g=
a.set,b=function(a,b){g.call(d(a,b),b);return a}):b=function(a,b){d(a,b).__proto__=b;return a}:b=function y(a,b){var m;d(a,b);(m=e.call(y.nullPolyfill,a))&&delete y.nullPolyfill.__proto__;null===b&&(b=y.nullPolyfill);a.__proto__=b;m&&f(y.nullPolyfill,"__proto__",c);return a};return Object.defineProperty(b,"level",{configurable:!1,enumerable:!1,writable:!1,value:a.level})}(function(){var a=Object.create(null),b={},c,d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(d){try{c=d.set,
c.call(a,b)}catch(e){}if(Object.getPrototypeOf(a)===b)return{set:c,level:2}}a.__proto__=b;if(Object.getPrototypeOf(a)===b)return{level:2};a={};a.__proto__=b;return Object.getPrototypeOf(a)===b?{level:1}:!1}());h("../create")},{"../create":55,"../is-object":58,"../valid-value":69}],68:[function(h,k,l){k.exports=function(b){if("function"!==typeof b)throw new TypeError(b+" is not a function");return b}},{}],69:[function(h,k,l){k.exports=function(b){if(null==b)throw new TypeError("Cannot use null or undefined");
return b}},{}],70:[function(h,k,l){k.exports=h("./is-implemented")()?String.prototype.contains:h("./shim")},{"./is-implemented":71,"./shim":72}],71:[function(h,k,l){k.exports=function(){return"function"!==typeof"razdwatrzy".contains?!1:!0==="razdwatrzy".contains("dwa")&&!1==="razdwatrzy".contains("foo")}},{}],72:[function(h,k,l){var b=String.prototype.indexOf;k.exports=function(g,e){return-1<b.call(this,g,e)}},{}],73:[function(h,k,l){var b=Object.prototype.toString,g=b.call("");k.exports=function(e){return"string"===
typeof e||e&&"object"===typeof e&&(e instanceof String||b.call(e)===g)||!1}},{}],74:[function(h,k,l){l=h("es5-ext/object/set-prototype-of");var b=h("es5-ext/string/#/contains"),g=h("d"),e=h("./"),f=Object.defineProperty,c;c=k.exports=function(d,a){if(!(this instanceof c))return new c(d,a);e.call(this,d);a=a?b.call(a,"key+value")?"key+value":b.call(a,"key")?"key":"value":"value";f(this,"__kind__",g("",a))};l&&l(c,e);c.prototype=Object.create(e.prototype,{constructor:g(c),_resolve:g(function(b){return"value"===
this.__kind__?this.__list__[b]:"key+value"===this.__kind__?[b,this.__list__[b]]:b}),toString:g(function(){return"[object Array Iterator]"})})},{"./":77,d:42,"es5-ext/object/set-prototype-of":65,"es5-ext/string/#/contains":70}],75:[function(h,k,l){var b=h("es5-ext/object/valid-callable"),g=h("es5-ext/string/is-string"),e=h("./get"),f=Array.isArray,c=Function.prototype.call;k.exports=function(d,a,m){var n,p,h,k,l,w;f(d)?n="array":g(d)?n="string":d=e(d);b(a);p=function(){h=!0};if("array"===n)d.some(function(b){c.call(a,
m,b,p);if(h)return!0});else if("string"===n)for(k=d.length,n=0;n<k&&(l=d[n],n+1<k&&(w=l.charCodeAt(0),55296<=w&&56319>=w&&(l+=d[++n])),c.call(a,m,l,p),!h);++n);else for(n=d.next();!n.done;){c.call(a,m,n.value,p);if(h)break;n=d.next()}}},{"./get":76,"es5-ext/object/valid-callable":68,"es5-ext/string/is-string":73}],76:[function(h,k,l){var b=h("es5-ext/string/is-string"),g=h("./array"),e=h("./string"),f=h("./valid-iterable"),c=h("es6-symbol").iterator;k.exports=function(d){return"function"===typeof f(d)[c]?
d[c]():b(d)?new e(d):new g(d)}},{"./array":74,"./string":84,"./valid-iterable":85,"es5-ext/string/is-string":73,"es6-symbol":79}],77:[function(h,k,l){var b=h("es5-ext/array/#/clear");l=h("es5-ext/object/assign");var g=h("es5-ext/object/valid-callable"),e=h("es5-ext/object/valid-value"),f=h("d"),c=h("d/auto-bind");h=h("es6-symbol");var d=Object.defineProperty,a=Object.defineProperties,m;k.exports=m=function(b,c){if(!(this instanceof m))return new m(b,c);a(this,{__list__:f("w",e(b)),__context__:f("w",
c),__nextIndex__:f("w",0)});c&&(g(c.on),c.on("_add",this._onAdd),c.on("_delete",this._onDelete),c.on("_clear",this._onClear))};a(m.prototype,l({constructor:f(m),_next:f(function(){var a;if(this.__list__){if(this.__redo__&&(a=this.__redo__.shift(),void 0!==a))return a;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:f(function(){return this._createResult(this._next())}),_createResult:f(function(a){return void 0===a?{done:!0,value:void 0}:{done:!1,value:this._resolve(a)}}),
_resolve:f(function(a){return this.__list__[a]}),_unBind:f(function(){this.__list__=null;delete this.__redo__;this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:f(function(){return"[object Iterator]"})},c({_onAdd:f(function(a){a>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(b,c){b>=a&&(this.__redo__[c]=++b)},this),this.__redo__.push(a)):
d(this,"__redo__",f("c",[a])))}),_onDelete:f(function(a){var b;a>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(b=this.__redo__.indexOf(a),-1!==b&&this.__redo__.splice(b,1),this.__redo__.forEach(function(b,c){b>a&&(this.__redo__[c]=--b)},this)))}),_onClear:f(function(){this.__redo__&&b.call(this.__redo__);this.__nextIndex__=0})})));d(m.prototype,h.iterator,f(function(){return this}));d(m.prototype,h.toStringTag,f("","Iterator"))},{d:42,"d/auto-bind":41,"es5-ext/array/#/clear":43,"es5-ext/object/assign":51,
"es5-ext/object/valid-callable":68,"es5-ext/object/valid-value":69,"es6-symbol":79}],78:[function(h,k,l){var b=h("es5-ext/string/is-string"),g=h("es6-symbol").iterator,e=Array.isArray;k.exports=function(f){return null==f?!1:e(f)||b(f)?!0:"function"===typeof f[g]}},{"es5-ext/string/is-string":73,"es6-symbol":79}],79:[function(h,k,l){k.exports=h("./is-implemented")()?Symbol:h("./polyfill")},{"./is-implemented":80,"./polyfill":82}],80:[function(h,k,l){k.exports=function(){var b;if("function"!==typeof Symbol)return!1;
b=Symbol("test symbol");try{String(b)}catch(g){return!1}return"symbol"===typeof Symbol.iterator?!0:"object"!==typeof Symbol.isConcatSpreadable||"object"!==typeof Symbol.iterator||"object"!==typeof Symbol.toPrimitive||"object"!==typeof Symbol.toStringTag||"object"!==typeof Symbol.unscopables?!1:!0}},{}],81:[function(h,k,l){k.exports=function(b){return b&&("symbol"===typeof b||"Symbol"===b["@@toStringTag"])||!1}},{}],82:[function(h,k,l){var b=h("d"),g=h("./validate-symbol"),e=Object.create,f=Object.defineProperties,
c=Object.defineProperty,d=Object.prototype,a,m,n=e(null),p=function(){var a=e(null);return function(e){for(var f=0,m;a[e+(f||"")];)++f;e+=f||"";a[e]=!0;m="@@"+e;c(d,m,b.gs(null,function(a){c(this,m,b(a))}));return m}}();m=function A(a){if(this instanceof m)throw new TypeError("TypeError: Symbol is not a constructor");return A(a)};k.exports=a=function z(a){var c;if(this instanceof z)throw new TypeError("TypeError: Symbol is not a constructor");c=e(m.prototype);a=void 0===a?"":String(a);return f(c,
{__description__:b("",a),__name__:b("",p(a))})};f(a,{for:b(function(b){return n[b]?n[b]:n[b]=a(String(b))}),keyFor:b(function(a){var b;g(a);for(b in n)if(n[b]===a)return b}),hasInstance:b("",a("hasInstance")),isConcatSpreadable:b("",a("isConcatSpreadable")),iterator:b("",a("iterator")),match:b("",a("match")),replace:b("",a("replace")),search:b("",a("search")),species:b("",a("species")),split:b("",a("split")),toPrimitive:b("",a("toPrimitive")),toStringTag:b("",a("toStringTag")),unscopables:b("",a("unscopables"))});
f(m.prototype,{constructor:b(a),toString:b("",function(){return this.__name__})});f(a.prototype,{toString:b(function(){return"Symbol ("+g(this).__description__+")"}),valueOf:b(function(){return g(this)})});c(a.prototype,a.toPrimitive,b("",function(){return g(this)}));c(a.prototype,a.toStringTag,b("c","Symbol"));c(m.prototype,a.toPrimitive,b("c",a.prototype[a.toPrimitive]));c(m.prototype,a.toStringTag,b("c",a.prototype[a.toStringTag]))},{"./validate-symbol":83,d:42}],83:[function(h,k,l){var b=h("./is-symbol");
k.exports=function(g){if(!b(g))throw new TypeError(g+" is not a symbol");return g}},{"./is-symbol":81}],84:[function(h,k,l){l=h("es5-ext/object/set-prototype-of");var b=h("d"),g=h("./"),e=Object.defineProperty,f;f=k.exports=function(c){if(!(this instanceof f))return new f(c);c=String(c);g.call(this,c);e(this,"__length__",b("",c.length))};l&&l(f,g);f.prototype=Object.create(g.prototype,{constructor:b(f),_next:b(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;
this._unBind()}}),_resolve:b(function(b){b=this.__list__[b];var d;if(this.__nextIndex__===this.__length__)return b;d=b.charCodeAt(0);return 55296<=d&&56319>=d?b+this.__list__[this.__nextIndex__++]:b}),toString:b(function(){return"[object String Iterator]"})})},{"./":77,d:42,"es5-ext/object/set-prototype-of":65}],85:[function(h,k,l){var b=h("./is-iterable");k.exports=function(g){if(!b(g))throw new TypeError(g+" is not iterable");return g}},{"./is-iterable":78}],86:[function(h,k,l){arguments[4][79][0].apply(l,
arguments)},{"./is-implemented":87,"./polyfill":88,dup:79}],87:[function(h,k,l){k.exports=function(){var b;if("function"!==typeof Symbol)return!1;b=Symbol("test symbol");try{String(b)}catch(g){return!1}return"symbol"===typeof Symbol.iterator?!0:"object"!==typeof Symbol.isConcatSpreadable||"object"!==typeof Symbol.isRegExp||"object"!==typeof Symbol.iterator||"object"!==typeof Symbol.toPrimitive||"object"!==typeof Symbol.toStringTag||"object"!==typeof Symbol.unscopables?!1:!0}},{}],88:[function(h,k,
l){var b=h("d"),g=Object.create,e=Object.defineProperties,f,c;f=function(){var b=g(null);return function(a){for(var c=0;b[a+(c||"")];)++c;a+=c||"";b[a]=!0;return"@@"+a}}();k.exports=c=function(d){var a;if(this instanceof c)throw new TypeError("TypeError: Symbol is not a constructor");a=g(c.prototype);d=void 0===d?"":String(d);return e(a,{__description__:b("",d),__name__:b("",f(d))})};Object.defineProperties(c,{create:b("",c("create")),hasInstance:b("",c("hasInstance")),isConcatSpreadable:b("",c("isConcatSpreadable")),
isRegExp:b("",c("isRegExp")),iterator:b("",c("iterator")),toPrimitive:b("",c("toPrimitive")),toStringTag:b("",c("toStringTag")),unscopables:b("",c("unscopables"))});e(c.prototype,{properToString:b(function(){return"Symbol ("+this.__description__+")"}),toString:b("",function(){return this.__name__})});Object.defineProperty(c.prototype,c.toPrimitive,b("",function(b){throw new TypeError("Conversion of symbol objects is not allowed");}));Object.defineProperty(c.prototype,c.toStringTag,b("c","Symbol"))},
{d:42}],89:[function(h,k,l){l=h("d");var b=h("es5-ext/object/valid-callable"),g=Function.prototype.apply,e=Function.prototype.call,f=Object.create,c=Object.defineProperty,d=Object.defineProperties,a=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0},n,p,y,A,z,w;n=function(d,e){var g;b(e);a.call(this,"__ee__")?g=this.__ee__:(g=m.value=f(null),c(this,"__ee__",m),m.value=null);g[d]?"object"===typeof g[d]?g[d].push(e):g[d]=[g[d],e]:g[d]=e;return this};p=function(a,c){var d,
e;b(c);e=this;n.call(this,a,d=function(){y.call(e,a,d);g.call(c,this,arguments)});d.__eeOnceListener__=c;return this};y=function(c,d){var e,f,m,g;b(d);if(!a.call(this,"__ee__"))return this;e=this.__ee__;if(!e[c])return this;f=e[c];if("object"===typeof f)for(g=0;m=f[g];++g){if(m===d||m.__eeOnceListener__===d)2===f.length?e[c]=f[g?0:1]:f.splice(g,1)}else f!==d&&f.__eeOnceListener__!==d||delete e[c];return this};A=function(b){var c,d,f,m;if(a.call(this,"__ee__")&&(f=this.__ee__[b]))if("object"===typeof f){d=
arguments.length;m=Array(d-1);for(c=1;c<d;++c)m[c-1]=arguments[c];f=f.slice();for(c=0;d=f[c];++c)g.call(d,this,m)}else switch(arguments.length){case 1:e.call(f,this);break;case 2:e.call(f,this,arguments[1]);break;case 3:e.call(f,this,arguments[1],arguments[2]);break;default:d=arguments.length;m=Array(d-1);for(c=1;c<d;++c)m[c-1]=arguments[c];g.call(f,this,m)}};h={on:n,once:p,off:y,emit:A};z={on:l(n),once:l(p),off:l(y),emit:l(A)};w=d({},z);k.exports=l=function(a){return null==a?f(w):d(Object(a),z)};
l.methods=h},{d:42,"es5-ext/object/valid-callable":68}],90:[function(h,k,l){var b=h("es5-ext/array/#/clear"),g=h("es5-ext/array/#/e-index-of");l=h("es5-ext/object/set-prototype-of");var e=h("es5-ext/object/valid-callable"),f=h("es5-ext/object/valid-value"),c=h("d"),d=h("event-emitter"),a=h("es6-symbol"),m=h("es6-iterator/valid-iterable"),n=h("es6-iterator/for-of"),p=h("./lib/iterator");h=h("./is-native-implemented");var y=Function.prototype.call,A=Object.defineProperties,z;k.exports=z=function(a){var b,
d;if(!(this instanceof z))return new z(a);if(void 0!==this.__mapKeysData__)throw new TypeError(this+" cannot be reinitialized");null!=a&&m(a);A(this,{__mapKeysData__:c("c",b=[]),__mapValuesData__:c("c",d=[])});a&&n(a,function(a){var c=f(a)[0];a=a[1];-1===g.call(b,c)&&(b.push(c),d.push(a))},this)};h&&(l&&l(z,Map),z.prototype=Object.create(Map.prototype,{constructor:c(z)}));d(A(z.prototype,{clear:c(function(){this.__mapKeysData__.length&&(b.call(this.__mapKeysData__),b.call(this.__mapValuesData__),
this.emit("_clear"))}),delete:c(function(a){var b=g.call(this.__mapKeysData__,a);if(-1===b)return!1;this.__mapKeysData__.splice(b,1);this.__mapValuesData__.splice(b,1);this.emit("_delete",b,a);return!0}),entries:c(function(){return new p(this,"key+value")}),forEach:c(function(a,b){var c,d;e(a);c=this.entries();for(d=c._next();void 0!==d;)y.call(a,b,this.__mapValuesData__[d],this.__mapKeysData__[d],this),d=c._next()}),get:c(function(a){a=g.call(this.__mapKeysData__,a);if(-1!==a)return this.__mapValuesData__[a]}),
has:c(function(a){return-1!==g.call(this.__mapKeysData__,a)}),keys:c(function(){return new p(this,"key")}),set:c(function(a,b){var c=g.call(this.__mapKeysData__,a),d;-1===c&&(c=this.__mapKeysData__.push(a)-1,d=!0);this.__mapValuesData__[c]=b;d&&this.emit("_add",c,a);return this}),size:c.gs(function(){return this.__mapKeysData__.length}),values:c(function(){return new p(this,"value")}),toString:c(function(){return"[object Map]"})}));Object.defineProperty(z.prototype,a.iterator,c(function(){return this.entries()}));
Object.defineProperty(z.prototype,a.toStringTag,c("c","Map"))},{"./is-native-implemented":38,"./lib/iterator":40,d:42,"es5-ext/array/#/clear":43,"es5-ext/array/#/e-index-of":44,"es5-ext/object/set-prototype-of":65,"es5-ext/object/valid-callable":68,"es5-ext/object/valid-value":69,"es6-iterator/for-of":75,"es6-iterator/valid-iterable":85,"es6-symbol":86,"event-emitter":89}],91:[function(h,k,l){k.exports=h("./is-implemented")()?Set:h("./polyfill")},{"./is-implemented":92,"./polyfill":143}],92:[function(h,
k,l){k.exports=function(){var b;if("function"!==typeof Set)return!1;b=new Set(["raz","dwa","trzy"]);if(3!==b.size||"function"!==typeof b.add||"function"!==typeof b.clear||"function"!==typeof b.delete||"function"!==typeof b.entries||"function"!==typeof b.forEach||"function"!==typeof b.has||"function"!==typeof b.keys||"function"!==typeof b.values)return!1;b=b.values().next();return!1!==b.done||"raz"!==b.value?!1:!0}},{}],93:[function(h,k,l){h="undefined"===typeof Set?!1:"[object Set]"===Object.prototype.toString.call(Set.prototype);
k.exports=h},{}],94:[function(h,k,l){l=h("es5-ext/object/set-prototype-of");var b=h("es5-ext/string/#/contains"),g=h("d"),e=h("es6-iterator");h=h("es6-symbol").toStringTag;var f=Object.defineProperty,c;c=k.exports=function(d,a){if(!(this instanceof c))return new c(d,a);e.call(this,d.__setData__,d);a=a?b.call(a,"key+value")?"key+value":"value":"value";f(this,"__kind__",g("",a))};l&&l(c,e);c.prototype=Object.create(e.prototype,{constructor:g(c),_resolve:g(function(b){return"value"===this.__kind__?this.__list__[b]:
[this.__list__[b],this.__list__[b]]}),toString:g(function(){return"[object Set Iterator]"})});f(c.prototype,h,g("c","Set Iterator"))},{d:96,"es5-ext/object/set-prototype-of":118,"es5-ext/string/#/contains":123,"es6-iterator":130,"es6-symbol":139}],95:[function(h,k,l){arguments[4][41][0].apply(l,arguments)},{dup:41,"es5-ext/object/copy":108,"es5-ext/object/map":116,"es5-ext/object/valid-callable":121,"es5-ext/object/valid-value":122}],96:[function(h,k,l){arguments[4][42][0].apply(l,arguments)},{dup:42,
"es5-ext/object/assign":105,"es5-ext/object/is-callable":111,"es5-ext/object/normalize-options":117,"es5-ext/string/#/contains":123}],97:[function(h,k,l){arguments[4][43][0].apply(l,arguments)},{"../../object/valid-value":122,dup:43}],98:[function(h,k,l){arguments[4][44][0].apply(l,arguments)},{"../../number/to-pos-integer":103,"../../object/valid-value":122,dup:44}],99:[function(h,k,l){arguments[4][45][0].apply(l,arguments)},{"./is-implemented":100,"./shim":101,dup:45}],100:[function(h,k,l){arguments[4][46][0].apply(l,
arguments)},{dup:46}],101:[function(h,k,l){arguments[4][47][0].apply(l,arguments)},{dup:47}],102:[function(h,k,l){arguments[4][48][0].apply(l,arguments)},{"../math/sign":99,dup:48}],103:[function(h,k,l){arguments[4][49][0].apply(l,arguments)},{"./to-integer":102,dup:49}],104:[function(h,k,l){arguments[4][50][0].apply(l,arguments)},{"./is-callable":111,"./valid-callable":121,"./valid-value":122,dup:50}],105:[function(h,k,l){arguments[4][51][0].apply(l,arguments)},{"./is-implemented":106,"./shim":107,
dup:51}],106:[function(h,k,l){arguments[4][52][0].apply(l,arguments)},{dup:52}],107:[function(h,k,l){arguments[4][53][0].apply(l,arguments)},{"../keys":113,"../valid-value":122,dup:53}],108:[function(h,k,l){arguments[4][54][0].apply(l,arguments)},{"./assign":105,"./valid-value":122,dup:54}],109:[function(h,k,l){arguments[4][55][0].apply(l,arguments)},{"./set-prototype-of/is-implemented":119,"./set-prototype-of/shim":120,dup:55}],110:[function(h,k,l){arguments[4][56][0].apply(l,arguments)},{"./_iterate":104,
dup:56}],111:[function(h,k,l){arguments[4][57][0].apply(l,arguments)},{dup:57}],112:[function(h,k,l){arguments[4][58][0].apply(l,arguments)},{dup:58}],113:[function(h,k,l){arguments[4][59][0].apply(l,arguments)},{"./is-implemented":114,"./shim":115,dup:59}],114:[function(h,k,l){arguments[4][60][0].apply(l,arguments)},{dup:60}],115:[function(h,k,l){arguments[4][61][0].apply(l,arguments)},{dup:61}],116:[function(h,k,l){arguments[4][62][0].apply(l,arguments)},{"./for-each":110,"./valid-callable":121,
dup:62}],117:[function(h,k,l){arguments[4][63][0].apply(l,arguments)},{dup:63}],118:[function(h,k,l){arguments[4][65][0].apply(l,arguments)},{"./is-implemented":119,"./shim":120,dup:65}],119:[function(h,k,l){arguments[4][66][0].apply(l,arguments)},{dup:66}],120:[function(h,k,l){arguments[4][67][0].apply(l,arguments)},{"../create":109,"../is-object":112,"../valid-value":122,dup:67}],121:[function(h,k,l){arguments[4][68][0].apply(l,arguments)},{dup:68}],122:[function(h,k,l){arguments[4][69][0].apply(l,
arguments)},{dup:69}],123:[function(h,k,l){arguments[4][70][0].apply(l,arguments)},{"./is-implemented":124,"./shim":125,dup:70}],124:[function(h,k,l){arguments[4][71][0].apply(l,arguments)},{dup:71}],125:[function(h,k,l){arguments[4][72][0].apply(l,arguments)},{dup:72}],126:[function(h,k,l){arguments[4][73][0].apply(l,arguments)},{dup:73}],127:[function(h,k,l){arguments[4][74][0].apply(l,arguments)},{"./":130,d:96,dup:74,"es5-ext/object/set-prototype-of":118,"es5-ext/string/#/contains":123}],128:[function(h,
k,l){arguments[4][75][0].apply(l,arguments)},{"./get":129,dup:75,"es5-ext/object/valid-callable":121,"es5-ext/string/is-string":126}],129:[function(h,k,l){arguments[4][76][0].apply(l,arguments)},{"./array":127,"./string":137,"./valid-iterable":138,dup:76,"es5-ext/string/is-string":126,"es6-symbol":132}],130:[function(h,k,l){arguments[4][77][0].apply(l,arguments)},{d:96,"d/auto-bind":95,dup:77,"es5-ext/array/#/clear":97,"es5-ext/object/assign":105,"es5-ext/object/valid-callable":121,"es5-ext/object/valid-value":122,
"es6-symbol":132}],131:[function(h,k,l){arguments[4][78][0].apply(l,arguments)},{dup:78,"es5-ext/string/is-string":126,"es6-symbol":132}],132:[function(h,k,l){arguments[4][79][0].apply(l,arguments)},{"./is-implemented":133,"./polyfill":135,dup:79}],133:[function(h,k,l){arguments[4][80][0].apply(l,arguments)},{dup:80}],134:[function(h,k,l){arguments[4][81][0].apply(l,arguments)},{dup:81}],135:[function(h,k,l){arguments[4][82][0].apply(l,arguments)},{"./validate-symbol":136,d:96,dup:82}],136:[function(h,
k,l){arguments[4][83][0].apply(l,arguments)},{"./is-symbol":134,dup:83}],137:[function(h,k,l){arguments[4][84][0].apply(l,arguments)},{"./":130,d:96,dup:84,"es5-ext/object/set-prototype-of":118}],138:[function(h,k,l){arguments[4][85][0].apply(l,arguments)},{"./is-iterable":131,dup:85}],139:[function(h,k,l){arguments[4][79][0].apply(l,arguments)},{"./is-implemented":140,"./polyfill":141,dup:79}],140:[function(h,k,l){arguments[4][87][0].apply(l,arguments)},{dup:87}],141:[function(h,k,l){arguments[4][88][0].apply(l,
arguments)},{d:96,dup:88}],142:[function(h,k,l){arguments[4][89][0].apply(l,arguments)},{d:96,dup:89,"es5-ext/object/valid-callable":121}],143:[function(h,k,l){var b=h("es5-ext/array/#/clear"),g=h("es5-ext/array/#/e-index-of"),e=h("es5-ext/object/set-prototype-of"),f=h("es5-ext/object/valid-callable"),c=h("d"),d=h("event-emitter");l=h("es6-symbol");var a=h("es6-iterator/valid-iterable"),m=h("es6-iterator/for-of"),n=h("./lib/iterator");h=h("./is-native-implemented");var p=Function.prototype.call,y=
Object.defineProperty,A;k.exports=A=function(b){if(!(this instanceof A))return new A(b);if(void 0!==this.__setData__)throw new TypeError(this+" cannot be reinitialized");null!=b&&a(b);y(this,"__setData__",c("c",[]));b&&m(b,function(a){-1===g.call(this,a)&&this.push(a)},this.__setData__)};h&&(e&&e(A,Set),A.prototype=Object.create(Set.prototype,{constructor:c(A)}));d(Object.defineProperties(A.prototype,{add:c(function(a){if(this.has(a))return this;this.emit("_add",this.__setData__.push(a)-1,a);return this}),
clear:c(function(){this.__setData__.length&&(b.call(this.__setData__),this.emit("_clear"))}),delete:c(function(a){var b=g.call(this.__setData__,a);if(-1===b)return!1;this.__setData__.splice(b,1);this.emit("_delete",b,a);return!0}),entries:c(function(){return new n(this,"key+value")}),forEach:c(function(a,b){var c,d;f(a);c=this.values();for(d=c._next();void 0!==d;)d=c._resolve(d),p.call(a,b,d,d,this),d=c._next()}),has:c(function(a){return-1!==g.call(this.__setData__,a)}),keys:c(k=function(){return this.values()}),
size:c.gs(function(){return this.__setData__.length}),values:c(function(){return new n(this)}),toString:c(function(){return"[object Set]"})}));y(A.prototype,l.iterator,c(k));y(A.prototype,l.toStringTag,c("c","Set"))},{"./is-native-implemented":93,"./lib/iterator":94,d:96,"es5-ext/array/#/clear":97,"es5-ext/array/#/e-index-of":98,"es5-ext/object/set-prototype-of":118,"es5-ext/object/valid-callable":121,"es6-iterator/for-of":128,"es6-iterator/valid-iterable":138,"es6-symbol":139,"event-emitter":142}],
144:[function(h,k,l){(function(b){(function(b){if("function"===typeof bootstrap)bootstrap("promise",b);else if("object"===typeof l&&"object"===typeof k)k.exports=b();else if("function"===typeof define&&define.amd)define(b);else if("undefined"!==typeof ses)ses.ok()&&(ses.makeQ=b);else if("undefined"!==typeof self)self.Q=b();else throw Error("This environment was not anticipated by Q. Please file a bug.");})(function(){function g(a){return function(){return W.apply(a,arguments)}}function e(a,b){if(G&&
b.stack&&"object"===typeof a&&null!==a&&a.stack&&-1===a.stack.indexOf("From previous event:")){for(var c=[],d=b;d;d=d.source)d.stack&&c.unshift(d.stack);c.unshift(a.stack);for(var c=c.join("\nFrom previous event:\n").split("\n"),d=[],e=0;e<c.length;++e){var m=c[e],g;if(g=f(m)){var n=g[1];g=g[0]===U&&n>=O&&n<=X}else g=!1;g||(g=m,g=-1!==g.indexOf("(module.js:")||-1!==g.indexOf("(node.js:"));g||!m||d.push(m)}c=d.join("\n");a.stack=c}}function f(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b||
(b=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a)))return[b[1],Number(b[2])];if(a=/.*@(.+):(\d+)$/.exec(a))return[a[1],Number(a[2])]}function c(){if(G)try{throw Error();}catch(a){var b=a.stack.split("\n"),b=0<b[0].indexOf("@")?b[1]:b[2];if(b=f(b))return U=b[0],b[1]}}function d(a){return a instanceof p?a:w(a)?q(a):C(a)}function a(){function b(a){f=a;g.source=a;K(c,function(b,c){d.nextTick(function(){a.promiseDispatch.apply(a,c)})},void 0);e=c=void 0}var c=[],e=[],f,m=R(a.prototype),g=R(p.prototype);g.promiseDispatch=
function(a,b,m){var g=D(arguments);c?(c.push(g),"when"===b&&m[1]&&e.push(m[1])):d.nextTick(function(){f.promiseDispatch.apply(f,g)})};g.valueOf=function(){if(c)return g;var a=k(f);l(a)&&(f=a);return a};g.inspect=function(){return f?f.inspect():{state:"pending"}};if(d.longStackSupport&&G)try{throw Error();}catch(n){g.stack=n.stack.substring(n.stack.indexOf("\n")+1)}m.promise=g;m.resolve=function(a){f||b(d(a))};m.fulfill=function(a){f||b(C(a))};m.reject=function(a){f||b(u(a))};m.notify=function(a){f||
K(e,function(b,c){d.nextTick(function(){c(a)})},void 0)};return m}function m(b){if("function"!==typeof b)throw new TypeError("resolver must be a function.");var c=a();try{b(c.resolve,c.reject,c.notify)}catch(d){c.reject(d)}return c.promise}function n(a){return m(function(b,c){for(var e=0,f=a.length;e<f;e++)d(a[e]).then(b,c)})}function p(a,b,c){void 0===b&&(b=function(a){return u(Error("Promise does not support operation: "+a))});void 0===c&&(c=function(){return{state:"unknown"}});var d=R(p.prototype);
d.promiseDispatch=function(c,e,f){var m;try{m=a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(g){m=u(g)}c&&c(m)};if(d.inspect=c){var e=c();"rejected"===e.state&&(d.exception=e.reason);d.valueOf=function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value}}return d}function h(a,b,c,e){return d(a).then(b,c,e)}function k(a){if(l(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function l(a){return a instanceof p}function w(a){return a===Object(a)&&"function"===typeof a.then}
function r(){J.length=0;L.length=0;M||(M=!0)}function v(a,c){M&&("object"===typeof b&&"function"===typeof b.emit&&d.nextTick.runAfter(function(){-1!==P(L,a)&&(b.emit("unhandledRejection",c,a),S.push(a))}),L.push(a),c&&"undefined"!==typeof c.stack?J.push(c.stack):J.push("(no stack) "+c))}function t(a){if(M){var c=P(L,a);-1!==c&&("object"===typeof b&&"function"===typeof b.emit&&d.nextTick.runAfter(function(){var d=P(S,a);-1!==d&&(b.emit("rejectionHandled",J[c],a),S.splice(d,1))}),L.splice(c,1),J.splice(c,
1))}}function u(a){var b=p({when:function(b){b&&t(this);return b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});v(b,a);return b}function C(a){return p({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return Y(a)}},void 0,function(){return{state:"fulfilled",value:a}})}
function q(b){var c=a();d.nextTick(function(){try{b.then(c.resolve,c.reject,c.notify)}catch(a){c.reject(a)}});return c.promise}function E(a,b,c){return d(a).spread(b,c)}function F(a,b,c){return d(a).dispatch(b,c)}function B(b){return h(b,function(b){var c=0,d=a();K(b,function(a,e,f){var m;l(e)&&"fulfilled"===(m=e.inspect()).state?b[f]=m.value:(++c,h(e,function(a){b[f]=a;0===--c&&d.resolve(b)},d.reject,function(a){d.notify({index:f,value:a})}))},void 0);0===c&&d.resolve(b);return d.promise})}function x(a){if(0===
a.length)return d.resolve();var b=d.defer(),c=0;K(a,function(d,e,f){d=a[f];c++;h(d,function(a){b.resolve(a)},function(){c--;0===c&&b.reject(Error("Can't get fulfillment value from any promise, all promises were rejected."))},function(a){b.notify({index:f,value:a})})},void 0);return b.promise}function H(a){return h(a,function(a){a=Q(a,d);return h(B(Q(a,function(a){return h(a,V,V)})),function(){return a})})}var G=!1;try{throw Error();}catch(I){G=!!I.stack}var O=c(),U,V=function(){},N=function(){function a(){for(var b,
e;d.next;){d=d.next;b=d.task;d.task=void 0;if(e=d.domain)d.domain=void 0,e.enter();c(b,e)}for(;n.length;)b=n.pop(),c(b);f=!1}function c(b,d){try{b()}catch(e){if(g)throw d&&d.exit(),setTimeout(a,0),d&&d.enter(),e;setTimeout(function(){throw e;},0)}d&&d.exit()}var d={task:void 0,next:null},e=d,f=!1,m=void 0,g=!1,n=[];N=function(a){e=e.next={task:a,domain:g&&b.domain,next:null};f||(f=!0,m())};if("object"===typeof b&&"[object process]"===b.toString()&&b.nextTick)g=!0,m=function(){b.nextTick(a)};else if("function"===
typeof setImmediate)m="undefined"!==typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!==typeof MessageChannel){var p=new MessageChannel;p.port1.onmessage=function(){m=h;p.port1.onmessage=a;a()};var h=function(){p.port2.postMessage(0)},m=function(){setTimeout(a,0);h()}}else m=function(){setTimeout(a,0)};N.runAfter=function(a){n.push(a);f||(f=!0,m())};return N}(),W=Function.call,D=g(Array.prototype.slice),K=g(Array.prototype.reduce||function(a,b){var c=0,d=this.length;
if(1===arguments.length){do{if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError;}while(1)}for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),P=g(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),Q=g(Array.prototype.map||function(a,b){var c=this,d=[];K(c,function(e,f,m){d.push(a.call(b,f,m,c))},void 0);return d}),R=Object.create||function(a){function b(){}b.prototype=a;return new b},Z=g(Object.prototype.hasOwnProperty),Y=Object.keys||
function(a){var b=[],c;for(c in a)Z(a,c)&&b.push(c);return b},aa=g(Object.prototype.toString),T;T="undefined"!==typeof ReturnValue?ReturnValue:function(a){this.value=a};d.resolve=d;d.nextTick=N;d.longStackSupport=!1;"object"===typeof b&&b&&b.env&&b.env.Q_DEBUG&&(d.longStackSupport=!0);d.defer=a;a.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):2<arguments.length?a.resolve(D(arguments,1)):a.resolve(c)}};d.Promise=m;d.promise=m;m.race=n;m.all=B;m.reject=u;m.resolve=
d;d.passByCopy=function(a){return a};p.prototype.passByCopy=function(){return this};d.join=function(a,b){return d(a).join(b)};p.prototype.join=function(a){return d([this,a]).spread(function(a,b){if(a===b)return a;throw Error("Can't join: not the same: "+a+" "+b);})};d.race=n;p.prototype.race=function(){return this.then(d.race)};d.makePromise=p;p.prototype.toString=function(){return"[object Promise]"};p.prototype.then=function(b,c,f){function m(a){try{return"function"===typeof b?b(a):a}catch(c){return u(c)}}
function g(a){if("function"===typeof c){e(a,n);try{return c(a)}catch(b){return u(b)}}return u(a)}var n=this,p=a(),h=!1;d.nextTick(function(){n.promiseDispatch(function(a){h||(h=!0,p.resolve(m(a)))},"when",[function(a){h||(h=!0,p.resolve(g(a)))}])});n.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b="function"===typeof f?f(a):a}catch(e){if(c=!0,d.onerror)d.onerror(e);else throw e;}c||p.notify(b)}]);return p.promise};d.tap=function(a,b){return d(a).tap(b)};p.prototype.tap=function(a){a=
d(a);return this.then(function(b){return a.fcall(b).thenResolve(b)})};d.when=h;p.prototype.thenResolve=function(a){return this.then(function(){return a})};d.thenResolve=function(a,b){return d(a).thenResolve(b)};p.prototype.thenReject=function(a){return this.then(function(){throw a;})};d.thenReject=function(a,b){return d(a).thenReject(b)};d.nearer=k;d.isPromise=l;d.isPromiseAlike=w;d.isPending=function(a){return l(a)&&"pending"===a.inspect().state};p.prototype.isPending=function(){return"pending"===
this.inspect().state};d.isFulfilled=function(a){return!l(a)||"fulfilled"===a.inspect().state};p.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state};d.isRejected=function(a){return l(a)&&"rejected"===a.inspect().state};p.prototype.isRejected=function(){return"rejected"===this.inspect().state};var J=[],L=[],S=[],M=!0;d.resetUnhandledRejections=r;d.getUnhandledReasons=function(){return J.slice()};d.stopUnhandledRejectionTracking=function(){r();M=!1};r();d.reject=u;d.fulfill=C;
d.master=function(a){return p({isDef:function(){}},function(b,c){return F(a,b,c)},function(){return d(a).inspect()})};d.spread=E;p.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)};d.async=function(a){return function(){function b(a,m){var g;if("undefined"===typeof StopIteration){try{g=c[a](m)}catch(n){return u(n)}return g.done?d(g.value):h(g.value,e,f)}try{g=c[a](m)}catch(p){return"[object StopIteration]"===aa(p)||p instanceof T?d(p.value):u(p)}return h(g,
e,f)}var c=a.apply(this,arguments),e=b.bind(b,"next"),f=b.bind(b,"throw");return e()}};d.spawn=function(a){d.done(d.async(a)())};d["return"]=function(a){throw new T(a);};d.promised=function(a){return function(){return E([this,B(arguments)],function(b,c){return a.apply(b,c)})}};d.dispatch=F;p.prototype.dispatch=function(b,c){var e=this,f=a();d.nextTick(function(){e.promiseDispatch(f.resolve,b,c)});return f.promise};d.get=function(a,b){return d(a).dispatch("get",[b])};p.prototype.get=function(a){return this.dispatch("get",
[a])};d.set=function(a,b,c){return d(a).dispatch("set",[b,c])};p.prototype.set=function(a,b){return this.dispatch("set",[a,b])};d.del=d["delete"]=function(a,b){return d(a).dispatch("delete",[b])};p.prototype.del=p.prototype["delete"]=function(a){return this.dispatch("delete",[a])};d.mapply=d.post=function(a,b,c){return d(a).dispatch("post",[b,c])};p.prototype.mapply=p.prototype.post=function(a,b){return this.dispatch("post",[a,b])};d.send=d.mcall=d.invoke=function(a,b){return d(a).dispatch("post",
[b,D(arguments,2)])};p.prototype.send=p.prototype.mcall=p.prototype.invoke=function(a){return this.dispatch("post",[a,D(arguments,1)])};d.fapply=function(a,b){return d(a).dispatch("apply",[void 0,b])};p.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])};d["try"]=d.fcall=function(a){return d(a).dispatch("apply",[void 0,D(arguments,1)])};p.prototype.fcall=function(){return this.dispatch("apply",[void 0,D(arguments)])};d.fbind=function(a){var b=d(a),c=D(arguments,1);return function(){return b.dispatch("apply",
[this,c.concat(D(arguments))])}};p.prototype.fbind=function(){var a=this,b=D(arguments);return function(){return a.dispatch("apply",[this,b.concat(D(arguments))])}};d.keys=function(a){return d(a).dispatch("keys",[])};p.prototype.keys=function(){return this.dispatch("keys",[])};d.all=B;p.prototype.all=function(){return B(this)};d.any=x;p.prototype.any=function(){return x(this)};d.allResolved=function(a,b,c){return function(){"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(b+
" is deprecated, use "+c+" instead.",Error("").stack);return a.apply(a,arguments)}}(H,"allResolved","allSettled");p.prototype.allResolved=function(){return H(this)};d.allSettled=function(a){return d(a).allSettled()};p.prototype.allSettled=function(){return this.then(function(a){return B(Q(a,function(a){function b(){return a.inspect()}a=d(a);return a.then(b,b)}))})};d.fail=d["catch"]=function(a,b){return d(a).then(void 0,b)};p.prototype.fail=p.prototype["catch"]=function(a){return this.then(void 0,
a)};d.progress=function(a,b){return d(a).then(void 0,void 0,b)};p.prototype.progress=function(a){return this.then(void 0,void 0,a)};d.fin=d["finally"]=function(a,b){return d(a)["finally"](b)};p.prototype.fin=p.prototype["finally"]=function(a){a=d(a);return this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b;})})};d.done=function(a,b,c,e){return d(a).done(b,c,e)};p.prototype.done=function(a,c,f){var m=function(a){d.nextTick(function(){e(a,
g);if(d.onerror)d.onerror(a);else throw a;})},g=a||c||f?this.then(a,c,f):this;"object"===typeof b&&b&&b.domain&&(m=b.domain.bind(m));g.then(void 0,m)};d.timeout=function(a,b,c){return d(a).timeout(b,c)};p.prototype.timeout=function(b,c){var d=a(),e=setTimeout(function(){c&&"string"!==typeof c||(c=Error(c||"Timed out after "+b+" ms"),c.code="ETIMEDOUT");d.reject(c)},b);this.then(function(a){clearTimeout(e);d.resolve(a)},function(a){clearTimeout(e);d.reject(a)},d.notify);return d.promise};d.delay=function(a,
b){void 0===b&&(b=a,a=void 0);return d(a).delay(b)};p.prototype.delay=function(b){return this.then(function(c){var d=a();setTimeout(function(){d.resolve(c)},b);return d.promise})};d.nfapply=function(a,b){return d(a).nfapply(b)};p.prototype.nfapply=function(b){var c=a();b=D(b);b.push(c.makeNodeResolver());this.fapply(b).fail(c.reject);return c.promise};d.nfcall=function(a){var b=D(arguments,1);return d(a).nfapply(b)};p.prototype.nfcall=function(){var b=D(arguments),c=a();b.push(c.makeNodeResolver());
this.fapply(b).fail(c.reject);return c.promise};d.nfbind=d.denodeify=function(b){var c=D(arguments,1);return function(){var e=c.concat(D(arguments)),f=a();e.push(f.makeNodeResolver());d(b).fapply(e).fail(f.reject);return f.promise}};p.prototype.nfbind=p.prototype.denodeify=function(){var a=D(arguments);a.unshift(this);return d.denodeify.apply(void 0,a)};d.nbind=function(b,c){var e=D(arguments,2);return function(){var f=e.concat(D(arguments)),m=a();f.push(m.makeNodeResolver());d(function(){return b.apply(c,
arguments)}).fapply(f).fail(m.reject);return m.promise}};p.prototype.nbind=function(){var a=D(arguments,0);a.unshift(this);return d.nbind.apply(void 0,a)};d.nmapply=d.npost=function(a,b,c){return d(a).npost(b,c)};p.prototype.nmapply=p.prototype.npost=function(b,c){var d=D(c||[]),e=a();d.push(e.makeNodeResolver());this.dispatch("post",[b,d]).fail(e.reject);return e.promise};d.nsend=d.nmcall=d.ninvoke=function(b,c){var e=D(arguments,2),f=a();e.push(f.makeNodeResolver());d(b).dispatch("post",[c,e]).fail(f.reject);
return f.promise};p.prototype.nsend=p.prototype.nmcall=p.prototype.ninvoke=function(b){var c=D(arguments,1),d=a();c.push(d.makeNodeResolver());this.dispatch("post",[b,c]).fail(d.reject);return d.promise};d.nodeify=function(a,b){return d(a).nodeify(b)};p.prototype.nodeify=function(a){if(a)this.then(function(b){d.nextTick(function(){a(null,b)})},function(b){d.nextTick(function(){a(b)})});else return this};var X=c();return d})}).call(this,h("_process"))},{_process:33}],145:[function(h,k,l){k.exports=
{name:"sip.js",title:"SIP.js",description:"A simple, intuitive, and powerful JavaScript signaling library",version:"0.6.4",main:"src/SIP.js",homepage:"http://sipjs.com",author:{name:"Will Mitchell",email:"will@onsip.com"},contributors:[{url:"http://sipjs.com/authors/"}],repository:{type:"git",url:"https://github.com/onsip/SIP.js.git"},keywords:["sip","websocket","webrtc","library","javascript"],devDependencies:{grunt:"~0.4.0","grunt-cli":"~0.1.6","grunt-contrib-jasmine":"~0.6.0","grunt-contrib-jshint":">0.5.0",
"grunt-contrib-uglify":"~0.2.0","grunt-peg":"~1.3.1","grunt-trimtrailingspaces":"^0.4.0","node-minify":"~0.7.2",pegjs:"0.8.0","sdp-transform":"~0.4.0","grunt-contrib-copy":"^0.5.0",browserify:"^4.1.8","grunt-browserify":"^2.1.0"},engines:{node:">=0.8"},license:"MIT",scripts:{test:"grunt travis --verbose"},readme:'# SIP.js\n\n[![Build Status](https://travis-ci.org/onsip/SIP.js.png?branch=master)](https://travis-ci.org/onsip/SIP.js)\n\nA JavaScript SIP stack for WebRTC, instant messaging, and more!\n\n\n## Website and Documentation\n\n* [SIPjs.com](http://sipjs.com)\n* [Mailing List](https://groups.google.com/forum/#!forum/sip_js)\n* [Issue Tracking](https://github.com/onsip/sip.js/issues)\n\n\n## Download\n\n* [sipjs.com/download](http://sipjs.com/download/)\n* Bower: `bower install sip.js`\n* npm: `npm install sip.js`\n\n## Authors\n\n### Will Mitchell\n\n* Lead Developer\n* <will@onsip.com>\n* /wakamoleguy on [GitHub](http://github.com/wakamoleguy), [Twitter](http://twitter.com/wakamoleguy)\n\n### James Criscuolo\n\n* <james@onsip.com>\n\n### Eric Green\n\n* <eric.green@onsip.com>\n\n### Joseph Frazier\n\n* <joseph@onsip.com>\n\n### JsSIP Authors\n\nSIP.js contains substantial portions of the JsSIP software. JsSIP\'s authors at time of fork are listed below. For up to date information about JsSIP, please visit [jssip.net](http://jssip.net)\n\n* Jos\u00e9 Luis Mill\u00e1n\n* I\u00f1aki Baz Castillo\n* Sa\u00fal Ibarra Corretg\u00e9\n\n## License\n\nSIP.js is released under the [MIT license](http://sipjs.com/license).\n\nSIP.js contains substantial portions of the JsSIP software, under the following license:\n\n~~~\nCopyright (c) 2012-2013 Jos\u00e9 Luis Mill\u00e1n - Versatica <http://www.versatica.com>\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n"Software"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n~~~\n',
readmeFilename:"README.md",bugs:{url:"https://github.com/onsip/SIP.js/issues"},_id:"sip.js@0.6.4",dist:{shasum:"8be2ea1743a7c601db4e651088610ad852b236be"},_from:"sip.js@^0.6.4",_resolved:"https://registry.npmjs.org/sip.js/-/sip.js-0.6.4.tgz"}},{}],146:[function(h,k,l){k.exports=function(b){var g;g=function(e,f,c,d){var a=c;if(void 0===c)throw new TypeError("Not enough arguments");c=e.normalizeTarget(c);if(!c)throw new TypeError("Invalid target: "+a);this.ua=e;this.logger=e.getLogger("sip.clientcontext");
this.method=f;e=d&&d.params;f=(d&&d.extraHeaders||[]).slice();d&&d.body&&(this.body=d.body);d&&d.contentType&&(this.contentType=d.contentType,f.push("Content-Type: "+this.contentType));this.request=new b.OutgoingRequest(this.method,c,this.ua,e,f);this.localIdentity=this.request.from;this.remoteIdentity=this.request.to;this.body&&(this.request.body=this.body);this.data={};this.initEvents(["progress","accepted","rejected","failed","cancel"])};g.prototype=new b.EventEmitter;g.prototype.send=function(){(new b.RequestSender(this,
this.ua)).send();return this};g.prototype.cancel=function(e){e=e||{};var f=e.status_code;e=e.reason_phrase;var c;if(f&&200>f||699<f)throw new TypeError("Invalid status_code: "+f);f&&(e=e||b.C.REASON_PHRASE[f]||"",c="SIP ;cause="+f+' ;text="'+e+'"');this.request.cancel(c);this.emit("cancel")};g.prototype.receiveResponse=function(e){var f=b.C.REASON_PHRASE[e.status_code]||"";switch(!0){case /^1[0-9]{2}$/.test(e.status_code):this.emit("progress",e,f);break;case /^2[0-9]{2}$/.test(e.status_code):this.ua.applicants[this]&&
delete this.ua.applicants[this];this.emit("accepted",e,f);break;default:this.ua.applicants[this]&&delete this.ua.applicants[this],this.emit("rejected",e,f),this.emit("failed",e,f)}};g.prototype.onRequestTimeout=function(){this.emit("failed",null,b.C.causes.REQUEST_TIMEOUT)};g.prototype.onTransportError=function(){this.emit("failed",null,b.C.causes.CONNECTION_ERROR)};b.ClientContext=g}},{}],147:[function(h,k,l){k.exports=function(b,g){return{USER_AGENT:b+"/"+g,SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",
REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",AUTHENTICATION_ERROR:"Authentication Error",DIALOG_ERROR:"Dialog Error",WEBRTC_NOT_SUPPORTED:"WebRTC Not Supported",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",
NO_PRACK:"No PRACK",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},supported:{UNSUPPORTED:"none",SUPPORTED:"supported",REQUIRED:"required"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",
MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",REFER:"REFER",PRACK:"PRACK",REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",
404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",
436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",
500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"}}}},{}],148:[function(h,k,l){k.exports=function(b){var g;g=function(b,f,c){this.dialog=b;this.applicant=f;this.request=c;this.reattempt=!1;this.reattemptTimer=null};g.prototype={send:function(){var e=this,f=new b.RequestSender(this,
this.dialog.owner.ua);f.send();this.request.method===b.C.INVITE&&f.clientTransaction.state!==b.Transactions.C.STATUS_TERMINATED&&(this.dialog.uac_pending_reply=!0,f.clientTransaction.on("stateChanged",function d(){if(this.state===b.Transactions.C.STATUS_ACCEPTED||this.state===b.Transactions.C.STATUS_COMPLETED||this.state===b.Transactions.C.STATUS_TERMINATED)if(this.off("stateChanged",d),e.dialog.uac_pending_reply=!1,!1===e.dialog.uas_pending_reply)e.dialog.owner.onReadyToReinvite()}))},onRequestTimeout:function(){this.applicant.onRequestTimeout()},
onTransportError:function(){this.applicant.onTransportError()},receiveResponse:function(e){var f=this;if(408===e.status_code||481===e.status_code)this.applicant.onDialogError(e);else e.method===b.C.INVITE&&491===e.status_code?this.reattempt?this.applicant.receiveResponse(e):(this.request.cseq.value=this.dialog.local_seqnum+=1,this.reattemptTimer=b.Timers.setTimeout(function(){f.applicant.owner.status!==b.Session.C.STATUS_TERMINATED&&(f.reattempt=!0,f.request_sender.send())},this.getReattemptTimeout())):
this.applicant.receiveResponse(e)}};return g}},{}],149:[function(h,k,l){k.exports=function(b,g){var e,f={STATUS_EARLY:1,STATUS_CONFIRMED:2};e=function(c,d,a,e){var g;this.uas_pending_reply=this.uac_pending_reply=!1;if(!d.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};e=d instanceof b.IncomingResponse?200>d.status_code?f.STATUS_EARLY:f.STATUS_CONFIRMED:e||f.STATUS_CONFIRMED;g=d.parseHeader("contact");"UAS"===a?(this.id={call_id:d.call_id,local_tag:d.to_tag,
remote_tag:d.from_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this.state=e,this.remote_seqnum=d.cseq,this.local_uri=d.parseHeader("to").uri,this.remote_uri=d.parseHeader("from").uri,this.remote_target=g.uri,this.route_set=d.getHeaders("record-route"),this.local_seqnum=this.invite_seqnum=d.cseq):"UAC"===a&&(this.id={call_id:d.call_id,local_tag:d.from_tag,remote_tag:d.to_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this.state=e,this.local_seqnum=
this.invite_seqnum=d.cseq,this.local_uri=d.parseHeader("from").uri,this.pracked=[],this.remote_uri=d.parseHeader("to").uri,this.remote_target=g.uri,this.route_set=d.getHeaders("record-route").reverse(),this.state!==f.STATUS_EARLY||c.hasOffer||(this.mediaHandler=c.mediaHandlerFactory(c)));this.logger=c.ua.getLogger("sip.dialog",this.id.toString());this.owner=c;c.ua.dialogs[this.id.toString()]=this;this.logger.log("new "+a+" dialog created with status "+(this.state===f.STATUS_EARLY?"EARLY":"CONFIRMED"))};
e.prototype={update:function(b,d){this.state=f.STATUS_CONFIRMED;this.logger.log("dialog "+this.id.toString()+"  changed to CONFIRMED state");"UAC"===d&&(this.route_set=b.getHeaders("record-route").reverse())},terminate:function(){this.logger.log("dialog "+this.id.toString()+" deleted");this.mediaHandler&&this.state!==f.STATUS_CONFIRMED&&this.mediaHandler.peerConnection.close();delete this.owner.ua.dialogs[this.id.toString()]},createRequest:function(c,d,a){var e;d=(d||[]).slice();this.local_seqnum||
(this.local_seqnum=Math.floor(1E4*Math.random()));e=c===b.C.CANCEL||c===b.C.ACK?this.invite_seqnum:this.local_seqnum+=1;c=new b.OutgoingRequest(c,this.remote_target,this.owner.ua,{cseq:e,call_id:this.id.call_id,from_uri:this.local_uri,from_tag:this.id.local_tag,to_uri:this.remote_uri,to_tag:this.id.remote_tag,route_set:this.route_set},d,a);c.dialog=this;return c},checkInDialogRequest:function(c){var d=this;if(this.remote_seqnum){if(c.cseq<this.remote_seqnum)return c.method!==b.C.ACK&&c.reply(500),
c.cseq===this.invite_seqnum?!0:!1;c.cseq>this.remote_seqnum&&(this.remote_seqnum=c.cseq)}else this.remote_seqnum=c.cseq;switch(c.method){case b.C.INVITE:if(!0===this.uac_pending_reply)c.reply(491);else{if(!0===this.uas_pending_reply){var a=(10*Math.random()|0)+1;c.reply(500,null,["Retry-After:"+a]);return!1}this.uas_pending_reply=!0;c.server_transaction.on("stateChanged",function n(){if(this.state===b.Transactions.C.STATUS_ACCEPTED||this.state===b.Transactions.C.STATUS_COMPLETED||this.state===b.Transactions.C.STATUS_TERMINATED)if(this.off("stateChanged",
n),d.uas_pending_reply=!1,!1===d.uac_pending_reply)d.owner.onReadyToReinvite()})}if(c.hasHeader("contact"))c.server_transaction.on("stateChanged",function(){this.state===b.Transactions.C.STATUS_ACCEPTED&&(d.remote_target=c.parseHeader("contact").uri)});break;case b.C.NOTIFY:if(c.hasHeader("contact"))c.server_transaction.on("stateChanged",function(){this.state===b.Transactions.C.STATUS_COMPLETED&&(d.remote_target=c.parseHeader("contact").uri)})}return!0},sendRequest:function(b,d,a){a=a||{};var e=(a.extraHeaders||
[]).slice();d=this.createRequest(d,e,a.body||null);(new g(this,b,d)).send();return d},receiveRequest:function(b){this.checkInDialogRequest(b)&&this.owner.receiveRequest(b)}};e.C=f;b.Dialog=e}},{}],150:[function(h,k,l){k.exports=function(b){var g;g=function(b){this.logger=b.getLogger("sipjs.digestauthentication");this.username=b.configuration.authorizationUser;this.password=b.configuration.password;this.cnonce=null;this.nc=0;this.ncHex="00000000";this.response=null};g.prototype.authenticate=function(e,
f){this.algorithm=f.algorithm;this.realm=f.realm;this.nonce=f.nonce;this.opaque=f.opaque;this.stale=f.stale;if(this.algorithm){if("MD5"!==this.algorithm)return this.logger.warn('challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this.algorithm="MD5";if(!this.realm)return this.logger.warn("challenge without Digest realm, authentication aborted"),!1;if(!this.nonce)return this.logger.warn("challenge without Digest nonce, authentication aborted"),!1;if(f.qop)if(-1<
f.qop.indexOf("auth"))this.qop="auth";else if(-1<f.qop.indexOf("auth-int"))this.qop="auth-int";else return this.logger.warn('challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;else this.qop=null;this.method=e.method;this.uri=e.ruri;this.cnonce=b.createRandomToken(12);this.nc+=1;this.updateNcHex();4294967296===this.nc&&(this.nc=1,this.ncHex="00000001");this.calculateResponse();return!0};g.prototype.calculateResponse=function(){var e,f;e=b.calculateMD5(this.username+
":"+this.realm+":"+this.password);"auth"===this.qop?(f=b.calculateMD5(this.method+":"+this.uri),this.response=b.calculateMD5(e+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+f)):"auth-int"===this.qop?(f=b.calculateMD5(this.method+":"+this.uri+":"+b.calculateMD5(this.body?this.body:"")),this.response=b.calculateMD5(e+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+f)):null===this.qop&&(f=b.calculateMD5(this.method+":"+this.uri),this.response=b.calculateMD5(e+":"+this.nonce+":"+f))};
g.prototype.toString=function(){var b=[];if(!this.response)throw Error("response field does not exist, cannot generate Authorization header");b.push("algorithm="+this.algorithm);b.push('username="'+this.username+'"');b.push('realm="'+this.realm+'"');b.push('nonce="'+this.nonce+'"');b.push('uri="'+this.uri+'"');b.push('response="'+this.response+'"');this.opaque&&b.push('opaque="'+this.opaque+'"');this.qop&&(b.push("qop="+this.qop),b.push('cnonce="'+this.cnonce+'"'),b.push("nc="+this.ncHex));return"Digest "+
b.join(", ")};g.prototype.updateNcHex=function(){var b=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-b.length)+b};return g}},{}],151:[function(h,k,l){k.exports=function(b){var g,e=(new b.LoggerFactory).getLogger("sip.eventemitter"),f={MAX_LISTENERS:10};g=function(){};g.prototype={initEvents:function(b){this.events={};return this.initMoreEvents(b)},initMoreEvents:function(b){var d;this.logger||(this.logger=e);this.maxListeners=f.MAX_LISTENERS;for(d=0;d<b.length;d++)this.events[b[d]]?
this.logger.log("skipping event "+b[d]+" - Event exists"):(this.logger.log("adding event "+b[d]),this.events[b[d]]=[]);return this},checkEvent:function(b){return!(!this.events||!this.events[b])},checkListener:function(b){return this.checkEvent(b)&&0<this.events[b].length},on:function(b,d,a){if(void 0===d)return this;if("function"!==typeof d)return this.logger.error("listener must be a function"),this;if(!this.checkEvent(b))throw this.logger.error("unable to add a listener to a nonexistent event "+
b),new TypeError("Invalid or uninitialized event: "+b);d={listener:d};a&&(d.bindTarget=a);if(this.events[b].length>=this.maxListeners)return this.logger.warn("max listeners exceeded for event "+b),this;this.events[b].push(d);this.logger.log("new listener added to event "+b);return this},once:function(b,d,a){function e(){d.apply(this,arguments);f.off(b,e,a)}var f=this;return this.on(b,e,a)},off:function(b,d,a){var e,f=0;if(d&&"function"!==typeof d)return this.logger.error("listener must be a function"),
this;if(!b){for(f in this.events)this.events[f]=[];return this}if(!this.checkEvent(b))throw this.logger.error("unable to remove a listener from a nonexistent event "+b),new TypeError("Invalid or uninitialized event: "+b);b=this.events[b];for(e=b.length;f<e;)!b[f]||d&&b[f].listener!==d||a&&b[f].bindTarget!==a?f++:b.splice(f,1);return this},setMaxListeners:function(b){if("number"!==typeof b||0>b)return this.logger.error("listeners must be a positive number"),this;this.maxListeners=b;return this},emit:function(b){if(!this.checkEvent(b))throw this.logger.error("unable to emit a nonexistent event "+
b),new TypeError("Invalid or uninitialized event: "+b);this.logger.log("emitting event "+b);var d=Array.prototype.slice.call(arguments,1);this.events[b].slice().forEach(function(a){try{a.listener.apply(a.bindTarget||this,d)}catch(b){this.logger.error(b.stack)}},this);return this}};g.C=f;b.EventEmitter=g;b.Event=function(b,d,a){this.type=b;this.sender=d;this.data=a}}},{}],152:[function(h,k,l){k.exports={ConfigurationError:function(){var b=function(b,e){this.code=1;this.name="CONFIGURATION_ERROR";this.parameter=
b;this.message=(this.value=e)?"Invalid value "+JSON.stringify(this.value)+' for parameter "'+this.parameter+'"':"Missing parameter: "+this.parameter};b.prototype=Error();return b}(),InvalidStateError:function(){var b=function(b){this.code=2;this.name="INVALID_STATE_ERROR";this.status=b;this.message="Invalid status: "+b};b.prototype=Error();return b}(),NotSupportedError:function(){var b=function(b){this.code=3;this.name="NOT_SUPPORTED_ERROR";this.message=b};b.prototype=Error();return b}(),NotReadyError:function(){var b=
function(b){this.code=4;this.name="NOT_READY_ERROR";this.message=b};b.prototype=Error();return b}()}},{}],153:[function(h,k,l){k.exports=function(b){function g(b,c,d,a,e,g){this.message=b;this.expected=c;this.found=d;this.offset=a;this.line=e;this.column=g;this.name="SyntaxError"}function e(e){function c(){return e.substring(v,r)}function d(a){r<t||(r>t&&(t=r,u=[]),u.push(a))}function a(a){var b=Array(a.length),c;for(c=0;c<a.length;c++)b[c]=a.charCodeAt(c)-32;return b}function m(a){function b(a){return"[object Array]"===
Object.prototype.toString.apply(a)?[]:a}a=w[a];for(var c=0,g=[],n=a.length,h=[],k=[],q,y;;){for(;c<n;)switch(a[c]){case 0:k.push(b(l[a[c+1]]));c+=2;break;case 1:k.push(r);c++;break;case 2:k.pop();c++;break;case 3:r=k.pop();c++;break;case 4:k.length-=a[c+1];c+=2;break;case 5:k.splice(-2,1);c++;break;case 6:k[k.length-2].push(k.pop());c++;break;case 7:k.push(k.splice(k.length-a[c+1],a[c+1]));c+=2;break;case 8:k.pop();k.push(e.substring(k[k.length-1],r));c++;break;case 9:h.push(n);g.push(c+3+a[c+1]+
a[c+2]);k[k.length-1]?(n=c+3+a[c+1],c+=3):(n=c+3+a[c+1]+a[c+2],c+=3+a[c+1]);break;case 10:h.push(n);g.push(c+3+a[c+1]+a[c+2]);k[k.length-1]===p?(n=c+3+a[c+1],c+=3):(n=c+3+a[c+1]+a[c+2],c+=3+a[c+1]);break;case 11:h.push(n);g.push(c+3+a[c+1]+a[c+2]);k[k.length-1]!==p?(n=c+3+a[c+1],c+=3):(n=c+3+a[c+1]+a[c+2],c+=3+a[c+1]);break;case 12:k[k.length-1]!==p?(h.push(n),g.push(c),n=c+2+a[c+1],c+=2):c+=2+a[c+1];break;case 13:h.push(n);g.push(c+3+a[c+1]+a[c+2]);e.length>r?(n=c+3+a[c+1],c+=3):(n=c+3+a[c+1]+a[c+
2],c+=3+a[c+1]);break;case 14:h.push(n);g.push(c+4+a[c+2]+a[c+3]);e.substr(r,l[a[c+1]].length)===l[a[c+1]]?(n=c+4+a[c+2],c+=4):(n=c+4+a[c+2]+a[c+3],c+=4+a[c+2]);break;case 15:h.push(n);g.push(c+4+a[c+2]+a[c+3]);e.substr(r,l[a[c+1]].length).toLowerCase()===l[a[c+1]]?(n=c+4+a[c+2],c+=4):(n=c+4+a[c+2]+a[c+3],c+=4+a[c+2]);break;case 16:h.push(n);g.push(c+4+a[c+2]+a[c+3]);l[a[c+1]].test(e.charAt(r))?(n=c+4+a[c+2],c+=4):(n=c+4+a[c+2]+a[c+3],c+=4+a[c+2]);break;case 17:k.push(e.substr(r,a[c+1]));r+=a[c+1];
c+=2;break;case 18:k.push(l[a[c+1]]);r+=l[a[c+1]].length;c+=2;break;case 19:k.push(p);0===C&&d(l[a[c+1]]);c+=2;break;case 20:v=k[k.length-1-a[c+1]];c+=2;break;case 21:v=r;c++;break;case 22:q=a.slice(c+4,c+4+a[c+3]);for(y=0;y<a[c+3];y++)q[y]=k[k.length-1-q[y]];k.splice(k.length-a[c+2],a[c+2],l[a[c+1]].apply(null,q));c+=4+a[c+3];break;case 23:k.push(m(a[c+1]));c+=2;break;case 24:C++;c++;break;case 25:C--;c++;break;default:throw Error("Invalid opcode: "+a[c]+".");}if(0<h.length)n=h.pop(),c=g.pop();else break}return k[0]}
var g=1<arguments.length?arguments[1]:{},p={},h={Contact:118,Name_Addr_Header:155,Record_Route:175,Request_Response:81,SIP_URI:45,Subscription_State:182,Via:190,absoluteURI:84,Call_ID:117,Content_Disposition:129,Content_Length:134,Content_Type:135,CSeq:145,displayName:121,Event:148,From:150,host:52,Max_Forwards:153,Proxy_Authenticate:156,quoted_string:40,Refer_To:177,stun_URI:209,To:188,turn_URI:216,uuid:219,WWW_Authenticate:205,challenge:157},k=118,l=["\r\n",{type:"literal",value:"\r\n",description:'"\\r\\n"'},
/^[0-9]/,{type:"class",value:"[0-9]",description:"[0-9]"},/^[a-zA-Z]/,{type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},/^[0-9a-fA-F]/,{type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},/^[\0-\xFF]/,{type:"class",value:"[\\0-\\xFF]",description:"[\\0-\\xFF]"},/^["]/,{type:"class",value:'["]',description:'["]'}," ",{type:"literal",value:" ",description:'" "'},"\t",{type:"literal",value:"\t",description:'"\\t"'},/^[a-zA-Z0-9]/,{type:"class",value:"[a-zA-Z0-9]",description:"[a-zA-Z0-9]"},
";",{type:"literal",value:";",description:'";"'},"/",{type:"literal",value:"/",description:'"/"'},"?",{type:"literal",value:"?",description:'"?"'},":",{type:"literal",value:":",description:'":"'},"@",{type:"literal",value:"@",description:'"@"'},"&",{type:"literal",value:"&",description:'"&"'},"=",{type:"literal",value:"=",description:'"="'},"+",{type:"literal",value:"+",description:'"+"'},"$",{type:"literal",value:"$",description:'"$"'},",",{type:"literal",value:",",description:'","'},"-",{type:"literal",
value:"-",description:'"-"'},"_",{type:"literal",value:"_",description:'"_"'},".",{type:"literal",value:".",description:'"."'},"!",{type:"literal",value:"!",description:'"!"'},"~",{type:"literal",value:"~",description:'"~"'},"*",{type:"literal",value:"*",description:'"*"'},"'",{type:"literal",value:"'",description:'"\'"'},"(",{type:"literal",value:"(",description:'"("'},")",{type:"literal",value:")",description:'")"'},p,"%",{type:"literal",value:"%",description:'"%"'},function(a){return a.join("")},
null,[],function(){return" "},function(){return":"},function(){return c()},/^[!-~]/,{type:"class",value:"[!-~]",description:"[!-~]"},/^[\x80-\uFFFF]/,{type:"class",value:"[\\x80-\\uFFFF]",description:"[\\x80-\\uFFFF]"},/^[\x80-\xBF]/,{type:"class",value:"[\\x80-\\xBF]",description:"[\\x80-\\xBF]"},/^[a-f]/,{type:"class",value:"[a-f]",description:"[a-f]"},"`",{type:"literal",value:"`",description:'"`"'},function(){return c()},"<",{type:"literal",value:"<",description:'"<"'},">",{type:"literal",value:">",
description:'">"'},"\\",{type:"literal",value:"\\",description:'"\\\\"'},"[",{type:"literal",value:"[",description:'"["'},"]",{type:"literal",value:"]",description:'"]"'},"{",{type:"literal",value:"{",description:'"{"'},"}",{type:"literal",value:"}",description:'"}"'},function(){return"*"},function(){return"/"},function(){return"="},function(){return"("},function(){return")"},function(){return">"},function(){return"<"},function(){return","},function(){return";"},function(){return":"},function(){return'"'},
/^[!-']/,{type:"class",value:"[!-']",description:"[!-']"},/^[*-[]/,{type:"class",value:"[*-[]",description:"[*-[]"},/^[\]-~]/,{type:"class",value:"[\\]-~]",description:"[\\]-~]"},function(a){return a},/^[#-[]/,{type:"class",value:"[#-[]",description:"[#-[]"},/^[\0-\t]/,{type:"class",value:"[\\0-\\t]",description:"[\\0-\\t]"},/^[\x0B-\f]/,{type:"class",value:"[\\x0B-\\f]",description:"[\\x0B-\\f]"},/^[\x0E-\u007f]/,{type:"class",value:"[\\x0E-\u007f]",description:"[\\x0E-\u007f]"},function(){q.uri=
new b.URI(q.scheme,q.user,q.host,q.port);delete q.scheme;delete q.user;delete q.host;delete q.host_type;delete q.port},function(){q.uri=new b.URI(q.scheme,q.user,q.host,q.port,q.uri_params,q.uri_headers);delete q.scheme;delete q.user;delete q.host;delete q.host_type;delete q.port;delete q.uri_params;"SIP_URI"===g.startRule&&(q=q.uri)},"sips",{type:"literal",value:"sips",description:'"sips"'},"sip",{type:"literal",value:"sip",description:'"sip"'},function(a){q.scheme=a.toLowerCase()},function(){q.user=
decodeURIComponent(c().slice(0,-1))},function(){q.password=c()},function(){q.host=c();return q.host},function(){q.host_type="domain";return c()},/^[a-zA-Z0-9_\-]/,{type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},/^[a-zA-Z0-9\-]/,{type:"class",value:"[a-zA-Z0-9\\-]",description:"[a-zA-Z0-9\\-]"},function(){q.host_type="IPv6";return c()},"::",{type:"literal",value:"::",description:'"::"'},function(){q.host_type="IPv6";return c()},function(){q.host_type="IPv4";return c()},"25",{type:"literal",
value:"25",description:'"25"'},/^[0-5]/,{type:"class",value:"[0-5]",description:"[0-5]"},"2",{type:"literal",value:"2",description:'"2"'},/^[0-4]/,{type:"class",value:"[0-4]",description:"[0-4]"},"1",{type:"literal",value:"1",description:'"1"'},/^[1-9]/,{type:"class",value:"[1-9]",description:"[1-9]"},function(a){a=parseInt(a.join(""));return q.port=a},"transport=",{type:"literal",value:"transport=",description:'"transport="'},"udp",{type:"literal",value:"udp",description:'"udp"'},"tcp",{type:"literal",
value:"tcp",description:'"tcp"'},"sctp",{type:"literal",value:"sctp",description:'"sctp"'},"tls",{type:"literal",value:"tls",description:'"tls"'},function(a){q.uri_params||(q.uri_params={});q.uri_params.transport=a.toLowerCase()},"user=",{type:"literal",value:"user=",description:'"user="'},"phone",{type:"literal",value:"phone",description:'"phone"'},"ip",{type:"literal",value:"ip",description:'"ip"'},function(a){q.uri_params||(q.uri_params={});q.uri_params.user=a.toLowerCase()},"method=",{type:"literal",
value:"method=",description:'"method="'},function(a){q.uri_params||(q.uri_params={});q.uri_params.method=a},"ttl=",{type:"literal",value:"ttl=",description:'"ttl="'},function(a){q.params||(q.params={});q.params.ttl=a},"maddr=",{type:"literal",value:"maddr=",description:'"maddr="'},function(a){q.uri_params||(q.uri_params={});q.uri_params.maddr=a},"lr",{type:"literal",value:"lr",description:'"lr"'},function(){q.uri_params||(q.uri_params={});q.uri_params.lr=void 0},function(a,b){q.uri_params||(q.uri_params=
{});b=null===b?void 0:b[1];q.uri_params[a.toLowerCase()]=b&&b.toLowerCase()},function(a){return a.join("")},function(a){return a.join("")},function(a,b){a=a.join("").toLowerCase();b=b.join("");q.uri_headers||(q.uri_headers={});q.uri_headers[a]?q.uri_headers[a].push(b):q.uri_headers[a]=[b]},function(){"Refer_To"===g.startRule&&(q.uri=new b.URI(q.scheme,q.user,q.host,q.port,q.uri_params,q.uri_headers),delete q.scheme,delete q.user,delete q.host,delete q.host_type,delete q.port,delete q.uri_params)},
"//",{type:"literal",value:"//",description:'"//"'},function(){q.scheme=c()},{type:"literal",value:"SIP",description:'"SIP"'},function(){q.sip_version=c()},"INVITE",{type:"literal",value:"INVITE",description:'"INVITE"'},"ACK",{type:"literal",value:"ACK",description:'"ACK"'},"VXACH",{type:"literal",value:"VXACH",description:'"VXACH"'},"OPTIONS",{type:"literal",value:"OPTIONS",description:'"OPTIONS"'},"BYE",{type:"literal",value:"BYE",description:'"BYE"'},"CANCEL",{type:"literal",value:"CANCEL",description:'"CANCEL"'},
"REGISTER",{type:"literal",value:"REGISTER",description:'"REGISTER"'},"SUBSCRIBE",{type:"literal",value:"SUBSCRIBE",description:'"SUBSCRIBE"'},"NOTIFY",{type:"literal",value:"NOTIFY",description:'"NOTIFY"'},"REFER",{type:"literal",value:"REFER",description:'"REFER"'},function(){q.method=c();return q.method},function(a){q.status_code=parseInt(a.join(""))},function(){q.reason_phrase=c()},function(){q=c()},function(){var a,b;b=q.multi_header.length;for(a=0;a<b;a++)if(null===q.multi_header[a].parsed){q=
null;break}q=null!==q?q.multi_header:-1},function(){var a;q.multi_header||(q.multi_header=[]);try{a=new b.NameAddrHeader(q.uri,q.displayName,q.params),delete q.uri,delete q.displayName,delete q.params}catch(c){a=null}q.multi_header.push({position:r,offset:v,parsed:a})},function(a){a=c().trim();'"'===a[0]&&(a=a.substring(1,a.length-1));q.displayName=a},"q",{type:"literal",value:"q",description:'"q"'},function(a){q.params||(q.params={});q.params.q=a},"expires",{type:"literal",value:"expires",description:'"expires"'},
function(a){q.params||(q.params={});q.params.expires=a},function(a){return parseInt(a.join(""))},"0",{type:"literal",value:"0",description:'"0"'},function(){return parseFloat(c())},function(a,b){q.params||(q.params={});b=null===b?void 0:b[1];q.params[a.toLowerCase()]=b},"render",{type:"literal",value:"render",description:'"render"'},"session",{type:"literal",value:"session",description:'"session"'},"icon",{type:"literal",value:"icon",description:'"icon"'},"alert",{type:"literal",value:"alert",description:'"alert"'},
function(){"Content_Disposition"===g.startRule&&(q.type=c().toLowerCase())},"handling",{type:"literal",value:"handling",description:'"handling"'},"optional",{type:"literal",value:"optional",description:'"optional"'},"required",{type:"literal",value:"required",description:'"required"'},function(a){q=parseInt(a.join(""))},function(){q=c()},"text",{type:"literal",value:"text",description:'"text"'},"image",{type:"literal",value:"image",description:'"image"'},"audio",{type:"literal",value:"audio",description:'"audio"'},
"video",{type:"literal",value:"video",description:'"video"'},"application",{type:"literal",value:"application",description:'"application"'},"message",{type:"literal",value:"message",description:'"message"'},"multipart",{type:"literal",value:"multipart",description:'"multipart"'},"x-",{type:"literal",value:"x-",description:'"x-"'},function(a){q.value=parseInt(a.join(""))},function(a){q=a},function(a){q.event=a.toLowerCase()},function(){var a=q.tag;q=new b.NameAddrHeader(q.uri,q.displayName,q.params);
a&&q.setParam("tag",a)},"tag",{type:"literal",value:"tag",description:'"tag"'},function(a){q.tag=a},function(a){q=parseInt(a.join(""))},function(a){q=a},function(){q=new b.NameAddrHeader(q.uri,q.displayName,q.params)},"digest",{type:"literal",value:"Digest",description:'"Digest"'},"realm",{type:"literal",value:"realm",description:'"realm"'},function(a){q.realm=a},"domain",{type:"literal",value:"domain",description:'"domain"'},"nonce",{type:"literal",value:"nonce",description:'"nonce"'},function(a){q.nonce=
a},"opaque",{type:"literal",value:"opaque",description:'"opaque"'},function(a){q.opaque=a},"stale",{type:"literal",value:"stale",description:'"stale"'},"true",{type:"literal",value:"true",description:'"true"'},function(){q.stale=!0},"false",{type:"literal",value:"false",description:'"false"'},function(){q.stale=!1},"algorithm",{type:"literal",value:"algorithm",description:'"algorithm"'},"md5",{type:"literal",value:"MD5",description:'"MD5"'},"md5-sess",{type:"literal",value:"MD5-sess",description:'"MD5-sess"'},
function(a){q.algorithm=a.toUpperCase()},"qop",{type:"literal",value:"qop",description:'"qop"'},"auth-int",{type:"literal",value:"auth-int",description:'"auth-int"'},"auth",{type:"literal",value:"auth",description:'"auth"'},function(a){q.qop||(q.qop=[]);q.qop.push(a.toLowerCase())},function(a){q.value=parseInt(a.join(""))},function(){var a,b;b=q.multi_header.length;for(a=0;a<b;a++)if(null===q.multi_header[a].parsed){q=null;break}q=null!==q?q.multi_header:-1},function(){var a;q.multi_header||(q.multi_header=
[]);try{a=new b.NameAddrHeader(q.uri,q.displayName,q.params),delete q.uri,delete q.displayName,delete q.params}catch(c){a=null}q.multi_header.push({position:r,offset:v,parsed:a})},function(){q=new b.NameAddrHeader(q.uri,q.displayName,q.params)},function(a){q.value=parseInt(a.join(""))},"active",{type:"literal",value:"active",description:'"active"'},"pending",{type:"literal",value:"pending",description:'"pending"'},"terminated",{type:"literal",value:"terminated",description:'"terminated"'},function(){q.state=
c()},"reason",{type:"literal",value:"reason",description:'"reason"'},function(a){"undefined"!==typeof a&&(q.reason=a)},function(a){"undefined"!==typeof a&&(q.expires=a)},"retry_after",{type:"literal",value:"retry_after",description:'"retry_after"'},function(a){"undefined"!==typeof a&&(q.retry_after=a)},"deactivated",{type:"literal",value:"deactivated",description:'"deactivated"'},"probation",{type:"literal",value:"probation",description:'"probation"'},"rejected",{type:"literal",value:"rejected",description:'"rejected"'},
"timeout",{type:"literal",value:"timeout",description:'"timeout"'},"giveup",{type:"literal",value:"giveup",description:'"giveup"'},"noresource",{type:"literal",value:"noresource",description:'"noresource"'},"invariant",{type:"literal",value:"invariant",description:'"invariant"'},function(){var a=q.tag;q=new b.NameAddrHeader(q.uri,q.displayName,q.params);a&&q.setParam("tag",a)},"ttl",{type:"literal",value:"ttl",description:'"ttl"'},function(a){q.ttl=a},"maddr",{type:"literal",value:"maddr",description:'"maddr"'},
function(a){q.maddr=a},"received",{type:"literal",value:"received",description:'"received"'},function(a){q.received=a},"branch",{type:"literal",value:"branch",description:'"branch"'},function(a){q.branch=a},"rport",{type:"literal",value:"rport",description:'"rport"'},function(){"undefined"!==typeof response_port&&(q.rport=response_port.join(""))},function(a){q.protocol=a},{type:"literal",value:"UDP",description:'"UDP"'},{type:"literal",value:"TCP",description:'"TCP"'},{type:"literal",value:"TLS",
description:'"TLS"'},{type:"literal",value:"SCTP",description:'"SCTP"'},function(a){q.transport=a},function(){q.host=c()},function(a){q.port=parseInt(a.join(""))},function(a){return parseInt(a.join(""))},"stuns",{type:"literal",value:"stuns",description:'"stuns"'},"stun",{type:"literal",value:"stun",description:'"stun"'},function(a){q.scheme=a},function(a){q.host=a},function(){return c()},"?transport=",{type:"literal",value:"?transport=",description:'"?transport="'},"turns",{type:"literal",value:"turns",
description:'"turns"'},"turn",{type:"literal",value:"turn",description:'"turn"'},function(){q.transport=transport},function(){q=c()}],w=[a('. ""2 3!'),a('0"""1!3#'),a('0$""1!3%'),a('0&""1!3\''),a("7'*# \"7("),a('0(""1!3)'),a('0*""1!3+'),a('.,""2,3-'),a('..""2.3/'),a('00""1!31'),a('.2""2233*\u0089 ".4""2435*} ".6""2637*q ".8""2839*e ".:""2:3;*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E'),a('7)*# "7,'),a('.F""2F3G*} ".H""2H3I*q ".J""2J3K*e ".L""2L3M*Y ".N""2N3O*M ".P""2P3Q*A ".R""2R3S*5 ".T""2T3U*) ".V""2V3W'),
a('!!.Y""2Y3Z+7$7#+-%7#+#%\'#%$## X$"# X"# X+\' 4!6[!! %'),a('!! ]7$,#&7$"+-$7 +#%\'"%$"# X"# X*# " \\+@$ ]7$+&$,#&7$""" X+\'%4"6^" %$"# X"# X'),a('7.*# " \\'),a('! ]7\'*# "7(,)&7\'*# "7("+A$.8""2839+1%7/+\'%4#6_# %$## X$"# X"# X'),a('! ]72+&$,#&72""" X+s$ ]! ]7.,#&7."+-$72+#%\'"%$"# X"# X,@&! ]7.,#&7."+-$72+#%\'"%$"# X"# X"+\'%4"6`" %$"# X"# X'),a('0a""1!3b*# "73'),a('0c""1!3d'),a('0e""1!3f'),a('7!*) "0g""1!3h'),a('! ]7)*\u0095 ".F""2F3G*\u0089 ".J""2J3K*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O+\u009e$,\u009b&7)*\u0095 ".F""2F3G*\u0089 ".J""2J3K*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O""" X+& 4!6k! %'),
a('! ]7)*\u0089 ".F""2F3G*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O+\u0092$,\u008f&7)*\u0089 ".F""2F3G*} ".L""2L3M*q ".Y""2Y3Z*e ".P""2P3Q*Y ".H""2H3I*M ".@""2@3A*A ".i""2i3j*5 ".R""2R3S*) ".N""2N3O""" X+& 4!6k! %'),a('.T""2T3U*\u00e3 ".V""2V3W*\u00d7 ".l""2l3m*\u00cb ".n""2n3o*\u00bf ".:""2:3;*\u00b3 ".D""2D3E*\u00a7 ".2""2233*\u009b ".8""2839*\u008f ".p""2p3q*\u0083 "7&*} ".4""2435*q ".r""2r3s*e ".t""2t3u*Y ".6""2637*M ".>""2>3?*A ".v""2v3w*5 ".x""2x3y*) "7\'*# "7('),
a('! ]7)*\u012b ".F""2F3G*\u011f ".J""2J3K*\u0113 ".L""2L3M*\u0107 ".Y""2Y3Z*\u00fb ".P""2P3Q*\u00ef ".H""2H3I*\u00e3 ".@""2@3A*\u00d7 ".i""2i3j*\u00cb ".R""2R3S*\u00bf ".N""2N3O*\u00b3 ".T""2T3U*\u00a7 ".V""2V3W*\u009b ".l""2l3m*\u008f ".n""2n3o*\u0083 ".8""2839*w ".p""2p3q*k "7&*e ".4""2435*Y ".r""2r3s*M ".t""2t3u*A ".6""2637*5 ".v""2v3w*) ".x""2x3y+\u0134$,\u0131&7)*\u012b ".F""2F3G*\u011f ".J""2J3K*\u0113 ".L""2L3M*\u0107 ".Y""2Y3Z*\u00fb ".P""2P3Q*\u00ef ".H""2H3I*\u00e3 ".@""2@3A*\u00d7 ".i""2i3j*\u00cb ".R""2R3S*\u00bf ".N""2N3O*\u00b3 ".T""2T3U*\u00a7 ".V""2V3W*\u009b ".l""2l3m*\u008f ".n""2n3o*\u0083 ".8""2839*w ".p""2p3q*k "7&*e ".4""2435*Y ".r""2r3s*M ".t""2t3u*A ".6""2637*5 ".v""2v3w*) ".x""2x3y""" X+& 4!6k! %'),
a('!7/+A$.P""2P3Q+1%7/+\'%4#6z# %$## X$"# X"# X'),a('!7/+A$.4""2435+1%7/+\'%4#6{# %$## X$"# X"# X'),a('!7/+A$.>""2>3?+1%7/+\'%4#6|# %$## X$"# X"# X'),a('!7/+A$.T""2T3U+1%7/+\'%4#6}# %$## X$"# X"# X'),a('!7/+A$.V""2V3W+1%7/+\'%4#6~# %$## X$"# X"# X'),a('!.n""2n3o+1$7/+\'%4"6\u007f" %$"# X"# X'),a('!7/+7$.l""2l3m+\'%4"6\u0080" %$"# X"# X'),a('!7/+A$.D""2D3E+1%7/+\'%4#6\u0081# %$## X$"# X"# X'),a('!7/+A$.2""2233+1%7/+\'%4#6\u0082# %$## X$"# X"# X'),a('!7/+A$.8""2839+1%7/+\'%4#6\u0083# %$## X$"# X"# X'),
a('!7/+1$7&+\'%4"6\u0084" %$"# X"# X'),a('!7&+1$7/+\'%4"6\u0084" %$"# X"# X'),a('!7=+W$ ]7G*) "7K*# "7F,/&7G*) "7K*# "7F"+-%7>+#%\'#%$## X$"# X"# X'),a('0\u0085""1!3\u0086*A "0\u0087""1!3\u0088*5 "0\u0089""1!3\u008a*) "73*# "7.'),a('!7/+Y$7&+O% ]7J*# "7K,)&7J*# "7K"+1%7&+\'%4$6k$ %$$# X$## X$"# X"# X'),a('!7/+`$7&+V%! ]7J*# "7K,)&7J*# "7K"+! (%+2%7&+(%4$6\u008b$!!%$$# X$## X$"# X"# X'),a('7.*G ".L""2L3M*; "0\u008c""1!3\u008d*/ "0\u0089""1!3\u008a*# "73'),a('!.p""2p3q+K$0\u008e""1!3\u008f*5 "0\u0090""1!3\u0091*) "0\u0092""1!3\u0093+#%\'"%$"# X"# X'),
a('!7N+Q$.8""2839+A%7O*# " \\+1%7S+\'%4$6\u0094$ %$$# X$## X$"# X"# X'),a('!7N+k$.8""2839+[%7O*# " \\+K%7S+A%7_+7%7l*# " \\+\'%4&6\u0095& %$&# X$%# X$$# X$## X$"# X"# X'),a('!/\u0096""1$3\u0097*) "/\u0098""1#3\u0099+\' 4!6\u009a!! %'),a('!7P+b$!.8""2839+-$7R+#%\'"%$"# X"# X*# " \\+7%.:""2:3;+\'%4#6\u009b# %$## X$"# X"# X'),a(' ]7+*) "7-*# "7Q+2$,/&7+*) "7-*# "7Q""" X'),a('.<""2<3=*q ".>""2>3?*e ".@""2@3A*Y ".B""2B3C*M ".D""2D3E*A ".2""2233*5 ".6""2637*) ".4""2435'),a('! ]7+*_ "7-*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E,e&7+*_ "7-*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E"+& 4!6\u009c! %'),
a('!7T+N$!.8""2839+-$7^+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),a('!7U*) "7\\*# "7X+& 4!6\u009d! %'),a('! ]!7V+3$.J""2J3K+#%\'"%$"# X"# X,>&!7V+3$.J""2J3K+#%\'"%$"# X"# X"+G$7W+=%.J""2J3K*# " \\+\'%4#6\u009e# %$## X$"# X"# X'),a(' ]0\u009f""1!3\u00a0+,$,)&0\u009f""1!3\u00a0""" X'),a('!0$""1!3%+A$ ]0\u00a1""1!3\u00a2,)&0\u00a1""1!3\u00a2"+#%\'"%$"# X"# X'),a('!.r""2r3s+A$7Y+7%.t""2t3u+\'%4#6\u00a3# %$## X$"# X"# X'),a('!!7Z+\u00bf$.8""2839+\u00af%7Z+\u00a5%.8""2839+\u0095%7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'-%$-# X$,# X$+# X$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0838 "!.\u00a4""2\u00a43\u00a5+\u00af$7Z+\u00a5%.8""2839+\u0095%7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\',%$,# X$+# X$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0795 "!.\u00a4""2\u00a43\u00a5+\u0095$7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'*%$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u070c "!.\u00a4""2\u00a43\u00a5+{$7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u069d "!.\u00a4""2\u00a43\u00a5+a$7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'&%$&# X$%# X$$# X$## X$"# X"# X*\u0648 "!.\u00a4""2\u00a43\u00a5+G$7Z+=%.8""2839+-%7[+#%\'$%$$# X$## X$"# X"# X*\u060d "!.\u00a4""2\u00a43\u00a5+-$7[+#%\'"%$"# X"# X*\u05ec "!.\u00a4""2\u00a43\u00a5+-$7Z+#%\'"%$"# X"# X*\u05cb "!7Z+\u00a5$.\u00a4""2\u00a43\u00a5+\u0095%7Z+\u008b%.8""2839+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'+%$+# X$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0538 "!7Z+\u00b6$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u008b%.\u00a4""2\u00a43\u00a5+{%7Z+q%.8""2839+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\'*%$*# X$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0494 "!7Z+\u00c7$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u009c%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+q%.\u00a4""2\u00a43\u00a5+a%7Z+W%.8""2839+G%7Z+=%.8""2839+-%7[+#%\')%$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u03df "!7Z+\u00d8$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00ad%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0082%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+W%.\u00a4""2\u00a43\u00a5+G%7Z+=%.8""2839+-%7[+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0319 "!7Z+\u00e9$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00be%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0093%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+h%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+=%.\u00a4""2\u00a43\u00a5+-%7[+#%\'\'%$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0242 "!7Z+\u0114$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00e9%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00be%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0093%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+h%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+=%.\u00a4""2\u00a43\u00a5+-%7Z+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X*\u0140 "!7Z+\u0135$!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u010a%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00df%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u00b4%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+\u0089%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+^%!.8""2839+-$7Z+#%\'"%$"# X"# X*# " \\+3%.\u00a4""2\u00a43\u00a5+#%\'(%$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X+& 4!6\u00a6! %'),
a('!7#+S$7#*# " \\+C%7#*# " \\+3%7#*# " \\+#%\'$%$$# X$## X$"# X"# X'),a('!7Z+=$.8""2839+-%7Z+#%\'#%$## X$"# X"# X*# "7\\'),a('!7]+u$.J""2J3K+e%7]+[%.J""2J3K+K%7]+A%.J""2J3K+1%7]+\'%4\'6\u00a7\' %$\'# X$&# X$%# X$$# X$## X$"# X"# X'),a('!.\u00a8""2\u00a83\u00a9+3$0\u00aa""1!3\u00ab+#%\'"%$"# X"# X*\u00a0 "!.\u00ac""2\u00ac3\u00ad+=$0\u00ae""1!3\u00af+-%7!+#%\'#%$## X$"# X"# X*o "!.\u00b0""2\u00b03\u00b1+7$7!+-%7!+#%\'#%$## X$"# X"# X*D "!0\u00b2""1!3\u00b3+-$7!+#%\'"%$"# X"# X*# "7!'),a('!!7!*# " \\+c$7!*# " \\+S%7!*# " \\+C%7!*# " \\+3%7!*# " \\+#%\'%%$%# X$$# X$## X$"# X"# X+\' 4!6\u00b4!! %'),
a(' ]!.2""2233+-$7`+#%\'"%$"# X"# X,>&!.2""2233+-$7`+#%\'"%$"# X"# X"'),a('7a*A "7b*; "7c*5 "7d*/ "7e*) "7f*# "7g'),a('!/\u00b5""1*3\u00b6+b$/\u00b7""1#3\u00b8*G "/\u00b9""1#3\u00ba*; "/\u00bb""1$3\u00bc*/ "/\u00bd""1#3\u00be*# "76+(%4"6\u00bf"! %$"# X"# X'),a('!/\u00c0""1%3\u00c1+J$/\u00c2""1%3\u00c3*/ "/\u00c4""1"3\u00c5*# "76+(%4"6\u00c6"! %$"# X"# X'),a('!/\u00c7""1\'3\u00c8+2$7\u008f+(%4"6\u00c9"! %$"# X"# X'),a('!/\u00ca""1$3\u00cb+2$7\u00ec+(%4"6\u00cc"! %$"# X"# X'),a('!/\u00cd""1&3\u00ce+2$7T+(%4"6\u00cf"! %$"# X"# X'),
a('!/\u00d0""1"3\u00d1+R$!.>""2>3?+-$76+#%\'"%$"# X"# X*# " \\+\'%4"6\u00d2" %$"# X"# X'),a('!7h+T$!.>""2>3?+-$7i+#%\'"%$"# X"# X*# " \\+)%4"6\u00d3""! %$"# X"# X'),a('! ]7j+&$,#&7j""" X+\' 4!6\u00d4!! %'),a('! ]7j+&$,#&7j""" X+\' 4!6\u00d5!! %'),a('7k*) "7+*# "7-'),a('.r""2r3s*e ".t""2t3u*Y ".4""2435*M ".8""2839*A ".<""2<3=*5 ".@""2@3A*) ".B""2B3C'),a('!.6""2637+u$7m+k% ]!.<""2<3=+-$7m+#%\'"%$"# X"# X,>&!.<""2<3=+-$7m+#%\'"%$"# X"# X"+#%\'#%$## X$"# X"# X'),a('!7n+C$.>""2>3?+3%7o+)%4#6\u00d6#"" %$## X$"# X"# X'),
a(' ]7p*) "7+*# "7-+2$,/&7p*) "7+*# "7-""" X'),a(' ]7p*) "7+*# "7-,/&7p*) "7+*# "7-"'),a('.r""2r3s*e ".t""2t3u*Y ".4""2435*M ".6""2637*A ".8""2839*5 ".@""2@3A*) ".B""2B3C'),a('7\u0090*# "7r'),a("!7\u008f+K$7'+A%7s+7%7'+-%7\u0084+#%'%%$%# X$$# X$## X$\"# X\"# X"),a('7M*# "7t'),a('!7\u007f+G$.8""2839+7%7u*# "7x+\'%4#6\u00d7# %$## X$"# X"# X'),a('!7v*# "7w+N$!.6""2637+-$7\u0083+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),a('!.\u00d8""2\u00d83\u00d9+=$7\u0080+3%7w*# " \\+#%\'#%$## X$"# X"# X'),a('!.4""2435+-$7{+#%\'"%$"# X"# X'),
a('!7z+5$ ]7y,#&7y"+#%\'"%$"# X"# X'),a('7**) "7+*# "7-'),a('7+*\u008f "7-*\u0089 ".2""2233*} ".6""2637*q ".8""2839*e ".:""2:3;*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E'),a('!7|+k$ ]!.4""2435+-$7|+#%\'"%$"# X"# X,>&!.4""2435+-$7|+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('! ]7~,#&7~"+k$ ]!.2""2233+-$7}+#%\'"%$"# X"# X,>&!.2""2233+-$7}+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a(' ]7~,#&7~"'),a('7+*w "7-*q ".8""2839*e ".:""2:3;*Y ".<""2<3=*M ".>""2>3?*A ".@""2@3A*5 ".B""2B3C*) ".D""2D3E'),a('!7"+\u008d$ ]7"*G "7!*A ".@""2@3A*5 ".F""2F3G*) ".J""2J3K,M&7"*G "7!*A ".@""2@3A*5 ".F""2F3G*) ".J""2J3K"+\'%4"6\u00da" %$"# X"# X'),
a('7\u0081*# "7\u0082'),a('!!7O+3$.:""2:3;+#%\'"%$"# X"# X*# " \\+-$7S+#%\'"%$"# X"# X*# " \\'),a(' ]7+*\u0083 "7-*} ".B""2B3C*q ".D""2D3E*e ".2""2233*Y ".8""2839*M ".:""2:3;*A ".<""2<3=*5 ".>""2>3?*) ".@""2@3A+\u008c$,\u0089&7+*\u0083 "7-*} ".B""2B3C*q ".D""2D3E*e ".2""2233*Y ".8""2839*M ".:""2:3;*A ".<""2<3=*5 ".>""2>3?*) ".@""2@3A""" X'),a(' ]7y,#&7y"'),a('!/\u0098""1#3\u00db+y$.4""2435+i% ]7!+&$,#&7!""" X+P%.J""2J3K+@% ]7!+&$,#&7!""" X+\'%4%6\u00dc% %$%# X$$# X$## X$"# X"# X'),a('.\u00dd""2\u00dd3\u00de'),
a('.\u00df""2\u00df3\u00e0'),a('.\u00e1""2\u00e13\u00e2'),a('.\u00e3""2\u00e33\u00e4'),a('.\u00e5""2\u00e53\u00e6'),a('.\u00e7""2\u00e73\u00e8'),a('.\u00e9""2\u00e93\u00ea'),a('.\u00eb""2\u00eb3\u00ec'),a('.\u00ed""2\u00ed3\u00ee'),a('.\u00ef""2\u00ef3\u00f0'),a('!7\u0085*S "7\u0086*M "7\u0088*G "7\u0089*A "7\u008a*; "7\u008b*5 "7\u008c*/ "7\u008d*) "7\u008e*# "76+& 4!6\u00f1! %'),a("!7\u0084+K$7'+A%7\u0091+7%7'+-%7\u0093+#%'%%$%# X$$# X$## X$\"# X\"# X"),a("!7\u0092+' 4!6\u00f2!! %"),a('!7!+7$7!+-%7!+#%\'#%$## X$"# X"# X'),
a('! ]7**A "7+*; "7-*5 "73*/ "74*) "7\'*# "7(,G&7**A "7+*; "7-*5 "73*/ "74*) "7\'*# "7("+& 4!6\u00f3! %'),a('!7\u00b5+_$ ]!7A+-$7\u00b5+#%\'"%$"# X"# X,8&!7A+-$7\u00b5+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('!79+R$!.:""2:3;+-$79+#%\'"%$"# X"# X*# " \\+\'%4"6\u00f4" %$"# X"# X'),a('!7:*j "!7\u0097+_$ ]!7A+-$7\u0097+#%\'"%$"# X"# X,8&!7A+-$7\u0097+#%\'"%$"# X"# X"+#%\'"%$"# X"# X+& 4!6\u00f5! %'),a('!7L*# "7\u0098+c$ ]!7B+-$7\u009a+#%\'"%$"# X"# X,8&!7B+-$7\u009a+#%\'"%$"# X"# X"+\'%4"6\u00f6" %$"# X"# X'),
a('!7\u0099*# " \\+A$7@+7%7M+-%7?+#%\'$%$$# X$## X$"# X"# X'),a('!!76+_$ ]!7.+-$76+#%\'"%$"# X"# X,8&!7.+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X*# "7H+\' 4!6\u00f7!! %'),a('7\u009b*) "7\u009c*# "7\u009f'),a('!/\u00f8""1!3\u00f9+<$7<+2%7\u009e+(%4#6\u00fa#! %$## X$"# X"# X'),a('!/\u00fb""1\'3\u00fc+<$7<+2%7\u009d+(%4#6\u00fd#! %$## X$"# X"# X'),a('! ]7!+&$,#&7!""" X+\' 4!6\u00fe!! %'),a('!.\u00ff""2\u00ff3\u0100+x$!.J""2J3K+S$7!*# " \\+C%7!*# " \\+3%7!*# " \\+#%\'$%$$# X$## X$"# X"# X*# " \\+\'%4"6\u0101" %$"# X"# X'),
a('!76+N$!7<+-$7\u00a0+#%\'"%$"# X"# X*# " \\+)%4"6\u0102""! %$"# X"# X'),a('76*) "7T*# "7H'),a('!7\u00a2+_$ ]!7B+-$7\u00a3+#%\'"%$"# X"# X,8&!7B+-$7\u00a3+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('!/\u0103""1&3\u0104*G "/\u0105""1\'3\u0106*; "/\u0107""1$3\u0108*/ "/\u0109""1%3\u010a*# "76+& 4!6\u010b! %'),a('7\u00a4*# "7\u009f'),a('!/\u010c""1(3\u010d+O$7<+E%/\u010e""1(3\u010f*/ "/\u0110""1(3\u0111*# "76+#%\'#%$## X$"# X"# X'),a('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),
a('! ]7!+&$,#&7!""" X+\' 4!6\u0112!! %'),a("!7\u00a8+& 4!6\u0113! %"),a('!7\u00a9+s$7;+i%7\u00ae+_% ]!7B+-$7\u00af+#%\'"%$"# X"# X,8&!7B+-$7\u00af+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X'),a('7\u00aa*# "7\u00ab'),a('/\u0114""1$3\u0115*S "/\u0116""1%3\u0117*G "/\u0118""1%3\u0119*; "/\u011a""1%3\u011b*/ "/\u011c""1+3\u011d*# "7\u00ac'),a('/\u011e""1\'3\u011f*/ "/\u0120""1)3\u0121*# "7\u00ac'),a('76*# "7\u00ad'),a('!/\u0122""1"3\u0123+-$76+#%\'"%$"# X"# X'),a('7\u00ac*# "76'),a('!76+7$7<+-%7\u00b0+#%\'#%$## X$"# X"# X'),
a('76*# "7H'),a('!7\u00b2+7$7.+-%7\u008f+#%\'#%$## X$"# X"# X'),a('! ]7!+&$,#&7!""" X+\' 4!6\u0124!! %'),a("!7\u009d+' 4!6\u0125!! %"),a('!7\u00b5+d$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+(%4"6\u0126"!!%$"# X"# X'),a('!!77+k$ ]!.J""2J3K+-$77+#%\'"%$"# X"# X,>&!.J""2J3K+-$77+#%\'"%$"# X"# X"+#%\'"%$"# X"# X+! (%'),a('!7L*# "7\u0098+c$ ]!7B+-$7\u00b7+#%\'"%$"# X"# X,8&!7B+-$7\u00b7+#%\'"%$"# X"# X"+\'%4"6\u0127" %$"# X"# X'),a('7\u00b8*# "7\u009f'),a('!/\u0128""1#3\u0129+<$7<+2%76+(%4#6\u012a#! %$## X$"# X"# X'),
a('! ]7!+&$,#&7!""" X+\' 4!6\u012b!! %'),a("!7\u009d+' 4!6\u012c!! %"),a('! ]7\u0099,#&7\u0099"+\u0081$7@+w%7M+m%7?+c% ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+\'%4%6\u012d% %$%# X$$# X$## X$"# X"# X'),a("7\u00bd"),a('!/\u012e""1&3\u012f+s$7.+i%7\u00c0+_% ]!7A+-$7\u00c0+#%\'"%$"# X"# X,8&!7A+-$7\u00c0+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X*# "7\u00be'),a('!76+s$7.+i%7\u00bf+_% ]!7A+-$7\u00bf+#%\'"%$"# X"# X,8&!7A+-$7\u00bf+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X'),a('!76+=$7<+3%76*# "7H+#%\'#%$## X$"# X"# X'),
a('7\u00c1*G "7\u00c3*A "7\u00c5*; "7\u00c7*5 "7\u00c8*/ "7\u00c9*) "7\u00ca*# "7\u00bf'),a('!/\u0130""1%3\u0131+7$7<+-%7\u00c2+#%\'#%$## X$"# X"# X'),a("!7I+' 4!6\u0132!! %"),a('!/\u0133""1&3\u0134+\u00a5$7<+\u009b%7D+\u0091%7\u00c4+\u0087% ]! ]7\'+&$,#&7\'""" X+-$7\u00c4+#%\'"%$"# X"# X,G&! ]7\'+&$,#&7\'""" X+-$7\u00c4+#%\'"%$"# X"# X"+-%7E+#%\'&%$&# X$%# X$$# X$## X$"# X"# X'),a('7t*# "7w'),a('!/\u0135""1%3\u0136+7$7<+-%7\u00c6+#%\'#%$## X$"# X"# X'),a("!7I+' 4!6\u0137!! %"),a('!/\u0138""1&3\u0139+<$7<+2%7I+(%4#6\u013a#! %$## X$"# X"# X'),
a('!/\u013b""1%3\u013c+_$7<+U%!/\u013d""1$3\u013e+& 4!6\u013f! %*4 "!/\u0140""1%3\u0141+& 4!6\u0142! %+#%\'#%$## X$"# X"# X'),a('!/\u0143""1)3\u0144+T$7<+J%/\u0145""1#3\u0146*/ "/\u0147""1(3\u0148*# "76+(%4#6\u0149#! %$## X$"# X"# X'),a('!/\u014a""1#3\u014b+\u009e$7<+\u0094%7D+\u008a%!7\u00cb+k$ ]!.D""2D3E+-$7\u00cb+#%\'"%$"# X"# X,>&!.D""2D3E+-$7\u00cb+#%\'"%$"# X"# X"+#%\'"%$"# X"# X+-%7E+#%\'%%$%# X$$# X$## X$"# X"# X'),a('!/\u014c""1(3\u014d*/ "/\u014e""1$3\u014f*# "76+\' 4!6\u0150!! %'),a('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),
a('!7\u00ce+K$7.+A%7\u00ce+7%7.+-%7\u008f+#%\'%%$%# X$$# X$## X$"# X"# X'),a('! ]7!+&$,#&7!""" X+\' 4!6\u0151!! %'),a('!7\u00d0+c$ ]!7A+-$7\u00d0+#%\'"%$"# X"# X,8&!7A+-$7\u00d0+#%\'"%$"# X"# X"+\'%4"6\u0152" %$"# X"# X'),a('!7\u0098+c$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+\'%4"6\u0153" %$"# X"# X'),a('!7L*) "7\u0098*# "7t+c$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+\'%4"6\u0154" %$"# X"# X'),a('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),
a('!7\u00d4+_$ ]!7A+-$7\u00d4+#%\'"%$"# X"# X,8&!7A+-$7\u00d4+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('!7\u0098+_$ ]!7B+-$7\u009f+#%\'"%$"# X"# X,8&!7B+-$7\u009f+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('! ]7!+&$,#&7!""" X+\' 4!6\u0155!! %'),a('!7\u00d7+_$ ]!7B+-$7\u00d8+#%\'"%$"# X"# X,8&!7B+-$7\u00d8+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('!/\u0156""1&3\u0157*; "/\u0158""1\'3\u0159*/ "/\u015a""1*3\u015b*# "76+& 4!6\u015c! %'),a('!/\u015d""1&3\u015e+<$7<+2%7\u00d9+(%4#6\u015f#! %$## X$"# X"# X*\u0083 "!/\u00fb""1\'3\u00fc+<$7<+2%7\u009d+(%4#6\u0160#! %$## X$"# X"# X*S "!/\u0161""1+3\u0162+<$7<+2%7\u009d+(%4#6\u0163#! %$## X$"# X"# X*# "7\u009f'),
a('/\u0164""1+3\u0165*k "/\u0166""1)3\u0167*_ "/\u0168""1(3\u0169*S "/\u016a""1\'3\u016b*G "/\u016c""1&3\u016d*; "/\u016e""1*3\u016f*/ "/\u0170""1)3\u0171*# "76'),a('71*# " \\'),a('!76+_$ ]!7A+-$76+#%\'"%$"# X"# X,8&!7A+-$76+#%\'"%$"# X"# X"+#%\'"%$"# X"# X*# " \\'),a('!7L*# "7\u0098+c$ ]!7B+-$7\u00dd+#%\'"%$"# X"# X,8&!7B+-$7\u00dd+#%\'"%$"# X"# X"+\'%4"6\u0172" %$"# X"# X'),a('7\u00b8*# "7\u009f'),a('!7\u00df+_$ ]!7A+-$7\u00df+#%\'"%$"# X"# X,8&!7A+-$7\u00df+#%\'"%$"# X"# X"+#%\'"%$"# X"# X'),a('!7\u00e6+s$7.+i%7\u00e9+_% ]!7B+-$7\u00e0+#%\'"%$"# X"# X,8&!7B+-$7\u00e0+#%\'"%$"# X"# X"+#%\'$%$$# X$## X$"# X"# X'),
a('7\u00e1*; "7\u00e2*5 "7\u00e3*/ "7\u00e4*) "7\u00e5*# "7\u009f'),a('!/\u0173""1#3\u0174+<$7<+2%7\u00ec+(%4#6\u0175#! %$## X$"# X"# X'),a('!/\u0176""1%3\u0177+<$7<+2%7T+(%4#6\u0178#! %$## X$"# X"# X'),a('!/\u0179""1(3\u017a+B$7<+8%7\\*# "7Y+(%4#6\u017b#! %$## X$"# X"# X'),a('!/\u017c""1&3\u017d+<$7<+2%76+(%4#6\u017e#! %$## X$"# X"# X'),a('!/\u017f""1%3\u0180+T$!7<+5$ ]7!,#&7!"+#%\'"%$"# X"# X*# " \\+\'%4"6\u0181" %$"# X"# X'),a('!7\u00e7+K$7;+A%76+7%7;+-%7\u00e8+#%\'%%$%# X$$# X$## X$"# X"# X'),
a('!/\u0098""1#3\u00db*# "76+\' 4!6\u0182!! %'),a('!/\u00b7""1#3\u0183*G "/\u00b9""1#3\u0184*; "/\u00bd""1#3\u0185*/ "/\u00bb""1$3\u0186*# "76+\' 4!6\u0187!! %'),a('!7\u00ea+H$!7C+-$7\u00eb+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),a('!7U*) "7\\*# "7X+& 4!6\u0188! %'),a('!!7!*# " \\+c$7!*# " \\+S%7!*# " \\+C%7!*# " \\+3%7!*# " \\+#%\'%%$%# X$$# X$## X$"# X"# X+\' 4!6\u0189!! %'),a('!!7!+C$7!*# " \\+3%7!*# " \\+#%\'#%$## X$"# X"# X+\' 4!6\u018a!! %'),a("7\u00bd"),a('!76+7$70+-%7\u00ef+#%\'#%$## X$"# X"# X'),
a(' ]72*) "74*# "7.,/&72*) "74*# "7."'),a(' ]7%,#&7%"'),a('!7\u00f2+=$.8""2839+-%7\u00f3+#%\'#%$## X$"# X"# X'),a('!/\u018b""1%3\u018c*) "/\u018d""1$3\u018e+\' 4!6\u018f!! %'),a('!7\u00f4+N$!.8""2839+-$7^+#%\'"%$"# X"# X*# " \\+#%\'"%$"# X"# X'),a('!7\\*) "7X*# "7\u0082+\' 4!6\u0190!! %'),a('! ]7\u00f6*) "7-*# "7\u00f7,/&7\u00f6*) "7-*# "7\u00f7"+& 4!6\u0191! %'),a('7"*S "7!*M ".F""2F3G*A ".J""2J3K*5 ".H""2H3I*) ".N""2N3O'),a('.L""2L3M*\u0095 ".B""2B3C*\u0089 ".<""2<3=*} ".R""2R3S*q ".T""2T3U*e ".V""2V3W*Y ".P""2P3Q*M ".@""2@3A*A ".D""2D3E*5 ".2""2233*) ".>""2>3?'),
a('!7\u00f9+h$.8""2839+X%7\u00f3+N%!.\u0192""2\u01923\u0193+-$7\u00e8+#%\'"%$"# X"# X*# " \\+#%\'$%$$# X$## X$"# X"# X'),a('!/\u0194""1%3\u0195*) "/\u0196""1$3\u0197+\' 4!6\u018f!! %'),a('!7\u00e8+Q$/\u00b7""1#3\u00b8*7 "/\u00b9""1#3\u00ba*+ " ]7+,#&7+"+\'%4"6\u0198" %$"# X"# X'),a('!7\u00fd+\u008f$.F""2F3G+\u007f%7\u00fc+u%.F""2F3G+e%7\u00fc+[%.F""2F3G+K%7\u00fc+A%.F""2F3G+1%7\u00fe+\'%4)6\u0199) %$)# X$(# X$\'# X$&# X$%# X$$# X$## X$"# X"# X'),a('!7#+A$7#+7%7#+-%7#+#%\'$%$$# X$## X$"# X"# X'),a('!7\u00fc+-$7\u00fc+#%\'"%$"# X"# X'),
a('!7\u00fc+7$7\u00fc+-%7\u00fc+#%\'#%$## X$"# X"# X')],r=0,v=0,t=0,u=[],C=0;if("startRule"in g){if(!(g.startRule in h))throw Error("Can't start parsing from rule \""+g.startRule+'".');k=h[g.startRule]}var q={},h=m(k);if(h!==p&&r===e.length)return q;h!==p&&r<e.length&&d({type:"end",description:"end of input"});return-1}(function(b,c){function d(){this.constructor=b}d.prototype=c.prototype;b.prototype=new d})(g,Error);return{SyntaxError:g,parse:function(b,c){return e(b,{startRule:c})}}}},{}],154:[function(h,
k,l){k.exports=function(b){var g={AllBrowsers:{maskDtls:function(b){},unmaskDtls:function(b){return b}},Firefox:{isFirefox:function(){return void 0!==window.mozRTCPeerConnection},cannotHandleExtraWhitespace:function(b){this.isFirefox()&&b.body&&(b.body=b.body.replace(/ \r\n/g,"\r\n"))},hasMissingCLineInSDP:function(b){var f,c;if(b.indexOf("c=")>b.indexOf("m=")){c=b.match(/m=.*\r\n.*/g);for(var d=0;d<c.length;d++)0<=c[d].toString().search(/i=.*/)?(f=b.indexOf(c[d].toString())+c[d].toString().length,
"c="!==b.substr(f,2)&&(b=b.substr(0,f)+"\r\nc=IN IP4 0.0.0.0"+b.substr(f))):0>c[d].toString().search(/c=.*/)&&(f=b.indexOf(c[d].toString().match(/.*/))+c[d].toString().match(/.*/).toString().length,b=b.substr(0,f)+"\r\nc=IN IP4 0.0.0.0"+b.substr(f))}return b},hasIncompatibleCLineWithSomeSIPEndpoints:function(e){return e.replace(/(0\.0\.0\.0)/gmi,b.Utils.getRandomTestNetIP())}},Chrome:{needsExplicitlyInactiveSDP:function(b){var f,c;return g.Firefox.isFirefox()&&(c=b.indexOf("m=video 0"),-1!==c)?(f=
b.substr(c),f=f.replace(/\r\nc=IN IP4.*\r\n$/,"\r\nc=IN IP4 0.0.0.0\r\na=inactive\r\n"),b.substr(0,c)+f):b},getsConfusedAboutGUM:function(b){b.mediaHandler&&b.mediaHandler.close()}}};return g}},{}],155:[function(h,k,l){k.exports=function(){var b=function(b,e,f){this.logger=b;this.category=e;this.label=f};b.prototype.debug=function(b){this.logger.debug(this.category,this.label,b)};b.prototype.log=function(b){this.logger.log(this.category,this.label,b)};b.prototype.warn=function(b){this.logger.warn(this.category,
this.label,b)};b.prototype.error=function(b){this.logger.error(this.category,this.label,b)};return b}()},{}],156:[function(h,k,l){k.exports=function(b,g){var e=b.console||{debug:function(){},log:function(){},warn:function(){},error:function(){}},f=function(){var b,d={error:0,warn:1,log:2,debug:3},a=2,e=!0,f=null;this.loggers={};b=this.getLogger("sip.loggerfactory");Object.defineProperties(this,{builtinEnabled:{get:function(){return e},set:function(a){"boolean"===typeof a?e=a:b.error('invalid "builtinEnabled" parameter value: '+
JSON.stringify(a))}},level:{get:function(){return a},set:function(e){0<=e&&3>=e?a=e:3<e?a=3:d.hasOwnProperty(e)?a=d[e]:b.error('invalid "level" parameter value: '+JSON.stringify(e))}},connector:{get:function(){return f},set:function(a){null===a||""===a||void 0===a?f=null:"function"===typeof a?f=a:b.error('invalid "connector" parameter value: '+JSON.stringify(a))}}})};f.prototype.print=function(b,d,a,f){var g=[];g.push(new Date);g.push(d);a&&g.push(a);g.push("");"string"===typeof f?b.call(e,g.join(" | ")+
f):b.call(e,f)};f.prototype.debug=function(b,d,a){3===this.level&&(this.builtinEnabled&&this.print(e.debug,b,d,a),this.connector&&this.connector("debug",b,d,a))};f.prototype.log=function(b,d,a){2<=this.level&&(this.builtinEnabled&&this.print(e.log,b,d,a),this.connector&&this.connector("log",b,d,a))};f.prototype.warn=function(b,d,a){1<=this.level&&(this.builtinEnabled&&this.print(e.warn,b,d,a),this.connector&&this.connector("warn",b,d,a))};f.prototype.error=function(b,d,a){this.builtinEnabled&&this.print(e.error,
b,d,a);this.connector&&this.connector("error",b,d,a)};f.prototype.getLogger=function(b,d){var a;if(d&&3===this.level)return new g(this,b,d);if(this.loggers[b])return this.loggers[b];a=new g(this,b);return this.loggers[b]=a};return f}},{}],157:[function(h,k,l){k.exports=function(b){var g=function(b,f){};g.prototype=Object.create(b.prototype,{isReady:{value:function(){}},close:{value:function(){}},getDescription:{value:function(b,f,c){}},setDescription:{value:function(b,f,c){}}});return g}},{}],158:[function(h,
k,l){k.exports=function(b){var g;g=function(e,f,c){var d;if(!(e&&e instanceof b.URI))throw new TypeError('missing or invalid "uri" parameter');this.uri=e;this.parameters={};for(d in c)this.setParam(d,c[d]);Object.defineProperties(this,{displayName:{get:function(){return f},set:function(a){f=0===a?"0":a}}})};g.prototype={setParam:function(b,f){b&&(this.parameters[b.toLowerCase()]="undefined"===typeof f||null===f?null:f.toString())},getParam:b.URI.prototype.getParam,hasParam:b.URI.prototype.hasParam,
deleteParam:b.URI.prototype.deleteParam,clearParams:b.URI.prototype.clearParams,clone:function(){return new g(this.uri.clone(),this.displayName,JSON.parse(JSON.stringify(this.parameters)))},toString:function(){var b,f;b=this.displayName||0===this.displayName?'"'+this.displayName+'" ':"";b+="<"+this.uri.toString()+">";for(f in this.parameters)b+=";"+f,null!==this.parameters[f]&&(b+="="+this.parameters[f]);return b}};g.parse=function(e){e=b.Grammar.parse(e,"Name_Addr_Header");if(-1!==e)return e};b.NameAddrHeader=
g}},{}],159:[function(h,k,l){k.exports=function(b){b.Parser={parseMessage:function(g,e){var f,c,d,a,m=0;d=g.indexOf("\r\n");c=e.getLogger("sip.parser");if(-1===d)c.warn("no CRLF found, not a SIP message, discarded");else if(f=g.substring(0,d),a=b.Grammar.parse(f,"Request_Response"),-1===a)c.warn('error parsing first line of SIP message: "'+f+'"');else{a.status_code?(f=new b.IncomingResponse(e),f.status_code=a.status_code,f.reason_phrase=a.reason_phrase):(f=new b.IncomingRequest(e),f.method=a.method,
f.ruri=a.uri);f.data=g;for(m=d+2;;){a:{d=g;a=m;var n=0,h=0;if(d.substring(a,a+2).match(/(^\r\n)/))d=-2;else{for(;0===n;){h=d.indexOf("\r\n",a);if(-1===h){d=h;break a}!d.substring(h+2,h+4).match(/(^\r\n)/)&&d.charAt(h+2).match(/(^\s+)/)?a=h+2:n=h}d=n}}if(-2===d){d=m+2;break}else if(-1===d){c.error("malformed message");return}a=f;var n=g,k=m,m=d,l=h=void 0,z=void 0,w=void 0,h=n.indexOf(":",k),k=n.substring(k,h).trim(),n=n.substring(h+1,m).trim();switch(k.toLowerCase()){case "via":case "v":a.addHeader("via",
n);if(1===a.getHeaders("via").length){if(w=a.parseHeader("Via"))a.via=w,a.via_branch=w.branch}else w=0;break;case "from":case "f":a.setHeader("from",n);if(w=a.parseHeader("from"))a.from=w,a.from_tag=w.getParam("tag");break;case "to":case "t":a.setHeader("to",n);if(w=a.parseHeader("to"))a.to=w,a.to_tag=w.getParam("tag");break;case "record-route":w=b.Grammar.parse(n,"Record_Route");if(-1===w){w=void 0;break}z=w.length;for(l=0;l<z;l++)h=w[l],a.addHeader("record-route",n.substring(h.position,h.offset)),
a.headers["Record-Route"][a.getHeaders("record-route").length-1].parsed=h.parsed;break;case "call-id":case "i":a.setHeader("call-id",n);if(w=a.parseHeader("call-id"))a.call_id=n;break;case "contact":case "m":w=b.Grammar.parse(n,"Contact");if(-1===w){w=void 0;break}z=w.length;for(l=0;l<z;l++)h=w[l],a.addHeader("contact",n.substring(h.position,h.offset)),a.headers.Contact[a.getHeaders("contact").length-1].parsed=h.parsed;break;case "content-length":case "l":a.setHeader("content-length",n);w=a.parseHeader("content-length");
break;case "content-type":case "c":a.setHeader("content-type",n);w=a.parseHeader("content-type");break;case "cseq":a.setHeader("cseq",n);if(w=a.parseHeader("cseq"))a.cseq=w.value;a instanceof b.IncomingResponse&&(a.method=w.method);break;case "max-forwards":a.setHeader("max-forwards",n);w=a.parseHeader("max-forwards");break;case "www-authenticate":a.setHeader("www-authenticate",n);w=a.parseHeader("www-authenticate");break;case "proxy-authenticate":a.setHeader("proxy-authenticate",n);w=a.parseHeader("proxy-authenticate");
break;case "refer-to":case "r":a.setHeader("refer-to",n);if(w=a.parseHeader("refer-to"))a.refer_to=w;break;default:a.setHeader(k,n),w=0}a=void 0===w?{error:'error parsing header "'+k+'"'}:!0;if(!0!==a){c.error(a.error);return}m=d+2}f.hasHeader("content-length")?(c=f.getHeader("content-length"),f.body=g.substr(d,c)):f.body=g.substring(d);return f}}}}},{}],160:[function(h,k,l){k.exports=function(b){var g;g=function(e){var f={};this.registrar=e.configuration.registrarServer;this.expires=e.configuration.registerExpires;
this.contact=e.contact.toString();this.contact+=";reg-id=1";this.contact+=';+sip.instance="<urn:uuid:'+e.configuration.instanceId+'>"';this.call_id=b.Utils.createRandomToken(22);this.cseq=80;this.to_uri=e.configuration.uri;f.to_uri=this.to_uri;f.call_id=this.call_id;f.cseq=this.cseq;b.Utils.augment(this,b.ClientContext,[e,"REGISTER",this.registrar,{params:f}]);this.registrationExpiredTimer=this.registrationTimer=null;this.registered=!1;this.logger=e.getLogger("sip.registercontext");this.initMoreEvents(["registered",
"unregistered"])};g.prototype={register:function(e){var f=this,c;e=e||{};c=(e.extraHeaders||[]).slice();c.push("Contact: "+this.contact+";expires="+this.expires);c.push("Allow: "+b.Utils.getAllowedMethods(this.ua));this.receiveResponse=function(c){var a,m,g=c.getHeaders("contact").length;if(c.cseq===this.cseq)switch(null!==this.registrationTimer&&(b.Timers.clearTimeout(this.registrationTimer),this.registrationTimer=null),!0){case /^1[0-9]{2}$/.test(c.status_code):this.emit("progress",c);break;case /^2[0-9]{2}$/.test(c.status_code):this.emit("accepted",
c);c.hasHeader("expires")&&(m=c.getHeader("expires"));null!==this.registrationExpiredTimer&&(b.Timers.clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=null);if(!g){this.logger.warn("no Contact header in response to REGISTER, response ignored");break}for(;g--;)if(a=c.parseHeader("contact",g),a.uri.user===this.ua.contact.uri.user){m=a.getParam("expires");break}else a=null;if(!a){this.logger.warn("no Contact header pointing to us, response ignored");break}m||(m=this.expires);
this.registrationTimer=b.Timers.setTimeout(function(){f.registrationTimer=null;f.register(e)},1E3*m-3E3);this.registrationExpiredTimer=b.Timers.setTimeout(function(){f.logger.warn("registration expired");f.registered&&f.unregistered(null,b.C.causes.EXPIRES)},1E3*m);a.hasParam("temp-gruu")&&(this.ua.contact.temp_gruu=b.URI.parse(a.getParam("temp-gruu").replace(/"/g,"")));a.hasParam("pub-gruu")&&(this.ua.contact.pub_gruu=b.URI.parse(a.getParam("pub-gruu").replace(/"/g,"")));this.registered=!0;this.emit("registered",
c||null);break;case /^423$/.test(c.status_code):c.hasHeader("min-expires")?(this.expires=c.getHeader("min-expires"),this.register(e)):(this.logger.warn("423 response received for REGISTER without Min-Expires"),this.registrationFailure(c,b.C.causes.SIP_FAILURE_CODE));break;default:a=b.Utils.sipErrorCause(c.status_code),this.registrationFailure(c,a)}};this.onRequestTimeout=function(){this.registrationFailure(null,b.C.causes.REQUEST_TIMEOUT)};this.onTransportError=function(){this.registrationFailure(null,
b.C.causes.CONNECTION_ERROR)};this.cseq++;this.request.cseq=this.cseq;this.request.setHeader("cseq",this.cseq+" REGISTER");this.request.extraHeaders=c;this.send()},registrationFailure:function(b,f){this.emit("failed",b||null,f||null)},onTransportClosed:function(){this.registered_before=this.registered;null!==this.registrationTimer&&(b.Timers.clearTimeout(this.registrationTimer),this.registrationTimer=null);null!==this.registrationExpiredTimer&&(b.Timers.clearTimeout(this.registrationExpiredTimer),
this.registrationExpiredTimer=null);this.registered&&this.unregistered(null,b.C.causes.CONNECTION_ERROR)},onTransportConnected:function(){this.register()},close:function(){this.registered_before=this.registered;this.unregister()},unregister:function(e){var f;this.registered?(e=e||{},f=(e.extraHeaders||[]).slice(),this.registered=!1,null!==this.registrationTimer&&(b.Timers.clearTimeout(this.registrationTimer),this.registrationTimer=null),e.all?(f.push("Contact: *"),f.push("Expires: 0")):f.push("Contact: "+
this.contact+";expires=0"),this.receiveResponse=function(c){var d;switch(!0){case /^1[0-9]{2}$/.test(c.status_code):this.emit("progress",c);break;case /^2[0-9]{2}$/.test(c.status_code):this.emit("accepted",c);null!==this.registrationExpiredTimer&&(b.Timers.clearTimeout(this.registrationExpiredTimer),this.registrationExpiredTimer=null);this.unregistered(c);break;default:d=b.Utils.sipErrorCause(c.status_code),this.unregistered(c,d)}},this.onRequestTimeout=function(){},this.onTransportError=function(){},
this.cseq++,this.request.cseq=this.cseq,this.request.setHeader("cseq",this.cseq+" REGISTER"),this.request.extraHeaders=f,this.send()):this.logger.warn("already unregistered")},unregistered:function(b,f){this.registered=!1;this.emit("unregistered",b||null,f||null)}};b.RegisterContext=g}},{}],161:[function(h,k,l){k.exports=function(b){var g;g=function(e,f){this.logger=f.getLogger("sip.requestsender");this.ua=f;this.applicant=e;this.method=e.request.method;this.request=e.request;this.credentials=null;
this.staled=this.challenged=!1;if(f.status===b.UA.C.STATUS_USER_CLOSED&&(this.method!==b.C.BYE||this.method!==b.C.ACK))this.onTransportError()};g.prototype={send:function(){switch(this.method){case "INVITE":this.clientTransaction=new b.Transactions.InviteClientTransaction(this,this.request,this.ua.transport);break;case "ACK":this.clientTransaction=new b.Transactions.AckClientTransaction(this,this.request,this.ua.transport);break;default:this.clientTransaction=new b.Transactions.NonInviteClientTransaction(this,
this.request,this.ua.transport)}this.clientTransaction.send();return this.clientTransaction},onRequestTimeout:function(){this.applicant.onRequestTimeout()},onTransportError:function(){this.applicant.onTransportError()},receiveResponse:function(e){var f,c;c=e.status_code;401!==c&&407!==c||null===this.ua.configuration.password?this.applicant.receiveResponse(e):(401===e.status_code?(f=e.parseHeader("www-authenticate"),c="authorization"):(f=e.parseHeader("proxy-authenticate"),c="proxy-authorization"),
f?!this.challenged||!this.staled&&!0===f.stale?(this.credentials||(this.credentials=new b.DigestAuthentication(this.ua)),this.credentials.authenticate(this.request,f)?(this.challenged=!0,f.stale&&(this.staled=!0),e.method===b.C.REGISTER?e=this.applicant.cseq+=1:this.request.dialog?e=this.request.dialog.local_seqnum+=1:(e=this.request.cseq+1,this.request.cseq=e),this.request.setHeader("cseq",e+" "+this.method),this.request.setHeader(c,this.credentials.toString()),this.send()):this.applicant.receiveResponse(e)):
this.applicant.receiveResponse(e):(this.logger.warn(e.status_code+" with wrong or missing challenge, cannot authenticate"),this.applicant.receiveResponse(e)))}};b.RequestSender=g}},{}],162:[function(h,k,l){(function(b){k.exports=function(b){var e={},f=h("../package.json");Object.defineProperties(e,{version:{get:function(){return f.version}},name:{get:function(){return f.title}}});h("./Utils.js")(e);var c=h("./Logger.js");e.LoggerFactory=h("./LoggerFactory.js")(b,c);h("./EventEmitter.js")(e);e.C=h("./Constants.js")(e.name,
e.version);e.Exceptions=h("./Exceptions.js");e.Timers=h("./Timers.js")(b);h("./Transport.js")(e,b);h("./Parser.js")(e);h("./SIPMessage.js")(e);h("./URI.js")(e);h("./NameAddrHeader.js")(e);h("./Transactions.js")(e,b);c=h("./Dialog/RequestSender.js")(e,b);h("./Dialogs.js")(e,c);h("./RequestSender.js")(e);h("./RegisterContext.js")(e,b);e.MediaHandler=h("./MediaHandler.js")(e.EventEmitter);h("./ClientContext.js")(e);h("./ServerContext.js")(e);c=h("./Session/DTMF.js")(e);h("./Session.js")(e,b,c);h("./Subscription.js")(e,
b);var c=h("./WebRTC/MediaHandler.js")(e),d=h("./WebRTC/MediaStreamManager.js")(e);e.WebRTC=h("./WebRTC.js")(e.Utils,b,c,d);h("./UA.js")(e,b);e.Hacks=h("./Hacks.js")(e);h("./SanityCheck.js")(e);e.DigestAuthentication=h("./DigestAuthentication.js")(e.Utils);e.Grammar=h("./Grammar/dist/Grammar")(e);return e}("undefined"!==typeof window?window:b)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../package.json":145,"./ClientContext.js":146,
"./Constants.js":147,"./Dialog/RequestSender.js":148,"./Dialogs.js":149,"./DigestAuthentication.js":150,"./EventEmitter.js":151,"./Exceptions.js":152,"./Grammar/dist/Grammar":153,"./Hacks.js":154,"./Logger.js":155,"./LoggerFactory.js":156,"./MediaHandler.js":157,"./NameAddrHeader.js":158,"./Parser.js":159,"./RegisterContext.js":160,"./RequestSender.js":161,"./SIPMessage.js":163,"./SanityCheck.js":164,"./ServerContext.js":165,"./Session.js":166,"./Session/DTMF.js":167,"./Subscription.js":168,"./Timers.js":169,
"./Transactions.js":170,"./Transport.js":171,"./UA.js":172,"./URI.js":173,"./Utils.js":174,"./WebRTC.js":175,"./WebRTC/MediaHandler.js":176,"./WebRTC/MediaStreamManager.js":177}],163:[function(h,k,l){k.exports=function(b){var g,e,f,c;g=function(c,a,e,f,g,h){f=f||{};if(!c||!a||!e)return null;this.logger=e.getLogger("sip.sipmessage");this.ua=e;this.headers={};this.method=c;this.ruri=a;this.body=h;this.extraHeaders=(g||[]).slice();this.statusCode=f.status_code;this.reasonPhrase=f.reason_phrase;f.route_set?
this.setHeader("route",f.route_set):e.configuration.usePreloadedRoute&&this.setHeader("route",e.transport.server.sip_uri);this.setHeader("via","");this.setHeader("max-forwards",b.UA.C.MAX_FORWARDS);g=f.to_displayName||0===f.to_displayName?'"'+f.to_displayName+'" ':"";g+="<"+(f.to_uri||a)+">";g+=f.to_tag?";tag="+f.to_tag:"";this.to=new b.NameAddrHeader.parse(g);this.setHeader("to",g);a=f.from_displayName||0===f.from_displayName?'"'+f.from_displayName+'" ':e.configuration.displayName?'"'+e.configuration.displayName+
'" ':"";a+="<"+(f.from_uri||e.configuration.uri)+">;tag=";a+=f.from_tag||b.Utils.newTag();this.from=new b.NameAddrHeader.parse(a);this.setHeader("from",a);this.call_id=e=f.call_id||e.configuration.sipjsId+b.Utils.createRandomToken(15);this.setHeader("call-id",e);this.cseq=f=f.cseq||Math.floor(1E4*Math.random());this.setHeader("cseq",f+" "+c)};g.prototype={setHeader:function(c,a){this.headers[b.Utils.headerize(c)]=a instanceof Array?a:[a]},getHeader:function(c){var a,e=this.extraHeaders.length,f=this.headers[b.Utils.headerize(c)];
if(f){if(f[0])return f[0]}else for(c=new RegExp("^\\s*"+c+"\\s*:","i"),a=0;a<e;a++)if(f=this.extraHeaders[a],c.test(f))return f.substring(f.indexOf(":")+1).trim()},getHeaders:function(c){var a,e,f=this.headers[b.Utils.headerize(c)],g=[];if(f)for(a=f.length,c=0;c<a;c++)g.push(f[c]);else for(a=this.extraHeaders.length,e=new RegExp("^\\s*"+c+"\\s*:","i"),c=0;c<a;c++)f=this.extraHeaders[c],e.test(f)&&g.push(f.substring(f.indexOf(":")+1).trim());return g},hasHeader:function(c){var a,e=this.extraHeaders.length;
if(this.headers[b.Utils.headerize(c)])return!0;c=new RegExp("^\\s*"+c+"\\s*:","i");for(a=0;a<e;a++)if(c.test(this.extraHeaders[a]))return!0;return!1},toString:function(){var c,a,e,f,g=[];c=""+(this.method+" "+this.ruri+" SIP/2.0\r\n");for(a in this.headers)for(e=this.headers[a].length,f=0;f<e;f++)c+=a+": "+this.headers[a][f]+"\r\n";e=this.extraHeaders.length;for(f=0;f<e;f++)c+=this.extraHeaders[f].trim()+"\r\n";this.method===b.C.REGISTER?g.push("path","gruu"):this.method===b.C.INVITE&&(this.ua.contact.pub_gruu||
this.ua.contact.temp_gruu)&&g.push("gruu");this.ua.configuration.rel100===b.C.supported.SUPPORTED&&g.push("100rel");g.push("outbound");c=c+("Supported: "+g+"\r\n")+("User-Agent: "+this.ua.configuration.userAgentString+"\r\n");this.body?(e=b.Utils.str_utf8_length(this.body),c+="Content-Length: "+e+"\r\n\r\n",c+=this.body):c+="Content-Length: 0\r\n\r\n";return c}};e=function(){this.body=this.to_tag=this.to=this.from_tag=this.from=this.cseq=this.call_id=this.via_branch=this.via=this.method=this.headers=
this.data=null};e.prototype={addHeader:function(c,a){var e={raw:a};c=b.Utils.headerize(c);this.headers[c]?this.headers[c].push(e):this.headers[c]=[e]},getHeader:function(c){if((c=this.headers[b.Utils.headerize(c)])&&c[0])return c[0].raw},getHeaders:function(c){var a,e=this.headers[b.Utils.headerize(c)],f=[];if(!e)return[];a=e.length;for(c=0;c<a;c++)f.push(e[c].raw);return f},hasHeader:function(c){return this.headers[b.Utils.headerize(c)]?!0:!1},parseHeader:function(c,a){var e,f,g;c=b.Utils.headerize(c);
a=a||0;if(this.headers[c])if(a>=this.headers[c].length)this.logger.log('not so many "'+c+'" headers present');else{e=this.headers[c][a];f=e.raw;if(e.parsed)return e.parsed;g=b.Grammar.parse(f,c.replace(/-/g,"_"));if(-1===g)this.headers[c].splice(a,1),this.logger.warn('error parsing "'+c+'" header field with value "'+f+'"');else return e.parsed=g}else this.logger.log('header "'+c+'" not present')},s:function(b,a){return this.parseHeader(b,a)},setHeader:function(c,a){var e={raw:a};this.headers[b.Utils.headerize(c)]=
[e]},toString:function(){return this.data}};f=function(b){this.logger=b.getLogger("sip.sipmessage");this.ua=b;this.headers={};this.server_transaction=this.transport=this.ruri=null};f.prototype=new e;f.prototype.reply=function(c,a,e,f,g,h){var k,l,w,r,v=[];w=this.getHeader("To");var t=l=0;c=c||null;a=a||null;if(!c||100>c||699<c)throw new TypeError("Invalid status_code: "+c);if(a&&"string"!==typeof a&&!(a instanceof String))throw new TypeError("Invalid reason_phrase: "+a);a=a||b.C.REASON_PHRASE[c]||
"";e=(e||[]).slice();r="SIP/2.0 "+c+" "+a+"\r\n";if(this.method===b.C.INVITE&&100<c&&200>=c)for(k=this.getHeaders("record-route"),a=k.length,l;l<a;l++)r+="Record-Route: "+k[l]+"\r\n";l=this.getHeaders("via");a=l.length;for(t;t<a;t++)r+="Via: "+l[t]+"\r\n";!this.to_tag&&100<c?w+=";tag="+b.Utils.newTag():this.to_tag&&!this.s("to").hasParam("tag")&&(w+=";tag="+this.to_tag);r=r+("To: "+w+"\r\n")+("From: "+this.getHeader("From")+"\r\n");r+="Call-ID: "+this.call_id+"\r\n";r+="CSeq: "+this.cseq+" "+this.method+
"\r\n";a=e.length;for(w=0;w<a;w++)r+=e[w].trim()+"\r\n";this.method===b.C.INVITE&&(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&v.push("gruu");this.ua.configuration.rel100===b.C.supported.SUPPORTED&&v.push("100rel");v.push("outbound");r+="Supported: "+v+"\r\n";f?(a=b.Utils.str_utf8_length(f),r+="Content-Type: application/sdp\r\n",r+="Content-Length: "+a+"\r\n\r\n",r+=f):r+="Content-Length: 0\r\n\r\n";this.server_transaction.receiveResponse(c,r,g,h);return r};f.prototype.reply_sl=function(c,
a){var e,f;e=0;var g=this.getHeaders("via"),h=g.length;c=c||null;a=a||null;if(!c||100>c||699<c)throw new TypeError("Invalid status_code: "+c);if(a&&"string"!==typeof a&&!(a instanceof String))throw new TypeError("Invalid reason_phrase: "+a);a=a||b.C.REASON_PHRASE[c]||"";f="SIP/2.0 "+c+" "+a+"\r\n";for(e;e<h;e++)f+="Via: "+g[e]+"\r\n";e=this.getHeader("To");!this.to_tag&&100<c?e+=";tag="+b.Utils.newTag():this.to_tag&&!this.s("to").hasParam("tag")&&(e+=";tag="+this.to_tag);f=f+("To: "+e+"\r\n")+("From: "+
this.getHeader("From")+"\r\n");f+="Call-ID: "+this.call_id+"\r\n";f+="CSeq: "+this.cseq+" "+this.method+"\r\n";f+="Content-Length: 0\r\n\r\n";this.transport.send(f)};c=function(b){this.logger=b.getLogger("sip.sipmessage");this.headers={};this.reason_phrase=this.status_code=null};c.prototype=new e;b.OutgoingRequest=g;b.IncomingRequest=f;b.IncomingResponse=c}},{}],164:[function(h,k,l){k.exports=function(b){function g(a){var c;a="SIP/2.0 "+a+" "+b.C.REASON_PHRASE[a]+"\r\n";c=f.getHeaders("via");var e=
c.length,g=0;for(g;g<e;g++)a+="Via: "+c[g]+"\r\n";c=f.getHeader("To");f.to_tag||(c+=";tag="+b.Utils.newTag());a=a+("To: "+c+"\r\n")+("From: "+f.getHeader("From")+"\r\n");a+="Call-ID: "+f.call_id+"\r\n";a+="CSeq: "+f.cseq+" "+f.method+"\r\n";a+="\r\n";d.send(a)}var e,f,c,d,a=[],m=[],h=[];a.push(function(){if(!f.ruri||"sip"!==f.ruri.scheme)return g(416),!1});a.push(function(){if(!f.to_tag&&f.call_id.substr(0,5)===c.configuration.sipjsId)return g(482),!1});a.push(function(){var a=b.Utils.str_utf8_length(f.body),
c=f.getHeader("content-length");if(a<c)return g(400),!1});a.push(function(){var a,d,e=f.from_tag,m=f.call_id,h=f.cseq;if(!f.to_tag)if(f.method===b.C.INVITE){if(a=c.transactions.ist[f.via_branch],!a)for(d in c.transactions.ist)if(a=c.transactions.ist[d],a.request.from_tag===e&&a.request.call_id===m&&a.request.cseq===h)return g(482),!1}else if(a=c.transactions.nist[f.via_branch],!a)for(d in c.transactions.nist)if(a=c.transactions.nist[d],a.request.from_tag===e&&a.request.call_id===m&&a.request.cseq===
h)return g(482),!1});m.push(function(){if(1<f.getHeaders("via").length)return e.warn("More than one Via header field present in the response. Dropping the response"),!1});m.push(function(){var a=b.Utils.str_utf8_length(f.body),c=f.getHeader("content-length");if(a<c)return e.warn("Message body length is lower than the value in Content-Length header field. Dropping the response"),!1});h.push(function(){for(var a=["from","to","call_id","cseq","via"],b=a.length;b--;)if(!f.hasHeader(a[b]))return e.warn("Missing mandatory header field : "+
a[b]+". Dropping the response"),!1});b.sanityCheck=function(g,k,l){f=g;c=k;d=l;e=c.getLogger("sip.sanitycheck");for(g=h.length;g--;)if(k=h[g](f),!1===k)return!1;if(f instanceof b.IncomingRequest)for(g=a.length;g--;){if(k=a[g](f),!1===k)return!1}else if(f instanceof b.IncomingResponse)for(g=m.length;g--;)if(k=m[g](f),!1===k)return!1;return!0}}},{}],165:[function(h,k,l){k.exports=function(b){var g;g=function(e,f){this.ua=e;this.logger=e.getLogger("sip.servercontext");this.request=f;this.transaction=
f.method===b.C.INVITE?new b.Transactions.InviteServerTransaction(f,e):new b.Transactions.NonInviteServerTransaction(f,e);f.body&&(this.body=f.body);f.hasHeader("Content-Type")&&(this.contentType=f.getHeader("Content-Type"));this.method=f.method;this.data={};this.localIdentity=f.to;this.remoteIdentity=f.from;this.initEvents(["progress","accepted","rejected","failed"])};g.prototype=new b.EventEmitter;g.prototype.progress=function(e){e=e||{};var f=e.statusCode||180,c=e.reasonPhrase||b.C.REASON_PHRASE[f],
d=(e.extraHeaders||[]).slice();e=e.body;if(100>f||199<f)throw new TypeError("Invalid statusCode: "+f);f=this.request.reply(f,c,d,e);this.emit("progress",f,c);return this};g.prototype.accept=function(e){e=e||{};var f=e.statusCode||200,c=e.reasonPhrase||b.C.REASON_PHRASE[f],d=(e.extraHeaders||[]).slice();e=e.body;if(200>f||299<f)throw new TypeError("Invalid statusCode: "+f);f=this.request.reply(f,c,d,e);this.emit("accepted",f,c);return this};g.prototype.reject=function(e){e=e||{};var f=e.statusCode||
480,c=e.reasonPhrase||b.C.REASON_PHRASE[f],d=(e.extraHeaders||[]).slice();e=e.body;if(300>f||699<f)throw new TypeError("Invalid statusCode: "+f);f=this.request.reply(f,c,d,e);this.emit("rejected",f,c);this.emit("failed",f,c);return this};g.prototype.reply=function(b){b=b||{};var f=b.statusCode,c=b.reasonPhrase,d=(b.extraHeaders||[]).slice();this.request.reply(f,c,d,b.body);return this};g.prototype.onRequestTimeout=function(){this.emit("failed",null,b.C.causes.REQUEST_TIMEOUT)};g.prototype.onTransportError=
function(){this.emit("failed",null,b.C.causes.CONNECTION_ERROR)};b.ServerContext=g}},{}],166:[function(h,k,l){k.exports=function(b,g,e){var f,c,d={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_PRACK:6,STATUS_WAITING_FOR_ACK:7,STATUS_CANCELED:8,STATUS_TERMINATED:9,STATUS_ANSWERED_WAITING_FOR_PRACK:10,STATUS_EARLY_MEDIA:11,STATUS_CONFIRMED:12};f=function(a){this.status=d.STATUS_NULL;this.dialog=null;
this.earlyDialogs={};this.mediaHandlerFactory=a||b.WebRTC.MediaHandler.defaultFactory;this.hasAnswer=this.hasOffer=!1;this.timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null,rel1xxTimer:null,prackTimer:null};this.tones=this.endTime=this.startTime=null;this.remote_hold=this.local_hold=!1;this.pending_actions={actions:[],length:function(){return this.actions.length},isPending:function(a){var b=0,c=this.actions.length;for(b;b<c;b++)if(this.actions[b].name===a)return!0;
return!1},shift:function(){return this.actions.shift()},push:function(a){this.actions.push({name:a})},pop:function(a){var b=0,c=this.actions.length;for(b;b<c;b++)this.actions[b].name===a&&(this.actions.splice(b,1),c--,b--)}};this.early_sdp=null;this.rel100=b.C.supported.UNSUPPORTED;this.initMoreEvents("connecting terminated dtmf invite cancel refer bye hold unhold muted unmuted".split(" "))};f.prototype={dtmf:function(a,c){var f=[],g=this;c=c||{};if(void 0===a)throw new TypeError("Not enough arguments");
if(this.status!==d.STATUS_CONFIRMED&&this.status!==d.STATUS_WAITING_FOR_ACK)throw new b.Exceptions.InvalidStateError(this.status);if(!a||"string"!==typeof a&&"number"!==typeof a||!a.toString().match(/^[0-9A-D#*,]+$/i))throw new TypeError("Invalid tones: "+a);for(a=a.toString().split("");0<a.length;)f.push(new e(this,a.shift(),c));if(this.tones)return this.tones=this.tones.concat(f),this;var h=function(){var a;if(g.status===d.STATUS_TERMINATED||!g.tones||0===g.tones.length)return g.tones=null,this;
a=g.tones.shift();a.on("failed",function(){g.tones=null});a.send(c);b.Timers.setTimeout(h,a.duration+a.interToneGap)};this.tones=f;h();return this},bye:function(a){a=a||{};var c=a.statusCode;if(this.status===d.STATUS_TERMINATED)return this.logger.error("Error: Attempted to send BYE in a terminated session."),this;this.logger.log("terminating Session");if(c&&(200>c||700<=c))throw new TypeError("Invalid statusCode: "+c);a.receiveResponse=function(){};return this.sendRequest(b.C.BYE,a).terminated()},
refer:function(a,c){c=c||{};var e=(c.extraHeaders||[]).slice(),f=a;if(void 0===a)throw new TypeError("Not enough arguments");if(a instanceof b.InviteServerContext||a instanceof b.InviteClientContext)e.push("Contact: "+this.contact),e.push("Allow: "+b.Utils.getAllowedMethods(this.ua)),e.push("Refer-To: <"+a.dialog.remote_target.toString()+"?Replaces="+a.dialog.id.call_id+"%3Bto-tag%3D"+a.dialog.id.remote_tag+"%3Bfrom-tag%3D"+a.dialog.id.local_tag+">");else{if(this.status!==d.STATUS_CONFIRMED)throw new b.Exceptions.InvalidStateError(this.status);
try{a=b.Grammar.parse(a,"Refer_To").uri||a}catch(g){this.logger.debug(".refer() cannot parse Refer_To from",a),this.logger.debug("...falling through to normalizeTarget()")}a=this.ua.normalizeTarget(a);if(!a)throw new TypeError("Invalid target: "+f);e.push("Contact: "+this.contact);e.push("Allow: "+b.Utils.getAllowedMethods(this.ua));e.push("Refer-To: "+a)}e.push("Allow-Events: refer");e.push("Event: refer;id="+Math.floor(1E3*Math.random()+1));this.sendRequest(b.C.REFER,{extraHeaders:e,body:c.body,
receiveResponse:c.receiveResponse||function(){}});return this},followRefer:function(a){return function(a,c){var d=c.parseHeader("refer-to").uri;d.scheme.match("^sips?$")?(b.Hacks.Chrome.getsConfusedAboutGUM(this),d=this.ua.invite(c.parseHeader("refer-to").uri,{media:this.mediaHint}),a.call(this,c,d),this.terminate()):(d=d.toString(),"undefined"!==typeof g&&"function"===typeof g.open?g.open(d):this.logger.warn("referred to non-SIP URI but window.open isn't a function: "+d))}.bind(this,a)},sendRequest:function(a,
c){c=c||{};var d=this,e=new b.OutgoingRequest(a,this.dialog.remote_target,this.ua,{cseq:c.cseq||(this.dialog.local_seqnum+=1),call_id:this.dialog.id.call_id,from_uri:this.dialog.local_uri,from_tag:this.dialog.id.local_tag,to_uri:this.dialog.remote_uri,to_tag:this.dialog.id.remote_tag,route_set:this.dialog.route_set,statusCode:c.statusCode,reasonPhrase:c.reasonPhrase},c.extraHeaders||[],c.body);(new b.RequestSender({request:e,onRequestTimeout:function(){d.onRequestTimeout()},onTransportError:function(){d.onTransportError()},
receiveResponse:c.receiveResponse||function(a){d.receiveNonInviteResponse(a)}},this.ua)).send();this.checkEvent(a.toLowerCase())&&this.emit(a.toLowerCase(),e);return this},close:function(){var a;if(this.status===d.STATUS_TERMINATED)return this;this.logger.log("closing INVITE session "+this.id);this.mediaHandler&&this.mediaHandler.close();for(a in this.timers)b.Timers.clearTimeout(this.timers[a]);this.dialog&&(this.dialog.terminate(),delete this.dialog);for(a in this.earlyDialogs)this.earlyDialogs[a].terminate(),
delete this.earlyDialogs[a];this.status=d.STATUS_TERMINATED;delete this.ua.sessions[this.id];return this},createDialog:function(a,c,d){var e,f=a.call_id+a["UAS"===c?"to_tag":"from_tag"]+a["UAS"===c?"from_tag":"to_tag"];e=this.earlyDialogs[f];if(d){if(e)return!0;e=new b.Dialog(this,a,c,b.Dialog.C.STATUS_EARLY);if(e.error)return this.logger.error(e.error),this.failed(a,b.C.causes.INTERNAL_ERROR),!1;this.earlyDialogs[f]=e;return!0}if(e){e.update(a,c);this.dialog=e;delete this.earlyDialogs[f];for(var g in this.earlyDialogs)this.earlyDialogs[g].terminate(),
delete this.earlyDialogs[g];return!0}c=new b.Dialog(this,a,c);if(c.error)return this.logger.error(c.error),this.failed(a,b.C.causes.INTERNAL_ERROR),!1;this.to_tag=a.to_tag;this.dialog=c;return!0},isReadyToReinvite:function(){return this.mediaHandler.isReady()&&!this.dialog.uac_pending_reply&&!this.dialog.uas_pending_reply},mute:function(a){if(a=this.mediaHandler.mute(a))this.onmute(a)},unmute:function(a){if(a=this.mediaHandler.unmute(a))this.onunmute(a)},hold:function(){if(this.status!==d.STATUS_WAITING_FOR_ACK&&
this.status!==d.STATUS_CONFIRMED)throw new b.Exceptions.InvalidStateError(this.status);this.mediaHandler.hold();this.isReadyToReinvite()?!0!==this.local_hold&&(this.onhold("local"),this.sendReinvite({mangle:function(a){/a=(sendrecv|sendonly|recvonly|inactive)/.test(a)?(a=a.replace(/a=sendrecv\r\n/g,"a=sendonly\r\n"),a=a.replace(/a=recvonly\r\n/g,"a=inactive\r\n")):a=a.replace(/(m=[^\r]*\r\n)/g,"$1a=sendonly\r\n");return a}})):this.pending_actions.isPending("unhold")?this.pending_actions.pop("unhold"):
this.pending_actions.isPending("hold")||this.pending_actions.push("hold")},unhold:function(){if(this.status!==d.STATUS_WAITING_FOR_ACK&&this.status!==d.STATUS_CONFIRMED)throw new b.Exceptions.InvalidStateError(this.status);this.mediaHandler.unhold();this.isReadyToReinvite()?!1!==this.local_hold&&(this.onunhold("local"),this.sendReinvite()):this.pending_actions.isPending("hold")?this.pending_actions.pop("hold"):this.pending_actions.isPending("unhold")||this.pending_actions.push("unhold")},isOnHold:function(){return{local:this.local_hold,
remote:this.remote_hold}},receiveReinvite:function(a){var b=this,c=a.getHeader("Content-Type"),e=!0;a.body&&("application/sdp"!==c?(this.logger.warn("invalid Content-Type"),a.reply(415)):(e=/a=(sendonly|inactive)/.test(a.body),this.mediaHandler.setDescription(a.body,function(){b.mediaHandler.getDescription(function(c){a.reply(200,null,["Contact: "+b.contact],c,function(){b.status=d.STATUS_WAITING_FOR_ACK;b.setInvite2xxTimer(a,c);b.setACKTimer();if(b.remote_hold&&!e)b.onunhold("remote");else if(!b.remote_hold&&
e)b.onhold("remote")})},function(){a.reply(500)},b.mediaHint)},function(c){b.logger.error(c);a.reply(488)})))},sendReinvite:function(a){a=a||{};var c=this,e=(a.extraHeaders||[]).slice(),f=a.eventHandlers||{},g=a.mangle||null;this.reinviteSucceeded=f.succeeded?f.succeeded:function(){b.Timers.clearTimeout(c.timers.ackTimer);b.Timers.clearTimeout(c.timers.invite2xxTimer);c.status=d.STATUS_CONFIRMED};this.reinviteFailed=f.failed?f.failed:function(){};e.push("Contact: "+this.contact);e.push("Allow: "+
b.Utils.getAllowedMethods(this.ua));e.push("Content-Type: application/sdp");this.receiveResponse=this.receiveReinviteResponse;this.mediaHandler.getDescription(function(a){g&&(a=g(a));c.dialog.sendRequest(c,b.C.INVITE,{extraHeaders:e,body:a})},function(){if(c.isReadyToReinvite())c.onReadyToReinvite();c.reinviteFailed()},c.mediaHint)},receiveRequest:function(a){switch(a.method){case b.C.BYE:a.reply(200);this.status===d.STATUS_CONFIRMED&&(this.emit("bye",a),this.terminated(a,b.C.causes.BYE));break;case b.C.INVITE:this.status===
d.STATUS_CONFIRMED&&(this.logger.log("re-INVITE received"),this.receiveReinvite(a));break;case b.C.INFO:if(this.status===d.STATUS_CONFIRMED||this.status===d.STATUS_WAITING_FOR_ACK){var c,f,g;c=a.getHeader("content-type");var h=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,k=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;c&&(c.match(/^application\/dtmf-relay/i)?(a.body&&(c=a.body.split("\r\n",2),2===c.length&&(h.test(c[0])&&(f=c[0].replace(h,"$2")),k.test(c[1])&&(g=parseInt(c[1].replace(k,"$2"),10)))),(new e(this,
f,{duration:g})).init_incoming(a)):a.reply(415,null,["Accept: application/dtmf-relay"]))}break;case b.C.REFER:this.status===d.STATUS_CONFIRMED&&(this.logger.log("REFER received"),a.reply(202,"Accepted"),f=this.checkListener("refer"),this.sendRequest(b.C.NOTIFY,{extraHeaders:["Event: refer","Subscription-State: terminated","Content-Type: message/sipfrag"],body:f?"SIP/2.0 100 Trying":"SIP/2.0 603 Declined",receiveResponse:function(){}}),f&&this.emit("refer",a));break;case b.C.NOTIFY:a.reply(200,"OK")}},
receiveReinviteResponse:function(a){var c=this,e=a.getHeader("Content-Type");if(this.status!==d.STATUS_TERMINATED)switch(!0){case /^1[0-9]{2}$/.test(a.status_code):break;case /^2[0-9]{2}$/.test(a.status_code):this.status=d.STATUS_CONFIRMED;this.sendRequest(b.C.ACK,{cseq:a.cseq});if(!a.body){this.reinviteFailed();break}else if("application/sdp"!==e){this.reinviteFailed();break}this.mediaHandler.setDescription(a.body,function(){c.reinviteSucceeded()},function(){c.reinviteFailed()});break;default:this.reinviteFailed()}},
acceptAndTerminate:function(a,c,d){var e=[];c&&(d=d||b.C.REASON_PHRASE[c]||"",e.push("Reason: SIP ;cause="+c+'; text="'+d+'"'));if(this.dialog||this.createDialog(a,"UAC"))this.sendRequest(b.C.ACK,{cseq:a.cseq}),this.sendRequest(b.C.BYE,{extraHeaders:e});return this},setInvite2xxTimer:function(a,c){var e=this,f=b.Timers.T1;this.timers.invite2xxTimer=b.Timers.setTimeout(function A(){e.status===d.STATUS_WAITING_FOR_ACK&&(e.logger.log("no ACK received, attempting to retransmit OK"),a.reply(200,null,["Contact: "+
e.contact],c),f=Math.min(2*f,b.Timers.T2),e.timers.invite2xxTimer=b.Timers.setTimeout(A,f))},f)},setACKTimer:function(){var a=this;this.timers.ackTimer=b.Timers.setTimeout(function(){a.status===d.STATUS_WAITING_FOR_ACK&&(a.logger.log("no ACK received for an extended period of time, terminating the call"),b.Timers.clearTimeout(a.timers.invite2xxTimer),a.sendRequest(b.C.BYE),a.terminated(null,b.C.causes.NO_ACK))},b.Timers.TIMER_H)},onReadyToReinvite:function(){var a=this.pending_actions.shift();if(a&&
this[a.name])this[a.name]()},onTransportError:function(){this.status===d.STATUS_CONFIRMED?this.terminated(null,b.C.causes.CONNECTION_ERROR):this.status!==d.STATUS_TERMINATED&&this.failed(null,b.C.causes.CONNECTION_ERROR)},onRequestTimeout:function(){this.status===d.STATUS_CONFIRMED?this.terminated(null,b.C.causes.REQUEST_TIMEOUT):this.status!==d.STATUS_TERMINATED&&this.failed(null,b.C.causes.REQUEST_TIMEOUT)},onDialogError:function(a){this.status===d.STATUS_CONFIRMED?this.terminated(a,b.C.causes.DIALOG_ERROR):
this.status!==d.STATUS_TERMINATED&&this.failed(a,b.C.causes.DIALOG_ERROR)},onhold:function(a){this["local"===a?"local_hold":"remote_hold"]=!0;this.emit("hold",{originator:a})},onunhold:function(a){this["local"===a?"local_hold":"remote_hold"]=!1;this.emit("unhold",{originator:a})},onmute:function(a){this.emit("muted",{audio:a.audio,video:a.video})},onunmute:function(a){this.emit("unmuted",{audio:a.audio,video:a.video})},failed:function(a,b){this.close();return this.emit("failed",a,b)},rejected:function(a,
b){this.close();return this.emit("rejected",a||null,b)},canceled:function(){this.close();return this.emit("cancel")},accepted:function(a,c){c=c||a&&b.C.REASON_PHRASE[a.status_code]||"";this.startTime=new Date;return this.emit("accepted",a,c)},terminated:function(a,b){this.endTime=new Date;this.close();return this.emit("terminated",{message:a||null,cause:b||null})},connecting:function(a){return this.emit("connecting",{request:a})}};f.C=d;b.Session=f;c=function(a,c){function e(a,b){c.hasHeader(a)&&
0<=c.getHeader(a).toLowerCase().indexOf("100rel")&&(h.rel100=b)}function f(){var a={extraHeaders:["Contact: "+h.contact]};h.rel100!==b.C.supported.REQUIRED&&h.progress(a);h.status=d.STATUS_WAITING_FOR_ANSWER;h.timers.userNoAnswerTimer=b.Timers.setTimeout(function(){c.reply(408);h.failed(c,b.C.causes.NO_ANSWER)},h.ua.configuration.noAnswerTimeout);g&&(h.timers.expiresTimer=b.Timers.setTimeout(function(){h.status===d.STATUS_WAITING_FOR_ANSWER&&(c.reply(487),h.failed(c,b.C.causes.EXPIRES))},g));h.emit("invite",
c)}var g,h=this,k=c.getHeader("Content-Type"),l=c.parseHeader("Content-Disposition");if(!l&&"application/sdp"!==k||l&&"render"===l.type)this.renderbody=c.body,this.rendertype=k;else if("application/sdp"!==k&&l&&"session"===l.type){c.reply(415);return}b.Hacks.Firefox.cannotHandleExtraWhitespace(c);b.Hacks.AllBrowsers.maskDtls(c);b.Utils.augment(this,b.ServerContext,[a,c]);b.Utils.augment(this,b.Session,[a.configuration.mediaHandlerFactory]);this.status=d.STATUS_INVITE_RECEIVED;this.from_tag=c.from_tag;
this.id=c.call_id+this.from_tag;this.request=c;this.contact=this.ua.contact.toString();this.receiveNonInviteResponse=function(){};this.logger=a.getLogger("sip.inviteservercontext",this.id);this.ua.sessions[this.id]=this;c.hasHeader("expires")&&(g=1E3*c.getHeader("expires"));e("require",b.C.supported.REQUIRED);e("supported",b.C.supported.SUPPORTED);c.to_tag=b.Utils.newTag();this.createDialog(c,"UAS",!0)?((this.mediaHandler=this.mediaHandlerFactory(this,{RTCConstraints:{optional:[{DtlsSrtpKeyAgreement:"true"}]}}))&&
this.mediaHandler.getRemoteStreams&&(this.getRemoteStreams=this.mediaHandler.getRemoteStreams.bind(this.mediaHandler),this.getLocalStreams=this.mediaHandler.getLocalStreams.bind(this.mediaHandler)),!c.body||this.renderbody?b.Timers.setTimeout(f,0):(this.hasOffer=!0,this.mediaHandler.setDescription(c.body,f,function(a){h.logger.warn("invalid SDP");h.logger.warn(a);c.reply(488)}))):c.reply(500,"Missing Contact header field")};c.prototype={reject:function(a){if(this.status===d.STATUS_TERMINATED)throw new b.Exceptions.InvalidStateError(this.status);
this.logger.log("rejecting RTCSession");b.ServerContext.prototype.reject.apply(this,[a]);return this.terminated()},terminate:function(a){a=a||{};var c=(a.extraHeaders||[]).slice(),e=a.body,f,g=this;this.status===d.STATUS_WAITING_FOR_ACK&&this.request.server_transaction.state!==b.Transactions.C.STATUS_TERMINATED?(f=this.dialog,this.receiveRequest=function(a){a.method===b.C.ACK&&(this.request(b.C.BYE,{extraHeaders:c,body:e}),f.terminate())},this.request.server_transaction.on("stateChanged",function(){this.state===
b.Transactions.C.STATUS_TERMINATED&&(this.request=new b.OutgoingRequest(b.C.BYE,this.dialog.remote_target,this.ua,{cseq:this.dialog.local_seqnum+=1,call_id:this.dialog.id.call_id,from_uri:this.dialog.local_uri,from_tag:this.dialog.id.local_tag,to_uri:this.dialog.remote_uri,to_tag:this.dialog.id.remote_tag,route_set:this.dialog.route_set},c,e),(new b.RequestSender({request:this.request,onRequestTimeout:function(){g.onRequestTimeout()},onTransportError:function(){g.onTransportError()},receiveResponse:function(){}},
this.ua)).send(),f.terminate())}),this.emit("bye",this.request),this.terminated(),this.dialog=f,this.ua.dialogs[f.id.toString()]=f):this.status===d.STATUS_CONFIRMED?this.bye(a):this.reject(a);return this},progress:function(a){function c(){f=a.statusCode||183;this.status=d.STATUS_WAITING_FOR_PRACK;h.push("Contact: "+this.contact);h.push("Require: 100rel");h.push("RSeq: "+Math.floor(1E4*Math.random()));this.mediaHint=a.media;this.mediaHandler.getDescription(function(a){if(!this.isCanceled&&this.status!==
d.STATUS_TERMINATED){this.early_sdp=a;this[this.hasOffer?"hasAnswer":"hasOffer"]=!0;var c=b.Timers.T1;this.timers.rel1xxTimer=b.Timers.setTimeout(function u(){this.request.reply(f,null,h,a);c*=2;this.timers.rel1xxTimer=b.Timers.setTimeout(u.bind(this),c)}.bind(this),c);this.timers.prackTimer=b.Timers.setTimeout(function(){this.status===d.STATUS_WAITING_FOR_PRACK&&(this.logger.log("no PRACK received, rejecting the call"),b.Timers.clearTimeout(this.timers.rel1xxTimer),this.request.reply(504),this.terminated(null,
b.C.causes.NO_PRACK))}.bind(this),64*b.Timers.T1);l=this.request.reply(f,g,h,a);this.emit("progress",l,g)}}.bind(this),function(){this.failed(null,b.C.causes.WEBRTC_ERROR)}.bind(this),a.media)}function e(){l=this.request.reply(f,g,h,k);this.emit("progress",l,g)}a=a||{};var f=a.statusCode||180,g=a.reasonPhrase,h=(a.extraHeaders||[]).slice(),k=a.body,l;if(100>f||199<f)throw new TypeError("Invalid statusCode: "+f);if(this.isCanceled||this.status===d.STATUS_TERMINATED)return this;100!==a.statusCode&&
(this.rel100===b.C.supported.REQUIRED||this.rel100===b.C.supported.SUPPORTED&&a.rel100||this.rel100===b.C.supported.SUPPORTED&&this.ua.configuration.rel100===b.C.supported.REQUIRED)?c.apply(this):e.apply(this);return this},accept:function(a){a=a||{};a=b.Utils.desugarSessionOptions(a);b.Utils.optionsOverride(a,"media","mediaConstraints",!0,this.logger,this.ua.configuration.media);this.mediaHint=a.media;var c=this,e=this.request,f=(a.extraHeaders||[]).slice();a=function(a){var g;c.mediaHandler.render();
f.push("Contact: "+c.contact);c.hasOffer?c.hasAnswer=!0:c.hasOffer=!0;g=e.reply(200,null,f,a,function(){c.status=d.STATUS_WAITING_FOR_ACK;c.setInvite2xxTimer(e,a);c.setACKTimer()},function(){c.failed(null,b.C.causes.CONNECTION_ERROR)});c.status!==d.STATUS_TERMINATED&&c.accepted(g,b.C.REASON_PHRASE[200])};var g=function(){c.status!==d.STATUS_TERMINATED&&c.failed(null,b.C.causes.WEBRTC_ERROR)};if(this.status===d.STATUS_WAITING_FOR_PRACK)return this.status=d.STATUS_ANSWERED_WAITING_FOR_PRACK,this;if(this.status===
d.STATUS_WAITING_FOR_ANSWER)this.status=d.STATUS_ANSWERED;else if(this.status!==d.STATUS_EARLY_MEDIA)throw new b.Exceptions.InvalidStateError(this.status);if(!this.createDialog(e,"UAS"))return e.reply(500,"Missing Contact header field"),this;b.Timers.clearTimeout(this.timers.userNoAnswerTimer);this.status===d.STATUS_EARLY_MEDIA?a():this.mediaHandler.getDescription(a,g,c.mediaHint);return this},receiveRequest:function(a){function c(){var e;b.Timers.clearTimeout(this.timers.ackTimer);b.Timers.clearTimeout(this.timers.invite2xxTimer);
this.status=d.STATUS_CONFIRMED;this.unmute();e=a.getHeader("Content-Type");"application/sdp"!==e&&(this.renderbody=a.body,this.rendertype=e)}switch(a.method){case b.C.CANCEL:if(this.status===d.STATUS_WAITING_FOR_ANSWER||this.status===d.STATUS_WAITING_FOR_PRACK||this.status===d.STATUS_ANSWERED_WAITING_FOR_PRACK||this.status===d.STATUS_EARLY_MEDIA||this.status===d.STATUS_ANSWERED)this.status=d.STATUS_CANCELED,this.request.reply(487),this.canceled(a),this.rejected(a,b.C.causes.CANCELED),this.failed(a,
b.C.causes.CANCELED);break;case b.C.ACK:this.status===d.STATUS_WAITING_FOR_ACK&&(this.hasAnswer?c.apply(this):a.body&&"application/sdp"===a.getHeader("content-type")?(b.Hacks.Firefox.cannotHandleExtraWhitespace(a),b.Hacks.AllBrowsers.maskDtls(a),this.hasAnswer=!0,this.mediaHandler.setDescription(a.body,c.bind(this),function(c){this.logger.warn(c);this.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});this.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION)}.bind(this))):this.early_sdp?c.apply(this):
this.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION));break;case b.C.PRACK:this.status===d.STATUS_WAITING_FOR_PRACK||this.status===d.STATUS_ANSWERED_WAITING_FOR_PRACK?this.hasAnswer?(b.Timers.clearTimeout(this.timers.rel1xxTimer),b.Timers.clearTimeout(this.timers.prackTimer),a.reply(200),this.status===d.STATUS_ANSWERED_WAITING_FOR_PRACK&&(this.status=d.STATUS_EARLY_MEDIA,this.accept()),this.status=d.STATUS_EARLY_MEDIA,this.mute()):a.body&&"application/sdp"===a.getHeader("content-type")?(this.hasAnswer=
!0,this.mediaHandler.setDescription(a.body,function(){b.Timers.clearTimeout(this.timers.rel1xxTimer);b.Timers.clearTimeout(this.timers.prackTimer);a.reply(200);this.status===d.STATUS_ANSWERED_WAITING_FOR_PRACK&&(this.status=d.STATUS_EARLY_MEDIA,this.accept());this.status=d.STATUS_EARLY_MEDIA;this.mute()}.bind(this),function(c){this.logger.warn(c);this.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});this.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION)}.bind(this))):(this.terminate({statusCode:"488",
reasonPhrase:"Bad Media Description"}),this.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION)):this.status===d.STATUS_EARLY_MEDIA&&a.reply(200);break;default:f.prototype.receiveRequest.apply(this,[a])}}};b.InviteServerContext=c;c=function(a,c,e){e=e||{};var f,g=(e.extraHeaders||[]).slice(),h=e.stunServers||null,k=e.turnServers||null;if((f=a.configuration.mediaHandlerFactory.isSupported)&&!f())throw new b.Exceptions.NotSupportedError("Media not supported");this.RTCConstraints=e.RTCConstraints||{};this.inviteWithoutSdp=
e.inviteWithoutSdp||!1;this.anonymous=e.anonymous||!1;this.renderbody=e.renderbody||null;this.rendertype=e.rendertype||"text/plain";f={from_tag:this.from_tag};this.contact=a.contact.toString({anonymous:this.anonymous,outbound:this.anonymous?!a.contact.temp_gruu:!a.contact.pub_gruu});this.anonymous&&(f.from_displayName="Anonymous",f.from_uri="sip:anonymous@anonymous.invalid",g.push("P-Preferred-Identity: "+a.configuration.uri.toString()),g.push("Privacy: id"));g.push("Contact: "+this.contact);g.push("Allow: "+
b.Utils.getAllowedMethods(a));this.inviteWithoutSdp?this.renderbody&&(g.push("Content-Type: "+this.rendertype),g.push("Content-Disposition: render;handling=optional")):g.push("Content-Type: application/sdp");a.configuration.rel100===b.C.supported.REQUIRED&&g.push("Require: 100rel");e.extraHeaders=g;e.params=f;b.Utils.augment(this,b.ClientContext,[a,b.C.INVITE,c,e]);b.Utils.augment(this,b.Session,[a.configuration.mediaHandlerFactory]);if(this.status!==d.STATUS_NULL)throw new b.Exceptions.InvalidStateError(this.status);
this.from_tag=b.Utils.newTag();this.received_100=this.isCanceled=!1;this.method=b.C.INVITE;this.receiveNonInviteResponse=this.receiveResponse;this.receiveResponse=this.receiveInviteResponse;this.logger=a.getLogger("sip.inviteclientcontext");if(h)if(c=b.UA.configuration_check.optional.stunServers(h))this.stunServers=c;else throw new TypeError("Invalid stunServers: "+h);if(k)if(c=b.UA.configuration_check.optional.turnServers(k))this.turnServers=c;else throw new TypeError("Invalid turnServers: "+k);
a.applicants[this]=this;this.id=this.request.call_id+this.from_tag;(this.mediaHandler=this.mediaHandlerFactory(this,{RTCConstraints:this.RTCConstraints,stunServers:this.stunServers,turnServers:this.turnServers}))&&this.mediaHandler.getRemoteStreams&&(this.getRemoteStreams=this.mediaHandler.getRemoteStreams.bind(this.mediaHandler),this.getLocalStreams=this.mediaHandler.getLocalStreams.bind(this.mediaHandler))};c.prototype={invite:function(a){var c=this;a=a||{};b.Utils.optionsOverride(a,"media","mediaConstraints",
!0,this.logger,this.ua.configuration.media);this.mediaHint=a.media;this.ua.sessions[this.id]=this;this.inviteWithoutSdp?(this.request.body=c.renderbody,this.status=d.STATUS_INVITE_SENT,this.send()):this.mediaHandler.getDescription(function(a){c.isCanceled||c.status===d.STATUS_TERMINATED||(c.hasOffer=!0,c.request.body=a,c.status=d.STATUS_INVITE_SENT,c.send())},function(){c.status!==d.STATUS_TERMINATED&&c.failed(null,b.C.causes.WEBRTC_ERROR)},c.mediaHint);return this},receiveInviteResponse:function(a){var c,
e=this,f=a.call_id+a.from_tag+a.to_tag,g=[];c={};if(this.status!==d.STATUS_TERMINATED&&a.method===b.C.INVITE){if(this.dialog&&200<=a.status_code&&299>=a.status_code){if(f!==this.dialog.id.toString()){if(!this.createDialog(a,"UAC",!0))return;this.earlyDialogs[f].sendRequest(this,b.C.ACK,{body:b.Utils.generateFakeSDP(a.body)});this.earlyDialogs[f].sendRequest(this,b.C.BYE);this.status!==d.STATUS_CONFIRMED&&this.failed(a,b.C.causes.WEBRTC_ERROR);return}if(this.status===d.STATUS_CONFIRMED){this.sendRequest(b.C.ACK,
{cseq:a.cseq});return}if(!this.hasAnswer)return}if(this.dialog&&200>a.status_code){if(this.earlyDialogs[f]||this.createDialog(a,"UAC",!0))g.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq")),this.earlyDialogs[f].pracked.push(a.getHeader("rseq")),this.earlyDialogs[f].sendRequest(this,b.C.PRACK,{extraHeaders:g,body:b.Utils.generateFakeSDP(a.body)})}else if(this.isCanceled)100<=a.status_code&&200>a.status_code?(this.request.cancel(this.cancelReason),this.canceled(null)):200<=a.status_code&&299>
a.status_code&&(this.acceptAndTerminate(a),this.emit("bye",this.request));else switch(!0){case /^100$/.test(a.status_code):this.received_100=!0;break;case /^1[0-9]{2}$/.test(a.status_code):if(!a.to_tag){this.logger.warn("1xx response received without to tag");break}if(a.hasHeader("contact")&&!this.createDialog(a,"UAC",!0))break;this.status=d.STATUS_1XX_RECEIVED;if(a.hasHeader("require")&&-1!==a.getHeader("require").indexOf("100rel")){if(this.dialog||!this.earlyDialogs[f])break;if(-1!==this.earlyDialogs[f].pracked.indexOf(a.getHeader("rseq"))||
this.earlyDialogs[f].pracked[this.earlyDialogs[f].pracked.length-1]>=a.getHeader("rseq")&&0<this.earlyDialogs[f].pracked.length)break;b.Hacks.Firefox.cannotHandleExtraWhitespace(a);b.Hacks.AllBrowsers.maskDtls(a);if(a.body)if(this.hasOffer){if(!this.createDialog(a,"UAC"))break;this.hasAnswer=!0;this.mediaHandler.setDescription(a.body,function(){g.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq"));e.dialog.pracked.push(a.getHeader("rseq"));e.sendRequest(b.C.PRACK,{extraHeaders:g,receiveResponse:function(){}});
e.status=d.STATUS_EARLY_MEDIA;e.mute();e.emit("progress",a)},function(c){e.logger.warn(c);e.acceptAndTerminate(a,488,"Not Acceptable Here");e.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION)})}else this.earlyDialogs[f].pracked.push(a.getHeader("rseq")),this.earlyDialogs[f].mediaHandler.setDescription(a.body,function(){e.earlyDialogs[f].mediaHandler.getDescription(function(c){g.push("Content-Type: application/sdp");g.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq"));e.earlyDialogs[f].sendRequest(e,
b.C.PRACK,{extraHeaders:g,body:c});e.status=d.STATUS_EARLY_MEDIA;e.emit("progress",a)},function(){e.earlyDialogs[f].pracked.push(a.getHeader("rseq"));e.status!==d.STATUS_TERMINATED&&e.failed(null,b.C.causes.WEBRTC_ERROR)},e.mediaHint)},function(b){e.earlyDialogs[f].pracked.splice(e.earlyDialogs[f].pracked.indexOf(a.getHeader("rseq")),1);e.logger.warn("invalid SDP");e.logger.warn(b)});else g.push("RAck: "+a.getHeader("rseq")+" "+a.getHeader("cseq")),this.earlyDialogs[f].pracked.push(a.getHeader("rseq")),
this.earlyDialogs[f].sendRequest(this,b.C.PRACK,{extraHeaders:g}),this.emit("progress",a)}else this.emit("progress",a);break;case /^2[0-9]{2}$/.test(a.status_code):if(this.request.cseq+" "+this.request.method!==a.getHeader("cseq"))break;if(this.status===d.STATUS_EARLY_MEDIA&&this.dialog){this.status=d.STATUS_CONFIRMED;this.unmute();c={};this.renderbody&&(g.push("Content-Type: "+this.rendertype),c.extraHeaders=g,c.body=this.renderbody);c.cseq=a.cseq;this.sendRequest(b.C.ACK,c);this.accepted(a);break}if(this.dialog)break;
b.Hacks.Firefox.cannotHandleExtraWhitespace(a);b.Hacks.AllBrowsers.maskDtls(a);if(this.hasOffer)if(this.hasAnswer)this.renderbody&&(g.push("Content-Type: "+e.rendertype),c.extraHeaders=g,c.body=this.renderbody),this.sendRequest(b.C.ACK,c);else{if(!a.body){this.acceptAndTerminate(a,400,"Missing session description");this.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(a,"UAC"))break;this.hasAnswer=!0;this.mediaHandler.setDescription(a.body,function(){var c={};e.status=d.STATUS_CONFIRMED;
e.unmute();e.renderbody&&(g.push("Content-Type: "+e.rendertype),c.extraHeaders=g,c.body=e.renderbody);c.cseq=a.cseq;e.sendRequest(b.C.ACK,c);e.accepted(a)},function(c){e.logger.warn(c);e.acceptAndTerminate(a,488,"Not Acceptable Here");e.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION)})}else if(this.earlyDialogs[f]&&this.earlyDialogs[f].mediaHandler.localMedia){this.hasAnswer=this.hasOffer=!0;this.mediaHandler=this.earlyDialogs[f].mediaHandler;if(!this.createDialog(a,"UAC"))break;this.status=d.STATUS_CONFIRMED;
this.sendRequest(b.C.ACK,{cseq:a.cseq});this.unmute();this.accepted(a)}else{if(!a.body){this.acceptAndTerminate(a,400,"Missing session description");this.failed(a,b.C.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(a,"UAC"))break;this.hasOffer=!0;this.mediaHandler.setDescription(a.body,function(){e.mediaHandler.getDescription(function(c){e.isCanceled||e.status===d.STATUS_TERMINATED||(c=b.Hacks.Firefox.hasMissingCLineInSDP(c),e.status=d.STATUS_CONFIRMED,e.hasAnswer=!0,e.unmute(),e.sendRequest(b.C.ACK,
{body:c,extraHeaders:["Content-Type: application/sdp"],cseq:a.cseq}),e.accepted(a))},function(){e.logger.warn("there was a problem")},e.mediaHint)},function(b){e.logger.warn("invalid SDP");e.logger.warn(b);a.reply(488)})}break;default:c=b.Utils.sipErrorCause(a.status_code),this.failed(a,c),this.rejected(a,c)}}},cancel:function(a){a=a||{};var c=a.status_code;a=a.reasonPhrase;var e;if(this.status===d.STATUS_TERMINATED)throw new b.Exceptions.InvalidStateError(this.status);this.logger.log("canceling RTCSession");
if(c&&(200>c||700<=c))throw new TypeError("Invalid status_code: "+c);c&&(a=a||b.C.REASON_PHRASE[c]||"",e="SIP ;cause="+c+' ;text="'+a+'"');this.request.cancel(e);return this.canceled()},terminate:function(a){if(this.status===d.STATUS_TERMINATED)return this;this.status===d.STATUS_WAITING_FOR_ACK||this.status===d.STATUS_CONFIRMED?this.bye(a):this.cancel(a);return this.terminated()},receiveRequest:function(a){a.method===b.C.ACK&&this.status===d.STATUS_WAITING_FOR_ACK&&(b.Timers.clearTimeout(this.timers.ackTimer),
b.Timers.clearTimeout(this.timers.invite2xxTimer),this.status=d.STATUS_CONFIRMED,this.unmute(),this.accepted());return f.prototype.receiveRequest.apply(this,[a])}};b.InviteClientContext=c}},{}],167:[function(h,k,l){k.exports=function(b){var g;g=function(e,f,c){if(void 0===f)throw new TypeError("Not enough arguments");this.logger=e.ua.getLogger("sip.invitecontext.dtmf",e.id);this.owner=e;this.direction=null;c=c||{};e=c.duration||null;c=c.interToneGap||null;if("string"===typeof f)f=f.toUpperCase();
else if("number"===typeof f)f=f.toString();else throw new TypeError("Invalid tone: "+f);if(f.match(/^[0-9A-D#*]$/))this.tone=f;else throw new TypeError("Invalid tone: "+f);if(e&&!b.Utils.isDecimal(e))throw new TypeError("Invalid tone duration: "+e);e?e<g.C.MIN_DURATION?(this.logger.warn('"duration" value is lower than the minimum allowed, setting it to '+g.C.MIN_DURATION+" milliseconds"),e=g.C.MIN_DURATION):e>g.C.MAX_DURATION?(this.logger.warn('"duration" value is greater than the maximum allowed, setting it to '+
g.C.MAX_DURATION+" milliseconds"),e=g.C.MAX_DURATION):e=Math.abs(e):e=g.C.DEFAULT_DURATION;this.duration=e;if(c&&!b.Utils.isDecimal(c))throw new TypeError("Invalid interToneGap: "+c);c?c<g.C.MIN_INTER_TONE_GAP?(this.logger.warn('"interToneGap" value is lower than the minimum allowed, setting it to '+g.C.MIN_INTER_TONE_GAP+" milliseconds"),c=g.C.MIN_INTER_TONE_GAP):c=Math.abs(c):c=g.C.DEFAULT_INTER_TONE_GAP;this.interToneGap=c;this.initEvents(["succeeded","failed"])};g.prototype=new b.EventEmitter;
g.prototype.send=function(e){var f;this.direction="outgoing";if(this.owner.status!==b.Session.C.STATUS_CONFIRMED&&this.owner.status!==b.Session.C.STATUS_WAITING_FOR_ACK)throw new b.Exceptions.InvalidStateError(this.owner.status);e=e||{};e=e.extraHeaders?e.extraHeaders.slice():[];e.push("Content-Type: application/dtmf-relay");f="Signal= "+this.tone+"\r\n";f+="Duration= "+this.duration;this.request=this.owner.dialog.sendRequest(this,b.C.INFO,{extraHeaders:e,body:f});this.owner.emit("dtmf",this.request,
this)};g.prototype.receiveResponse=function(e){var f;switch(!0){case /^1[0-9]{2}$/.test(e.status_code):break;case /^2[0-9]{2}$/.test(e.status_code):this.emit("succeeded",{originator:"remote",response:e});break;default:f=b.Utils.sipErrorCause(e.status_code),this.emit("failed",e,f)}};g.prototype.onRequestTimeout=function(){this.emit("failed",null,b.C.causes.REQUEST_TIMEOUT);this.owner.onRequestTimeout()};g.prototype.onTransportError=function(){this.emit("failed",null,b.C.causes.CONNECTION_ERROR);this.owner.onTransportError()};
g.prototype.onDialogError=function(e){this.emit("failed",e,b.C.causes.DIALOG_ERROR);this.owner.onDialogError(e)};g.prototype.init_incoming=function(b){this.direction="incoming";this.request=b;b.reply(200);this.tone&&this.duration?this.owner.emit("dtmf",b,this):this.logger.warn("invalid INFO DTMF received, discarded")};g.C={MIN_DURATION:70,MAX_DURATION:6E3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};return g}},{}],168:[function(h,k,l){k.exports=function(b){b.Subscription=
function(g,e,f,c){c=c||{};c.extraHeaders=(c.extraHeaders||[]).slice();this.id=null;this.state="init";if(f)this.event=f;else throw new TypeError("Event necessary to create a subscription.");"number"!==typeof c.expires?(g.logger.warn("expires must be a number. Using default of 3600."),this.expires=3600):this.expires=c.expires;c.extraHeaders.push("Event: "+this.event);c.extraHeaders.push("Expires: "+this.expires);c.body&&(this.body=c.body);this.contact=g.contact.toString();c.extraHeaders.push("Contact: "+
this.contact);c.extraHeaders.push("Allow: "+b.Utils.getAllowedMethods(g));b.Utils.augment(this,b.ClientContext,[g,b.C.SUBSCRIBE,e,c]);this.logger=g.getLogger("sip.subscription");this.dialog=null;this.timers={N:null,sub_duration:null};this.errorCodes=[404,405,410,416,480,481,482,483,484,485,489,501,604];this.initMoreEvents(["notify"])};b.Subscription.prototype={subscribe:function(){b.Timers.clearTimeout(this.timers.sub_duration);b.Timers.clearTimeout(this.timers.N);this.timers.N=b.Timers.setTimeout(this.timer_fire.bind(this),
b.Timers.TIMER_N);this.send();this.state="notify_wait";return this},receiveResponse:function(g){var e,f=b.C.REASON_PHRASE[g.status_code]||"";-1!==this.errorCodes.indexOf(g.status_code)?this.failed(g,null):/^2[0-9]{2}$/.test(g.status_code)&&(e=g.getHeader("Expires"),b.Timers.clearTimeout(this.timers.N),this.createConfirmedDialog(g,"UAC")&&(this.id=this.dialog.id.toString(),this.ua.subscriptions[this.id]=this,this.emit("accepted",g,f)),e&&e<=this.expires?this.timers.sub_duration=b.Timers.setTimeout(this.subscribe.bind(this),
1E3*e):e?(this.logger.warn("Expires header in a 200-class response to SUBSCRIBE with a higher value than the one in the request"),this.failed(g,b.C.INVALID_EXPIRES_HEADER)):(this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE"),this.failed(g,b.C.EXPIRES_HEADER_MISSING)))},unsubscribe:function(){var g=[];this.state="terminated";g.push("Event: "+this.event);g.push("Expires: 0");g.push("Contact: "+this.contact);g.push("Allow: "+b.Utils.getAllowedMethods(this.ua));this.request=
new b.OutgoingRequest(this.method,this.request.to.uri.toString(),this.ua,null,g);this.receiveResponse=function(){};b.Timers.clearTimeout(this.timers.sub_duration);b.Timers.clearTimeout(this.timers.N);this.timers.N=b.Timers.setTimeout(this.timer_fire.bind(this),b.Timers.TIMER_N);this.send()},timer_fire:function(){"terminated"===this.state?this.close():"pending"===this.state||"notify_wait"===this.state?(this.state="terminated",this.close()):this.subscribe()},close:function(){"terminated"!==this.state&&
this.unsubscribe();this.terminateDialog();b.Timers.clearTimeout(this.timers.N);b.Timers.clearTimeout(this.timers.sub_duration);delete this.ua.subscriptions[this.id]},createConfirmedDialog:function(g,e){var f;this.terminateDialog();f=new b.Dialog(this,g,e);if(f.error)return!1;this.dialog=f;return!0},terminateDialog:function(){this.dialog&&(delete this.ua.subscriptions[this.id],this.dialog.terminate(),delete this.dialog)},receiveRequest:function(g){function e(){f.expires&&(f.expires=Math.min(c.expires,
Math.max(f.expires,0)),c.timers.sub_duration=b.Timers.setTimeout(c.subscribe.bind(c),1E3*f.expires))}var f,c=this;if(this.matchEvent(g))switch(f=g.parseHeader("Subscription-State"),g.reply(200,b.C.REASON_200),b.Timers.clearTimeout(this.timers.N),b.Timers.clearTimeout(this.timers.sub_duration),this.emit("notify",{request:g}),f.state){case "active":this.state="active";e();break;case "pending":"notify_wait"===this.state&&e();this.state="pending";break;case "terminated":if(f.reason)switch(this.logger.log("terminating subscription with reason "+
f.reason),f.reason){case "deactivated":case "timeout":this.subscribe();return;case "probation":case "giveup":f.params&&f.params["retry-after"]?this.timers.sub_duration=b.Timers.setTimeout(c.subscribe.bind(c),f.params["retry-after"]):this.subscribe();return}this.close()}else g.reply(489)},failed:function(b,e){this.close();return this.emit("failed",b,e)},matchEvent:function(b){var e;if(!b.hasHeader("Event"))return this.logger.warn("missing Event header"),!1;if(!b.hasHeader("Subscription-State"))return this.logger.warn("missing Subscription-State header"),
!1;e=b.parseHeader("event").event;return this.event!==e?(this.logger.warn("event match failed"),b.reply(481,"Event Match Failed"),!1):!0}}}},{}],169:[function(h,k,l){k.exports=function(b){var g={T1:500,T2:4E3,T4:5E3,TIMER_B:32E3,TIMER_D:0,TIMER_F:32E3,TIMER_H:32E3,TIMER_I:0,TIMER_J:0,TIMER_K:0,TIMER_L:32E3,TIMER_M:32E3,TIMER_N:32E3,PROVISIONAL_RESPONSE_INTERVAL:6E4};["setTimeout","clearTimeout","setInterval","clearInterval"].forEach(function(e){g[e]=function(){return b[e].apply(b,arguments)}});return g}},
{}],170:[function(h,k,l){k.exports=function(b){var g={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},e=function(a,b,c){this.type=g.NON_INVITE_CLIENT;this.transport=c;this.id="z9hG4bK"+Math.floor(1E7*Math.random());this.request_sender=a;this.request=b;this.logger=a.ua.getLogger("sip.transaction.nict",this.id);b="SIP/2.0/"+(a.ua.configuration.hackViaTcp?
"TCP":c.server.scheme);b+=" "+a.ua.configuration.viaHost+";branch="+this.id;this.request.setHeader("via",b);this.request_sender.ua.newTransaction(this);this.initEvents(["stateChanged"])};e.prototype=new b.EventEmitter;e.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};e.prototype.send=function(){this.stateChanged(g.STATUS_TRYING);this.F=b.Timers.setTimeout(this.timer_F.bind(this),b.Timers.TIMER_F);if(!this.transport.send(this.request))this.onTransportError()};e.prototype.onTransportError=
function(){this.logger.log("transport error occurred, deleting non-INVITE client transaction "+this.id);b.Timers.clearTimeout(this.F);b.Timers.clearTimeout(this.K);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this);this.request_sender.onTransportError()};e.prototype.timer_F=function(){this.logger.log("Timer F expired for non-INVITE client transaction "+this.id);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this);this.request_sender.onRequestTimeout()};
e.prototype.timer_K=function(){this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this)};e.prototype.receiveResponse=function(a){var c=a.status_code;if(200>c)switch(this.state){case g.STATUS_TRYING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_PROCEEDING),this.request_sender.receiveResponse(a)}else switch(this.state){case g.STATUS_TRYING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_COMPLETED);b.Timers.clearTimeout(this.F);if(408===c)this.request_sender.onRequestTimeout();
else this.request_sender.receiveResponse(a);this.K=b.Timers.setTimeout(this.timer_K.bind(this),b.Timers.TIMER_K)}};var f=function(a,b,c){var d=this;this.type=g.INVITE_CLIENT;this.transport=c;this.id="z9hG4bK"+Math.floor(1E7*Math.random());this.request_sender=a;this.request=b;this.logger=a.ua.getLogger("sip.transaction.ict",this.id);b="SIP/2.0/"+(a.ua.configuration.hackViaTcp?"TCP":c.server.scheme);b+=" "+a.ua.configuration.viaHost+";branch="+this.id;this.request.setHeader("via",b);this.request_sender.ua.newTransaction(this);
this.request.cancel=function(a){d.cancel_request(d,a)};this.initEvents(["stateChanged"])};f.prototype=new b.EventEmitter;f.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};f.prototype.send=function(){this.stateChanged(g.STATUS_CALLING);this.B=b.Timers.setTimeout(this.timer_B.bind(this),b.Timers.TIMER_B);if(!this.transport.send(this.request))this.onTransportError()};f.prototype.onTransportError=function(){this.logger.log("transport error occurred, deleting INVITE client transaction "+
this.id);b.Timers.clearTimeout(this.B);b.Timers.clearTimeout(this.D);b.Timers.clearTimeout(this.M);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this);if(this.state!==g.STATUS_ACCEPTED)this.request_sender.onTransportError()};f.prototype.timer_M=function(){this.logger.log("Timer M expired for INVITE client transaction "+this.id);this.state===g.STATUS_ACCEPTED&&(b.Timers.clearTimeout(this.B),this.stateChanged(g.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this))};
f.prototype.timer_B=function(){this.logger.log("Timer B expired for INVITE client transaction "+this.id);this.state===g.STATUS_CALLING&&(this.stateChanged(g.STATUS_TERMINATED),this.request_sender.ua.destroyTransaction(this),this.request_sender.onRequestTimeout())};f.prototype.timer_D=function(){this.logger.log("Timer D expired for INVITE client transaction "+this.id);b.Timers.clearTimeout(this.B);this.stateChanged(g.STATUS_TERMINATED);this.request_sender.ua.destroyTransaction(this)};f.prototype.sendACK=
function(a){this.ack="ACK "+this.request.ruri+" SIP/2.0\r\n";this.ack+="Via: "+this.request.headers.Via.toString()+"\r\n";this.request.headers.Route&&(this.ack+="Route: "+this.request.headers.Route.toString()+"\r\n");this.ack+="To: "+a.getHeader("to")+"\r\n";this.ack+="From: "+this.request.headers.From.toString()+"\r\n";this.ack+="Call-ID: "+this.request.headers["Call-ID"].toString()+"\r\n";this.ack+="CSeq: "+this.request.headers.CSeq.toString().split(" ")[0];this.ack+=" ACK\r\n\r\n";this.D=b.Timers.setTimeout(this.timer_D.bind(this),
b.Timers.TIMER_D);this.transport.send(this.ack)};f.prototype.cancel_request=function(a,c){var d=a.request;this.cancel=b.C.CANCEL+" "+d.ruri+" SIP/2.0\r\n";this.cancel+="Via: "+d.headers.Via.toString()+"\r\n";this.request.headers.Route&&(this.cancel+="Route: "+d.headers.Route.toString()+"\r\n");this.cancel+="To: "+d.headers.To.toString()+"\r\n";this.cancel+="From: "+d.headers.From.toString()+"\r\n";this.cancel+="Call-ID: "+d.headers["Call-ID"].toString()+"\r\n";this.cancel+="CSeq: "+d.headers.CSeq.toString().split(" ")[0]+
" CANCEL\r\n";c&&(this.cancel+="Reason: "+c+"\r\n");this.cancel+="Content-Length: 0\r\n\r\n";this.transport.send(this.cancel)};f.prototype.receiveResponse=function(a){var c=a.status_code;if(100<=c&&199>=c)switch(this.state){case g.STATUS_CALLING:this.stateChanged(g.STATUS_PROCEEDING);this.request_sender.receiveResponse(a);this.cancel&&this.transport.send(this.cancel);break;case g.STATUS_PROCEEDING:this.request_sender.receiveResponse(a)}else if(200<=c&&299>=c)switch(this.state){case g.STATUS_CALLING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_ACCEPTED);
this.M=b.Timers.setTimeout(this.timer_M.bind(this),b.Timers.TIMER_M);this.request_sender.receiveResponse(a);break;case g.STATUS_ACCEPTED:this.request_sender.receiveResponse(a)}else if(300<=c&&699>=c)switch(this.state){case g.STATUS_CALLING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_COMPLETED);this.sendACK(a);this.request_sender.receiveResponse(a);break;case g.STATUS_COMPLETED:this.sendACK(a)}};var c=function(a,b,c){this.transport=c;this.id="z9hG4bK"+Math.floor(1E7*Math.random());this.request_sender=
a;this.request=b;this.logger=a.ua.getLogger("sip.transaction.nict",this.id);b="SIP/2.0/"+(a.ua.configuration.hackViaTcp?"TCP":c.server.scheme);b+=" "+a.ua.configuration.viaHost+";branch="+this.id;this.request.setHeader("via",b)};c.prototype=new b.EventEmitter;c.prototype.send=function(){if(!this.transport.send(this.request))this.onTransportError()};c.prototype.onTransportError=function(){this.logger.log("transport error occurred, for an ACK client transaction "+this.id);this.request_sender.onTransportError()};
var d=function(a,b){this.type=g.NON_INVITE_SERVER;this.id=a.via_branch;this.request=a;this.transport=a.transport;this.ua=b;this.last_response="";a.server_transaction=this;this.logger=b.getLogger("sip.transaction.nist",this.id);this.state=g.STATUS_TRYING;b.newTransaction(this);this.initEvents(["stateChanged"])};d.prototype=new b.EventEmitter;d.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};d.prototype.timer_J=function(){this.logger.log("Timer J expired for non-INVITE server transaction "+
this.id);this.stateChanged(g.STATUS_TERMINATED);this.ua.destroyTransaction(this)};d.prototype.onTransportError=function(){this.transportError||(this.transportError=!0,this.logger.log("transport error occurred, deleting non-INVITE server transaction "+this.id),b.Timers.clearTimeout(this.J),this.stateChanged(g.STATUS_TERMINATED),this.ua.destroyTransaction(this))};d.prototype.receiveResponse=function(a,c,d,e){if(100===a)switch(this.state){case g.STATUS_TRYING:this.stateChanged(g.STATUS_PROCEEDING);if(!this.transport.send(c))this.onTransportError();
break;case g.STATUS_PROCEEDING:this.last_response=c,this.transport.send(c)?d&&d():(this.onTransportError(),e&&e())}else if(200<=a&&699>=a)switch(this.state){case g.STATUS_TRYING:case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_COMPLETED),this.last_response=c,this.J=b.Timers.setTimeout(this.timer_J.bind(this),b.Timers.TIMER_J),this.transport.send(c)?d&&d():(this.onTransportError(),e&&e())}};var a=function(a,b){this.type=g.INVITE_SERVER;this.id=a.via_branch;this.request=a;this.transport=a.transport;
this.ua=b;this.last_response="";a.server_transaction=this;this.logger=b.getLogger("sip.transaction.ist",this.id);this.state=g.STATUS_PROCEEDING;b.newTransaction(this);this.resendProvisionalTimer=null;a.reply(100);this.initEvents(["stateChanged"])};a.prototype=new b.EventEmitter;a.prototype.stateChanged=function(a){this.state=a;this.emit("stateChanged")};a.prototype.timer_H=function(){this.logger.log("Timer H expired for INVITE server transaction "+this.id);this.state===g.STATUS_COMPLETED&&this.logger.warn("transactions",
"ACK for INVITE server transaction was never received, call will be terminated");this.stateChanged(g.STATUS_TERMINATED);this.ua.destroyTransaction(this)};a.prototype.timer_I=function(){this.stateChanged(g.STATUS_TERMINATED);this.ua.destroyTransaction(this)};a.prototype.timer_L=function(){this.logger.log("Timer L expired for INVITE server transaction "+this.id);this.state===g.STATUS_ACCEPTED&&(this.stateChanged(g.STATUS_TERMINATED),this.ua.destroyTransaction(this))};a.prototype.onTransportError=function(){this.transportError||
(this.transportError=!0,this.logger.log("transport error occurred, deleting INVITE server transaction "+this.id),null!==this.resendProvisionalTimer&&(b.Timers.clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),b.Timers.clearTimeout(this.L),b.Timers.clearTimeout(this.H),b.Timers.clearTimeout(this.I),this.stateChanged(g.STATUS_TERMINATED),this.ua.destroyTransaction(this))};a.prototype.resend_provisional=function(){if(!this.transport.send(this.last_response))this.onTransportError()};
a.prototype.receiveResponse=function(a,c,d,e){if(100<=a&&199>=a)switch(this.state){case g.STATUS_PROCEEDING:if(!this.transport.send(c))this.onTransportError();this.last_response=c}if(100<a&&199>=a&&this.state===g.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=b.Timers.setInterval(this.resend_provisional.bind(this),b.Timers.PROVISIONAL_RESPONSE_INTERVAL));else if(200<=a&&299>=a)switch(this.state){case g.STATUS_PROCEEDING:this.stateChanged(g.STATUS_ACCEPTED),this.last_response=
c,this.L=b.Timers.setTimeout(this.timer_L.bind(this),b.Timers.TIMER_L),null!==this.resendProvisionalTimer&&(b.Timers.clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case g.STATUS_ACCEPTED:this.transport.send(c)?d&&d():(this.onTransportError(),e&&e())}else if(300<=a&&699>=a)switch(this.state){case g.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(b.Timers.clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(c)?(this.stateChanged(g.STATUS_COMPLETED),
this.H=b.Timers.setTimeout(this.timer_H.bind(this),b.Timers.TIMER_H),d&&d()):(this.onTransportError(),e&&e())}};b.Transactions={C:g,checkTransaction:function(a,c){var d;switch(c.method){case b.C.INVITE:if(d=a.transactions.ist[c.via_branch]){switch(d.state){case g.STATUS_PROCEEDING:d.transport.send(d.last_response)}return!0}break;case b.C.ACK:if(d=a.transactions.ist[c.via_branch]){if(d.state===g.STATUS_ACCEPTED)return!1;if(d.state===g.STATUS_COMPLETED)return d.state=g.STATUS_CONFIRMED,d.I=b.Timers.setTimeout(d.timer_I.bind(d),
b.Timers.TIMER_I),!0}else return!1;break;case b.C.CANCEL:if(d=a.transactions.ist[c.via_branch])return c.reply_sl(200),d.state===g.STATUS_PROCEEDING?!1:!0;c.reply_sl(481);return!0;default:if(d=a.transactions.nist[c.via_branch]){switch(d.state){case g.STATUS_PROCEEDING:case g.STATUS_COMPLETED:d.transport.send(d.last_response)}return!0}}},NonInviteClientTransaction:e,InviteClientTransaction:f,AckClientTransaction:c,NonInviteServerTransaction:d,InviteServerTransaction:a}}},{}],171:[function(h,k,l){k.exports=
function(b,g){var e;e=function(b,c){this.logger=b.getLogger("sip.transport");this.ua=b;this.ws=null;this.server=c;this.reconnection_attempts=0;this.connected=this.closed=!1;this.reconnectTimer=null;this.lastTransportError={};this.ua.transport=this;this.connect()};e.prototype={send:function(b){b=b.toString();if(this.ws&&this.ws.readyState===g.WebSocket.OPEN)return!0===this.ua.configuration.traceSip&&this.logger.log("sending WebSocket message:\n\n"+b+"\n"),this.ws.send(b),!0;this.logger.warn("unable to send message, WebSocket is not open");
return!1},disconnect:function(){this.ws&&(b.Timers.clearTimeout(this.reconnectTimer),this.closed=!0,this.logger.log("closing WebSocket "+this.server.ws_uri),this.ws.close());null!==this.reconnectTimer&&(b.Timers.clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.ua.emit("disconnected",{transport:this,code:this.lastTransportError.code,reason:this.lastTransportError.reason}))},connect:function(){var b=this;if(this.ws&&(this.ws.readyState===WebSocket.OPEN||this.ws.readyState===WebSocket.CONNECTING))return this.logger.log("WebSocket "+
this.server.ws_uri+" is already connected"),!1;this.ws&&this.ws.close();this.logger.log("connecting to WebSocket "+this.server.ws_uri);this.ua.onTransportConnecting(this,0===this.reconnection_attempts?1:this.reconnection_attempts);try{this.ws=new g.WebSocket(this.server.ws_uri,"sip")}catch(c){this.logger.warn("error connecting to WebSocket "+this.server.ws_uri+": "+c)}this.ws.binaryType="arraybuffer";this.ws.onopen=function(){b.onOpen()};this.ws.onclose=function(c){b.onClose(c)};this.ws.onmessage=
function(c){b.onMessage(c)};this.ws.onerror=function(c){b.onError(c)}},onOpen:function(){this.connected=!0;this.logger.log("WebSocket "+this.server.ws_uri+" connected");null!==this.reconnectTimer&&(b.Timers.clearTimeout(this.reconnectTimer),this.reconnectTimer=null);this.reconnection_attempts=0;this.closed=!1;this.ua.onTransportConnected(this)},onClose:function(b){var c=this.connected;this.connected=!1;this.lastTransportError.code=b.code;this.lastTransportError.reason=b.reason;this.logger.log("WebSocket disconnected (code: "+
b.code+(b.reason?"| reason: "+b.reason:"")+")");!1===b.wasClean&&this.logger.warn("WebSocket abrupt disconnection");if(!0===c)this.ua.onTransportClosed(this),this.closed?this.ua.emit("disconnected",{transport:this,code:this.lastTransportError.code,reason:this.lastTransportError.reason}):this.reConnect();else this.ua.onTransportError(this)},onMessage:function(e){var c;e=e.data;if("\r\n"===e)!0===this.ua.configuration.traceSip&&this.logger.log("received WebSocket message with CRLF Keep Alive response");
else{if("string"!==typeof e){try{e=String.fromCharCode.apply(null,new Uint8Array(e))}catch(d){this.logger.warn("received WebSocket binary message failed to be converted into string, message discarded");return}!0===this.ua.configuration.traceSip&&this.logger.log("received WebSocket binary message:\n\n"+e+"\n")}else!0===this.ua.configuration.traceSip&&this.logger.log("received WebSocket text message:\n\n"+e+"\n");if((e=b.Parser.parseMessage(e,this.ua))&&!(this.ua.status===b.UA.C.STATUS_USER_CLOSED&&
e instanceof b.IncomingRequest)&&b.sanityCheck(e,this.ua,this))if(e instanceof b.IncomingRequest)e.transport=this,this.ua.receiveRequest(e);else if(e instanceof b.IncomingResponse)switch(e.method){case b.C.INVITE:(c=this.ua.transactions.ict[e.via_branch])&&c.receiveResponse(e);break;case b.C.ACK:break;default:(c=this.ua.transactions.nict[e.via_branch])&&c.receiveResponse(e)}}},onError:function(b){this.logger.warn("WebSocket connection error: "+b)},reConnect:function(){var e=this;this.reconnection_attempts+=
1;this.reconnection_attempts>this.ua.configuration.wsServerMaxReconnection?(this.logger.warn("maximum reconnection attempts for WebSocket "+this.server.ws_uri),this.ua.onTransportError(this)):(this.logger.log("trying to reconnect to WebSocket "+this.server.ws_uri+" (reconnection attempt "+this.reconnection_attempts+")"),this.reconnectTimer=b.Timers.setTimeout(function(){e.connect();e.reconnectTimer=null},1E3*this.ua.configuration.wsServerReconnectionTimeout))}};e.C={STATUS_READY:0,STATUS_DISCONNECTED:1,
STATUS_ERROR:2};b.Transport=e}},{}],172:[function(h,k,l){(function(b){k.exports=function(g){var e,f={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2,EVENT_METHODS:{invite:"INVITE",message:"MESSAGE"},ALLOWED_METHODS:"ACK CANCEL BYE OPTIONS INFO NOTIFY".split(" "),ACCEPTED_BODY_TYPES:["application/sdp","application/dtmf-relay"],MAX_FORWARDS:70,TAG_LENGTH:10};e=function(c){var d="connecting connected disconnected newTransaction transactionDestroyed registered unregistered registrationFailed invite newSession message".split(" "),
a,e;a=0;for(e=f.ALLOWED_METHODS.length;a<e;a++)d.push(f.ALLOWED_METHODS[a].toLowerCase());f.ACCEPTED_BODY_TYPES=f.ACCEPTED_BODY_TYPES.toString();this.log=new g.LoggerFactory;this.logger=this.getLogger("sip.ua");this.cache={credentials:{}};this.configuration={};this.dialogs={};this.applicants={};this.data={};this.sessions={};this.subscriptions={};this.contact=this.transport=null;this.status=f.STATUS_INIT;this.error=null;this.transactions={nist:{},nict:{},ist:{},ict:{}};this.transportRecoverAttempts=
0;this.transportRecoveryTimer=null;Object.defineProperties(this,{transactionsCount:{get:function(){var a,b=["nist","nict","ist","ict"],c=0;for(a in b)c+=Object.keys(this.transactions[b[a]]).length;return c}},nictTransactionsCount:{get:function(){return Object.keys(this.transactions.nict).length}},nistTransactionsCount:{get:function(){return Object.keys(this.transactions.nist).length}},ictTransactionsCount:{get:function(){return Object.keys(this.transactions.ict).length}},istTransactionsCount:{get:function(){return Object.keys(this.transactions.ist).length}}});
if(void 0===c)c={};else if("string"===typeof c||c instanceof String)c={uri:c};c.log&&(c.log.hasOwnProperty("builtinEnabled")&&(this.log.builtinEnabled=c.log.builtinEnabled),c.log.hasOwnProperty("level")&&(this.log.level=c.log.level),c.log.hasOwnProperty("connector")&&(this.log.connector=c.log.connector));try{this.loadConfig(c),this.initEvents(d)}catch(h){throw this.status=f.STATUS_NOT_READY,this.error=f.CONFIGURATION_ERROR,h;}this.registerContext=new g.RegisterContext(this);this.registerContext.on("failed",
this.emit.bind(this,"registrationFailed"));this.registerContext.on("registered",this.emit.bind(this,"registered"));this.registerContext.on("unregistered",this.emit.bind(this,"unregistered"));this.configuration.autostart&&this.start();"function"===typeof b.addEventListener&&b.addEventListener("unload",this.stop.bind(this))};e.prototype=new g.EventEmitter;e.prototype.register=function(b){this.configuration.register=!0;this.registerContext.register(b);return this};e.prototype.unregister=function(b){this.configuration.register=
!1;this.registerContext.unregister(b);return this};e.prototype.isRegistered=function(){return this.registerContext.registered};e.prototype.isConnected=function(){return this.transport?this.transport.connected:!1};e.prototype.invite=function(b,d){d=d||{};d=g.Utils.desugarSessionOptions(d);g.Utils.optionsOverride(d,"media","mediaConstraints",!0,this.logger);var a=new g.InviteClientContext(this,b,d);if(this.isConnected())a.invite({media:d.media});else this.once("connected",function(){a.invite({media:d.media})});
return a};e.prototype.subscribe=function(b,d,a){var e=new g.Subscription(this,b,d,a);if(this.isConnected())e.subscribe();else this.once("connected",function(){e.subscribe()});return e};e.prototype.message=function(b,d,a){if(void 0===d)throw new TypeError("Not enough arguments");a=a||{};a.contentType=a.contentType||"text/plain";a.body=d;var e=new g.ClientContext(this,g.C.MESSAGE,b,a);if(this.isConnected())e.send();else this.once("connected",function(){e.send()});return e};e.prototype.request=function(b,
d,a){var e=new g.ClientContext(this,b,d,a);if(this.isConnected())e.send();else this.once("connected",function(){e.send()});return e};e.prototype.stop=function(){function b(){0===k.nistTransactionsCount&&0===k.nictTransactionsCount&&(k.off("transactionDestroyed",b),k.transport.disconnect())}var e,a,h,k=this;this.logger.log("user requested closure...");if(this.status===f.STATUS_USER_CLOSED)return this.logger.warn("UA already closed"),this;g.Timers.clearTimeout(this.transportRecoveryTimer);this.logger.log("closing registerContext");
this.registerContext.close();for(e in this.sessions)this.logger.log("closing session "+e),this.sessions[e].terminate();for(a in this.subscriptions)this.logger.log("unsubscribing from subscription "+a),this.subscriptions[a].close();for(h in this.applicants)this.applicants[h].close();this.status=f.STATUS_USER_CLOSED;if(0===this.nistTransactionsCount&&0===this.nictTransactionsCount)this.transport.disconnect();else this.on("transactionDestroyed",b);return this};e.prototype.start=function(){var b;this.logger.log("user requested startup...");
this.status===f.STATUS_INIT?(b=this.getNextWsServer(),new g.Transport(this,b)):this.status===f.STATUS_USER_CLOSED?(this.logger.log("resuming"),this.status=f.STATUS_READY,this.transport.connect()):this.status===f.STATUS_READY?this.logger.log("UA is in READY status, not resuming"):this.logger.error("Connection is down. Auto-Recovery system is trying to connect");return this};e.prototype.normalizeTarget=function(b){return g.Utils.normalizeTarget(b,this.configuration.hostportParams)};e.prototype.saveCredentials=
function(b){this.cache.credentials[b.realm]=this.cache.credentials[b.realm]||{};this.cache.credentials[b.realm][b.uri]=b;return this};e.prototype.getCredentials=function(b){var e,a;e=b.ruri.host;this.cache.credentials[e]&&this.cache.credentials[e][b.ruri]&&(a=this.cache.credentials[e][b.ruri],a.method=b.method);return a};e.prototype.getLogger=function(b,e){return this.log.getLogger(b,e)};e.prototype.onTransportClosed=function(b){var e,a,f=["nict","ict","nist","ist"];b.server.status=g.Transport.C.STATUS_DISCONNECTED;
this.logger.log("connection state set to "+g.Transport.C.STATUS_DISCONNECTED);a=f.length;for(b=0;b<a;b++)for(e in this.transactions[f[b]])this.transactions[f[b]][e].onTransportError();this.contact.pub_gruu||this.closeSessionsOnTransportError()};e.prototype.onTransportError=function(b){this.logger.log("transport "+b.server.ws_uri+" failed | connection state set to "+g.Transport.C.STATUS_ERROR);b.server.status=g.Transport.C.STATUS_ERROR;this.emit("disconnected",{transport:b});this.status!==f.STATUS_USER_CLOSED&&
((b=this.getNextWsServer())?new g.Transport(this,b):(this.closeSessionsOnTransportError(),this.error&&this.error===f.NETWORK_ERROR||(this.status=f.STATUS_NOT_READY,this.error=f.NETWORK_ERROR),this.recoverTransport()))};e.prototype.onTransportConnected=function(b){this.transport=b;this.transportRecoverAttempts=0;b.server.status=g.Transport.C.STATUS_READY;this.logger.log("connection state set to "+g.Transport.C.STATUS_READY);if(this.status!==f.STATUS_USER_CLOSED){this.status=f.STATUS_READY;this.error=
null;if(this.configuration.register)this.registerContext.onTransportConnected();this.emit("connected",{transport:b})}};e.prototype.onTransportConnecting=function(b,e){this.emit("connecting",{transport:b,attempts:e})};e.prototype.newTransaction=function(b){this.transactions[b.type][b.id]=b;this.emit("newTransaction",{transaction:b})};e.prototype.destroyTransaction=function(b){delete this.transactions[b.type][b.id];this.emit("transactionDestroyed",{transaction:b})};e.prototype.receiveRequest=function(b){function e(a){return a&&
a.user===b.ruri.user}var a,h;h=b.method;a=b.method.toLowerCase();var k=this;if(!(e(this.configuration.uri)||e(this.contact.uri)||e(this.contact.pub_gruu)||e(this.contact.temp_gruu)))this.logger.warn("Request-URI does not point to us"),b.method!==g.C.ACK&&b.reply_sl(404);else if(b.ruri.scheme===g.C.SIPS)b.reply_sl(416);else if(!g.Transactions.checkTransaction(this,b)){if(h===g.C.OPTIONS)new g.Transactions.NonInviteServerTransaction(b,this),b.reply(200,null,["Allow: "+g.Utils.getAllowedMethods(this),
"Accept: "+f.ACCEPTED_BODY_TYPES]);else if(h===g.C.MESSAGE){if(!this.checkListener(a)){new g.Transactions.NonInviteServerTransaction(b,this);b.reply(405,null,["Allow: "+g.Utils.getAllowedMethods(this)]);return}a=new g.ServerContext(this,b);a.body=b.body;a.content_type=b.getHeader("Content-Type")||"text/plain";b.reply(200,null);this.emit("message",a)}else h!==g.C.INVITE&&h!==g.C.ACK&&new g.ServerContext(this,b);if(b.to_tag)(a=this.findDialog(b))?(h===g.C.INVITE&&new g.Transactions.InviteServerTransaction(b,
this),a.receiveRequest(b)):h===g.C.NOTIFY?(h=this.findSession(b))?h.receiveRequest(b):(this.logger.warn("received NOTIFY request for a non existent session"),b.reply(481,"Subscription does not exist")):h!==g.C.ACK&&b.reply(481);else switch(h){case g.C.INVITE:h=this.configuration.mediaHandlerFactory.isSupported;!h||h()?h=(new g.InviteServerContext(this,b)).on("invite",function(){k.emit("invite",this)}):(this.logger.warn("INVITE received but WebRTC is not supported"),b.reply(488));break;case g.C.BYE:b.reply(481);
break;case g.C.CANCEL:(h=this.findSession(b))?h.receiveRequest(b):this.logger.warn("received CANCEL request for a non existent session");break;case g.C.ACK:break;default:b.reply(405)}}};e.prototype.findSession=function(b){return this.sessions[b.call_id+b.from_tag]||this.sessions[b.call_id+b.to_tag]||null};e.prototype.findDialog=function(b){return this.dialogs[b.call_id+b.from_tag+b.to_tag]||this.dialogs[b.call_id+b.to_tag+b.from_tag]||null};e.prototype.getNextWsServer=function(){var b,e,a,f=[];e=
this.configuration.wsServers.length;for(b=0;b<e;b++)a=this.configuration.wsServers[b],a.status!==g.Transport.C.STATUS_ERROR&&(0===f.length?f.push(a):a.weight>f[0].weight?f=[a]:a.weight===f[0].weight&&f.push(a));b=Math.floor(Math.random()*f.length);return f[b]};e.prototype.closeSessionsOnTransportError=function(){for(var b in this.sessions)this.sessions[b].onTransportError();this.registerContext.onTransportClosed()};e.prototype.recoverTransport=function(b){var e,a,f,h;b=b||this;f=b.transportRecoverAttempts;
a=b.configuration.wsServers.length;for(e=0;e<a;e++)b.configuration.wsServers[e].status=0;h=b.getNextWsServer();e=Math.floor(Math.random()*Math.pow(2,f)+1)*b.configuration.connectionRecoveryMinInterval;e>b.configuration.connectionRecoveryMaxInterval&&(this.logger.log("time for next connection attempt exceeds connectionRecoveryMaxInterval, resetting counter"),e=b.configuration.connectionRecoveryMinInterval,f=0);this.logger.log("next connection attempt in "+e+" seconds");this.transportRecoveryTimer=
g.Timers.setTimeout(function(){b.transportRecoverAttempts=f+1;new g.Transport(b,h)},1E3*e)};e.prototype.loadConfig=function(b){function d(a,e){var d=a.replace(/([a-z][A-Z])/g,function(a){return a[0]+"_"+a[1].toLowerCase()});if(a!==d){var f=b.hasOwnProperty(a);b.hasOwnProperty(d)&&(e.warn(d+" is deprecated, please use "+a),f&&e.warn(a+" overriding "+d));b[a]=f?b[a]:b[d]}}var a,f,h,k={viaHost:g.Utils.createRandomToken(12)+".invalid",uri:new g.URI("sip","anonymous."+g.Utils.createRandomToken(6),"anonymous.invalid",
null,null),wsServers:[{scheme:"WSS",sip_uri:"<sip:edge.sip.onsip.com;transport=ws;lr>",status:0,weight:0,ws_uri:"wss://edge.sip.onsip.com"}],password:null,registerExpires:600,register:!0,registrarServer:null,wsServerMaxReconnection:3,wsServerReconnectionTimeout:4,connectionRecoveryMinInterval:2,connectionRecoveryMaxInterval:30,usePreloadedRoute:!1,userAgentString:g.C.USER_AGENT,noAnswerTimeout:60,stunServers:["stun:stun.l.google.com:19302"],turnServers:[],traceSip:!1,hackViaTcp:!1,hackIpInContact:!1,
hackWssInTransport:!1,autostart:!0,rel100:g.C.supported.UNSUPPORTED,mediaHandlerFactory:g.WebRTC.MediaHandler.defaultFactory};for(a in e.configuration_check.mandatory)if(d(a,this.logger),b.hasOwnProperty(a))if(f=b[a],h=e.configuration_check.mandatory[a](f),void 0!==h)k[a]=h;else throw new g.Exceptions.ConfigurationError(a,f);else throw new g.Exceptions.ConfigurationError(a);g.Utils.optionsOverride(b,"rel100","reliable",!0,this.logger,g.C.supported.UNSUPPORTED);var l=["stunServers","turnServers"];
for(a in e.configuration_check.optional)if(d(a,this.logger),b.hasOwnProperty(a)&&(f=b[a],!(f instanceof Array&&0===f.length&&0>l.indexOf(a)||null===f||""===f||void 0===f||"number"===typeof f&&isNaN(f))))if(h=e.configuration_check.optional[a](f),void 0!==h)k[a]=h;else throw new g.Exceptions.ConfigurationError(a,f);if(k.connectionRecoveryMaxInterval<k.connectionRecoveryMinInterval)throw new g.Exceptions.ConfigurationError("connectionRecoveryMaxInterval",k.connectionRecoveryMaxInterval);0===k.displayName&&
(k.displayName="0");k.instanceId||(k.instanceId=g.Utils.newUUID());k.sipjsId=g.Utils.createRandomToken(5);f=k.uri.clone();f.user=null;k.hostportParams=f.toString().replace(/^sip:/i,"");k.authorizationUser||(k.authorizationUser=k.uri.user);k.registrarServer||(f=k.uri.clone(),f.user=null,k.registrarServer=f);k.noAnswerTimeout*=1E3;k.hackIpInContact&&(k.viaHost=g.Utils.getRandomTestNetIP());this.contact={pub_gruu:null,temp_gruu:null,uri:new g.URI("sip",g.Utils.createRandomToken(8),k.viaHost,null,{transport:k.hackWssInTransport?
"wss":"ws"}),toString:function(a){a=a||{};var b=a.outbound||null,c="<",c=a.anonymous?c+(this.temp_gruu||("sip:anonymous@anonymous.invalid;transport="+k.hackWssInTransport?"wss":"ws")).toString():c+(this.pub_gruu||this.uri).toString();b&&(c+=";ob");return c+">"}};g.Utils.optionsOverride(k,"media","mediaConstraints",!0,this.logger);for(a in k)e.configuration_skeleton[a].value=k[a];Object.defineProperties(this.configuration,e.configuration_skeleton);for(a in k)e.configuration_skeleton[a].value="";this.logger.log("configuration parameters after validation:");
for(a in k)switch(a){case "uri":case "registrarServer":case "mediaHandlerFactory":this.logger.log("\u00b7 "+a+": "+k[a]);break;case "password":this.logger.log("\u00b7 "+a+": NOT SHOWN");break;default:this.logger.log("\u00b7 "+a+": "+JSON.stringify(k[a]))}};e.configuration_skeleton=function(){var b,e,a={},f="sipjsId hostportParams uri wsServers authorizationUser connectionRecoveryMaxInterval connectionRecoveryMinInterval displayName hackViaTcp hackIpInContact hackWssInTransport instanceId noAnswerTimeout password registerExpires registrarServer reliable rel100 userAgentString autostart stunServers traceSip turnServers usePreloadedRoute wsServerMaxReconnection wsServerReconnectionTimeout mediaHandlerFactory media mediaConstraints via_core_value viaHost".split(" ");
for(b in f)e=f[b],a[e]={value:"",writable:!1,configurable:!1};a.register={value:"",writable:!0,configurable:!1};return a}();e.configuration_check={mandatory:{},optional:{uri:function(b){/^sip:/i.test(b)||(b=g.C.SIP+":"+b);if((b=g.URI.parse(b))&&b.user)return b},wsServers:function(b){var e,a,f;if("string"===typeof b)b=[{ws_uri:b}];else if(b instanceof Array)for(a=b.length,e=0;e<a;e++)"string"===typeof b[e]&&(b[e]={ws_uri:b[e]});else return;if(0===b.length)return!1;a=b.length;for(e=0;e<a;e++){if(!b[e].ws_uri||
b[e].weight&&!Number(b[e].weight))return;f=g.Grammar.parse(b[e].ws_uri,"absoluteURI");if(-1===f||"wss"!==f.scheme&&"ws"!==f.scheme)return;b[e].sip_uri="<sip:"+f.host+(f.port?":"+f.port:"")+";transport=ws;lr>";b[e].weight||(b[e].weight=0);b[e].status=0;b[e].scheme=f.scheme.toUpperCase()}return b},authorizationUser:function(b){if(-1!==g.Grammar.parse('"'+b+'"',"quoted_string"))return b},connectionRecoveryMaxInterval:function(b){if(g.Utils.isDecimal(b)&&(b=Number(b),0<b))return b},connectionRecoveryMinInterval:function(b){if(g.Utils.isDecimal(b)&&
(b=Number(b),0<b))return b},displayName:function(b){if(-1!==g.Grammar.parse('"'+b+'"',"displayName"))return b},hackViaTcp:function(b){if("boolean"===typeof b)return b},hackIpInContact:function(b){if("boolean"===typeof b)return b},hackWssInTransport:function(b){if("boolean"===typeof b)return b},instanceId:function(b){if("string"===typeof b&&(/^uuid:/i.test(b)&&(b=b.substr(5)),-1!==g.Grammar.parse(b,"uuid")))return b},noAnswerTimeout:function(b){if(g.Utils.isDecimal(b)&&(b=Number(b),0<b))return b},
password:function(b){return String(b)},rel100:function(b){return b===g.C.supported.REQUIRED?g.C.supported.REQUIRED:b===g.C.supported.SUPPORTED?g.C.supported.SUPPORTED:g.C.supported.UNSUPPORTED},register:function(b){if("boolean"===typeof b)return b},registerExpires:function(b){if(g.Utils.isDecimal(b)&&(b=Number(b),0<b))return b},registrarServer:function(b){if("string"===typeof b&&(/^sip:/i.test(b)||(b=g.C.SIP+":"+b),(b=g.URI.parse(b))&&!b.user))return b},stunServers:function(b){var e,a,f;if("string"===
typeof b)b=[b];else if(!(b instanceof Array))return;a=b.length;for(e=0;e<a;e++){f=b[e];/^stuns?:/.test(f)||(f="stun:"+f);if(-1===g.Grammar.parse(f,"stun_URI"))return;b[e]=f}return b},traceSip:function(b){if("boolean"===typeof b)return b},turnServers:function(b){var e,a,f,h;b instanceof Array||(b=[b]);a=b.length;for(e=0;e<a;e++){f=b[e];f.server&&(f.urls=[f.server]);if(!f.urls||!f.username||!f.password)return;f.urls instanceof Array||(f.urls=[f.urls]);a=f.urls.length;for(e=0;e<a;e++)if(h=f.urls[e],
/^turns?:/.test(h)||(h="turn:"+h),-1===g.Grammar.parse(h,"turn_URI"))return}return b},userAgentString:function(b){if("string"===typeof b)return b},usePreloadedRoute:function(b){if("boolean"===typeof b)return b},wsServerMaxReconnection:function(b){if(g.Utils.isDecimal(b)&&(b=Number(b),0<b))return b},wsServerReconnectionTimeout:function(b){if(g.Utils.isDecimal(b)&&(b=Number(b),0<b))return b},autostart:function(b){if("boolean"===typeof b)return b},mediaHandlerFactory:function(b){if(b instanceof Function)return b}}};
e.C=f;g.UA=e}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],173:[function(h,k,l){k.exports=function(b){var g;g=function(e,f,c,d,a,g){var h,k;if(!c)throw new TypeError('missing or invalid "host" parameter');e=e||b.C.SIP;this.parameters={};this.headers={};for(h in a)this.setParam(h,a[h]);for(k in g)this.setHeader(k,g[k]);Object.defineProperties(this,{scheme:{get:function(){return e},set:function(a){e=a.toLowerCase()}},user:{get:function(){return f},
set:function(a){f=a}},host:{get:function(){return c},set:function(a){c=a.toLowerCase()}},port:{get:function(){return d},set:function(a){d=0===a?a:parseInt(a,10)||null}}})};g.prototype={setParam:function(b,f){b&&(this.parameters[b.toLowerCase()]="undefined"===typeof f||null===f?null:f.toString().toLowerCase())},getParam:function(b){if(b)return this.parameters[b.toLowerCase()]},hasParam:function(b){if(b)return this.parameters.hasOwnProperty(b.toLowerCase())&&!0||!1},deleteParam:function(b){var f;b=
b.toLowerCase();if(this.parameters.hasOwnProperty(b))return f=this.parameters[b],delete this.parameters[b],f},clearParams:function(){this.parameters={}},setHeader:function(e,f){this.headers[b.Utils.headerize(e)]=f instanceof Array?f:[f]},getHeader:function(e){if(e)return this.headers[b.Utils.headerize(e)]},hasHeader:function(e){if(e)return this.headers.hasOwnProperty(b.Utils.headerize(e))&&!0||!1},deleteHeader:function(e){var f;e=b.Utils.headerize(e);if(this.headers.hasOwnProperty(e))return f=this.headers[e],
delete this.headers[e],f},clearHeaders:function(){this.headers={}},clone:function(){return new g(this.scheme,this.user,this.host,this.port,JSON.parse(JSON.stringify(this.parameters)),JSON.parse(JSON.stringify(this.headers)))},toString:function(){var e,f,c,d,a=[];d=this.scheme+":";this.scheme.match("^sips?$")||(d+="//");this.user&&(d+=b.Utils.escapeUser(this.user)+"@");d+=this.host;if(this.port||0===this.port)d+=":"+this.port;for(f in this.parameters)d+=";"+f,null!==this.parameters[f]&&(d+="="+this.parameters[f]);
for(e in this.headers)for(c in this.headers[e])a.push(e+"="+this.headers[e][c]);0<a.length&&(d+="?"+a.join("&"));return d}};g.parse=function(e){e=b.Grammar.parse(e,"SIP_URI");if(-1!==e)return e};b.URI=g}},{}],174:[function(h,k,l){(function(b){k.exports=function(g){g.Utils={augment:function(b,f,c,d){var a,g;g=f.prototype;for(a in g)if(d||void 0===b[a])b[a]=g[a];f.apply(b,c)},optionsOverride:function(b,f,c,d,a,g){d&&b[c]&&a.warn(c+" is deprecated, please use "+f+" instead");b[f]&&b[c]&&a.warn(f+" overriding "+
c);b[f]=b[f]||b[c]||g},desugarSessionOptions:function(e){b.HTMLMediaElement&&e instanceof b.HTMLMediaElement&&(e={media:{constraints:{audio:!0,video:"VIDEO"===e.tagName},render:{remote:{video:e}}}});return e},str_utf8_length:function(b){return encodeURIComponent(b).replace(/%[A-F\d]{2}/g,"U").length},getPrefixedProperty:function(b,f){if(null!=b){var c=f.charAt(0).toUpperCase()+f.slice(1),c=[f,"webkit"+c,"moz"+c],d;for(d in c){var a=b[c[d]];if(a)return a}}},generateFakeSDP:function(b){if(b){var f=
b.indexOf("o="),c=b.indexOf("\r\n",f);return"v=0\r\n"+b.slice(f,c)+"\r\ns=-\r\nt=0 0\r\nc=IN IP4 0.0.0.0"}},isFunction:function(b){return void 0!==b?"[object Function]"===Object.prototype.toString.call(b):!1},isDecimal:function(b){return!isNaN(b)&&parseFloat(b)===parseInt(b,10)},createRandomToken:function(b,f){var c,d,a="";f=f||32;for(c=0;c<b;c++)d=Math.random()*f|0,a+=d.toString(f);return a},newTag:function(){return g.Utils.createRandomToken(g.UA.C.TAG_LENGTH)},newUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(b){var f=16*Math.random()|0;return("x"===b?f:f&3|8).toString(16)})},hostType:function(b){if(b&&(b=g.Grammar.parse(b,"host"),-1!==b))return b.host_type},normalizeTarget:function(b,f){var c,d;if(b){if(b instanceof g.URI)return b;if("string"===typeof b){d=b.split("@");switch(d.length){case 1:if(!f)return;c=b;d=f;break;case 2:c=d[0];d=d[1];break;default:c=d.slice(0,d.length-1).join("@"),d=d[d.length-1]}c=c.replace(/^(sips?|tel):/i,"");/^[\-\.\(\)]*\+?[0-9\-\.\(\)]+$/.test(c)&&(c=c.replace(/[\-\.\(\)]/g,
""));b=g.C.SIP+":"+g.Utils.escapeUser(c)+"@"+d;if(c=g.URI.parse(b))return c}}},escapeUser:function(b){return encodeURIComponent(decodeURIComponent(b)).replace(/%3A/ig,":").replace(/%2B/ig,"+").replace(/%3F/ig,"?").replace(/%2F/ig,"/")},headerize:function(b){var f={"Call-Id":"Call-ID",Cseq:"CSeq",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"};b=b.toLowerCase().replace(/_/g,"-").split("-");var c="",d=b.length,a;for(a=0;a<d;a++)0!==a&&(c+="-"),c+=b[a].charAt(0).toUpperCase()+b[a].substring(1);
f[c]&&(c=f[c]);return c},sipErrorCause:function(b){for(var f in g.C.SIP_ERROR_CAUSES)if(-1!==g.C.SIP_ERROR_CAUSES[f].indexOf(b))return g.C.causes[f];return g.C.causes.SIP_FAILURE_CODE},getRandomTestNetIP:function(){return"192.0.2."+Math.floor(254*Math.random()+1)},getAllowedMethods:function(b){var f,c=g.UA.C.ALLOWED_METHODS.toString();for(f in g.UA.C.EVENT_METHODS)b.checkListener(f)&&(c+=","+g.UA.C.EVENT_METHODS[f]);return c},calculateMD5:function(b){function f(a,b){var c,d,e,f,g;e=a&2147483648;f=
b&2147483648;c=a&1073741824;d=b&1073741824;g=(a&1073741823)+(b&1073741823);return c&d?g^2147483648^e^f:c|d?g&1073741824?g^3221225472^e^f:g^1073741824^e^f:g^e^f}function c(a,b,c,d,e,g,h){a=f(a,f(f(b&c|~b&d,e),h));return f(a<<g|a>>>32-g,b)}function d(a,b,c,d,e,g,h){a=f(a,f(f(b&d|c&~d,e),h));return f(a<<g|a>>>32-g,b)}function a(a,b,c,d,e,g,h){a=f(a,f(f(b^c^d,e),h));return f(a<<g|a>>>32-g,b)}function g(a,b,c,d,e,h,k){a=f(a,f(f(c^(b|~d),e),k));return f(a<<h|a>>>32-h,b)}function h(a){var b="",c="",d;for(d=
0;3>=d;d++)c=a>>>8*d&255,c="0"+c.toString(16),b+=c.substr(c.length-2,2);return b}var k=[],l,A,z,w,r,v,t,u;b=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b}(b);k=function(a){var b,c=a.length;b=c+8;for(var d=16*((b-b%64)/64+1),e=Array(d-1),f=0,g=0;g<c;)b=(g-g%4)/
4,f=g%4*8,e[b]|=a.charCodeAt(g)<<f,g++;b=(g-g%4)/4;e[b]|=128<<g%4*8;e[d-2]=c<<3;e[d-1]=c>>>29;return e}(b);r=1732584193;v=4023233417;t=2562383102;u=271733878;for(b=0;b<k.length;b+=16)l=r,A=v,z=t,w=u,r=c(r,v,t,u,k[b+0],7,3614090360),u=c(u,r,v,t,k[b+1],12,3905402710),t=c(t,u,r,v,k[b+2],17,606105819),v=c(v,t,u,r,k[b+3],22,3250441966),r=c(r,v,t,u,k[b+4],7,4118548399),u=c(u,r,v,t,k[b+5],12,1200080426),t=c(t,u,r,v,k[b+6],17,2821735955),v=c(v,t,u,r,k[b+7],22,4249261313),r=c(r,v,t,u,k[b+8],7,1770035416),
u=c(u,r,v,t,k[b+9],12,2336552879),t=c(t,u,r,v,k[b+10],17,4294925233),v=c(v,t,u,r,k[b+11],22,2304563134),r=c(r,v,t,u,k[b+12],7,1804603682),u=c(u,r,v,t,k[b+13],12,4254626195),t=c(t,u,r,v,k[b+14],17,2792965006),v=c(v,t,u,r,k[b+15],22,1236535329),r=d(r,v,t,u,k[b+1],5,4129170786),u=d(u,r,v,t,k[b+6],9,3225465664),t=d(t,u,r,v,k[b+11],14,643717713),v=d(v,t,u,r,k[b+0],20,3921069994),r=d(r,v,t,u,k[b+5],5,3593408605),u=d(u,r,v,t,k[b+10],9,38016083),t=d(t,u,r,v,k[b+15],14,3634488961),v=d(v,t,u,r,k[b+4],20,3889429448),
r=d(r,v,t,u,k[b+9],5,568446438),u=d(u,r,v,t,k[b+14],9,3275163606),t=d(t,u,r,v,k[b+3],14,4107603335),v=d(v,t,u,r,k[b+8],20,1163531501),r=d(r,v,t,u,k[b+13],5,2850285829),u=d(u,r,v,t,k[b+2],9,4243563512),t=d(t,u,r,v,k[b+7],14,1735328473),v=d(v,t,u,r,k[b+12],20,2368359562),r=a(r,v,t,u,k[b+5],4,4294588738),u=a(u,r,v,t,k[b+8],11,2272392833),t=a(t,u,r,v,k[b+11],16,1839030562),v=a(v,t,u,r,k[b+14],23,4259657740),r=a(r,v,t,u,k[b+1],4,2763975236),u=a(u,r,v,t,k[b+4],11,1272893353),t=a(t,u,r,v,k[b+7],16,4139469664),
v=a(v,t,u,r,k[b+10],23,3200236656),r=a(r,v,t,u,k[b+13],4,681279174),u=a(u,r,v,t,k[b+0],11,3936430074),t=a(t,u,r,v,k[b+3],16,3572445317),v=a(v,t,u,r,k[b+6],23,76029189),r=a(r,v,t,u,k[b+9],4,3654602809),u=a(u,r,v,t,k[b+12],11,3873151461),t=a(t,u,r,v,k[b+15],16,530742520),v=a(v,t,u,r,k[b+2],23,3299628645),r=g(r,v,t,u,k[b+0],6,4096336452),u=g(u,r,v,t,k[b+7],10,1126891415),t=g(t,u,r,v,k[b+14],15,2878612391),v=g(v,t,u,r,k[b+5],21,4237533241),r=g(r,v,t,u,k[b+12],6,1700485571),u=g(u,r,v,t,k[b+3],10,2399980690),
t=g(t,u,r,v,k[b+10],15,4293915773),v=g(v,t,u,r,k[b+1],21,2240044497),r=g(r,v,t,u,k[b+8],6,1873313359),u=g(u,r,v,t,k[b+15],10,4264355552),t=g(t,u,r,v,k[b+6],15,2734768916),v=g(v,t,u,r,k[b+13],21,1309151649),r=g(r,v,t,u,k[b+4],6,4149444226),u=g(u,r,v,t,k[b+11],10,3174756917),t=g(t,u,r,v,k[b+2],15,718787259),v=g(v,t,u,r,k[b+9],21,3951481745),r=f(r,l),v=f(v,A),t=f(t,z),u=f(u,w);return(h(r)+h(v)+h(t)+h(u)).toLowerCase()}}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==
typeof window?window:{})},{}],175:[function(h,k,l){k.exports=function(b,g,e,f){var c;c={};c.MediaHandler=e;c.MediaStreamManager=f;var d;c.isSupported=function(){if(void 0!==d)return d;c.MediaStream=b.getPrefixedProperty(g,"MediaStream");c.getUserMedia=b.getPrefixedProperty(g.navigator,"getUserMedia");c.RTCPeerConnection=b.getPrefixedProperty(g,"RTCPeerConnection");c.RTCSessionDescription=b.getPrefixedProperty(g,"RTCSessionDescription");c.getUserMedia&&c.RTCPeerConnection&&c.RTCSessionDescription?
(c.getUserMedia=c.getUserMedia.bind(g.navigator),d=!0):d=!1;return d};return c}},{}],176:[function(h,k,l){k.exports=function(b){var g=function(e,f){function c(a,b){if(a.mediaStreamManager.on&&a.mediaStreamManager.checkEvent&&a.mediaStreamManager.checkEvent(b))a.mediaStreamManager.on(b,function(){a.emit.apply(a,[b].concat(Array.prototype.slice.call(arguments)))})}f=f||{};this.logger=e.ua.getLogger("sip.invitecontext.mediahandler",e.id);this.session=e;this.localMedia=null;this.ready=!0;this.mediaStreamManager=
f.mediaStreamManager||new b.WebRTC.MediaStreamManager(this.logger);this.videoMuted=this.audioMuted=!1;var d,a,g,h=this,k=[];d=f.stunServers||null;var l=f.turnServers||null;a=this.session.ua.configuration;this.RTCConstraints=f.RTCConstraints||{};d||(d=a.stunServers);l||(l=a.turnServers);[].concat(d).forEach(function(a){k.push({url:a})});a=l.length;for(d=0;d<a;d++)g=l[d],k.push({url:g.urls,username:g.username,credential:g.password});this.peerConnection=new b.WebRTC.RTCPeerConnection({iceServers:k},
this.RTCConstraints);this.peerConnection.onaddstream=function(a){h.logger.log("stream added: "+a.stream.id);h.render();h.emit("addStream",a)};this.peerConnection.onremovestream=function(a){h.logger.log("stream removed: "+a.stream.id)};this.peerConnection.onicecandidate=function(a){h.emit("iceCandidate",a);if(a.candidate)h.logger.log("ICE candidate received: "+(null===a.candidate.candidate?null:a.candidate.candidate.trim()));else if(void 0!==h.onIceCompleted)h.onIceCompleted(this);else h.callOnIceCompleted=
!0};this.peerConnection.onicegatheringstatechange=function(){h.logger.log("RTCIceGatheringState changed: "+this.iceGatheringState);"gathering"===this.iceGatheringState&&h.emit("iceGathering",this);if("complete"===this.iceGatheringState)if(void 0!==h.onIceCompleted)h.onIceCompleted(this);else h.callOnIceCompleted=!0};this.peerConnection.oniceconnectionstatechange=function(){h.logger.log('ICE connection state changed to "'+this.iceConnectionState+'"');"failed"===this.iceConnectionState&&h.emit("iceFailed",
this)};this.peerConnection.onstatechange=function(){h.logger.log('PeerConnection state changed to "'+this.readyState+'"')};this.initEvents("userMediaRequest userMedia userMediaFailed iceGathering iceCandidate iceComplete iceFailed getDescription setDescription dataChannel addStream".split(" "));c(this,"userMediaRequest");c(this,"userMedia");c(this,"userMediaFailed")};g.defaultFactory=function(b,f){return new g(b,f)};g.defaultFactory.isSupported=function(){return b.WebRTC.isSupported()};g.prototype=
Object.create(b.MediaHandler.prototype,{isReady:{writable:!0,value:function(){return this.ready}},close:{writable:!0,value:function(){this.logger.log("closing PeerConnection");this.peerConnection&&"closed"!==this.peerConnection.signalingState&&(this.peerConnection.close(),this.localMedia&&this.mediaStreamManager.release(this.localMedia))}},getDescription:{writable:!0,value:function(b,f,c){function d(){g.hasOffer("remote")?g.peerConnection.ondatachannel=function(a){g.dataChannel=a.channel;g.emit("dataChannel",
g.dataChannel)}:c.dataChannel&&g.peerConnection.createDataChannel&&(g.dataChannel=g.peerConnection.createDataChannel("sipjs",c.dataChannel),g.emit("dataChannel",g.dataChannel));g.render();g.createOfferOrAnswer(b,f,g.RTCConstraints)}function a(a){g.logger.log("acquired local media stream");g.localMedia=a;g.session.connecting();g.addStream(a,d,f)}var g=this;c=c||{};!0===c.dataChannel&&(c.dataChannel={});this.mediaHint=c;g.localMedia?(g.logger.log("already have local media"),d()):(g.logger.log("acquiring local media"),
g.mediaStreamManager.acquire(a,function(a){g.logger.error("unable to acquire stream");g.logger.error(a);g.session.connecting();f(a)},c))}},setDescription:{writable:!0,value:function(e,f,c){e={type:this.hasOffer("local")?"answer":"offer",sdp:e};this.emit("setDescription",e);e=new b.WebRTC.RTCSessionDescription(e);this.peerConnection.setRemoteDescription(e,f,c)}},isMuted:{writable:!0,value:function(){return{audio:this.audioMuted,video:this.videoMuted}}},mute:{writable:!0,value:function(b){if(0!==this.getLocalStreams().length){b=
b||{audio:0<this.getLocalStreams()[0].getAudioTracks().length,video:0<this.getLocalStreams()[0].getVideoTracks().length};var f=!1,c=!1;b.audio&&!this.audioMuted&&(this.audioMuted=f=!0,this.toggleMuteAudio(!0));b.video&&!this.videoMuted&&(this.videoMuted=c=!0,this.toggleMuteVideo(!0));if(f||c)return{audio:f,video:c}}}},unmute:{writable:!0,value:function(b){if(0!==this.getLocalStreams().length){b=b||{audio:0<this.getLocalStreams()[0].getAudioTracks().length,video:0<this.getLocalStreams()[0].getVideoTracks().length};
var f=!1,c=!1;b.audio&&this.audioMuted&&(f=!0,this.audioMuted=!1,this.toggleMuteAudio(!1));b.video&&this.videoMuted&&(c=!0,this.videoMuted=!1,this.toggleMuteVideo(!1));if(f||c)return{audio:f,video:c}}}},hold:{writable:!0,value:function(){this.toggleMuteAudio(!0);this.toggleMuteVideo(!0)}},unhold:{writable:!0,value:function(){this.audioMuted||this.toggleMuteAudio(!1);this.videoMuted||this.toggleMuteVideo(!1)}},getLocalStreams:{writable:!0,value:function(){var b=this.peerConnection;return b&&"closed"===
b.signalingState?(this.logger.warn("peerConnection is closed, getLocalStreams returning []"),[]):b.getLocalStreams&&b.getLocalStreams()||b.localStreams||[]}},getRemoteStreams:{writable:!0,value:function(){var b=this.peerConnection;return b&&"closed"===b.signalingState?(this.logger.warn("peerConnection is closed, getRemoteStreams returning []"),[]):b.getRemoteStreams&&b.getRemoteStreams()||b.remoteStreams||[]}},render:{writable:!0,value:function(e){e=e||this.mediaHint&&this.mediaHint.render;if(!e)return!1;
var f={local:"getLocalStreams",remote:"getRemoteStreams"};Object.keys(f).forEach(function(c){var d=this[f[c]]();d.length&&b.WebRTC.MediaStreamManager.render(d[0],e[c])}.bind(this))}},hasOffer:{writable:!0,value:function(b){return this.peerConnection.signalingState==="have-"+b+"-offer"}},createOfferOrAnswer:{writable:!0,value:function(e,f,c){function d(){var a=h.peerConnection.localDescription.sdp,a=b.Hacks.Chrome.needsExplicitlyInactiveSDP(a),a=b.Hacks.AllBrowsers.unmaskDtls(a),a=b.Hacks.Firefox.hasIncompatibleCLineWithSomeSIPEndpoints(a),
a={type:"createOffer"===k?"offer":"answer",sdp:a};h.emit("getDescription",a);h.ready=!0;e(a.sdp)}function a(){if("connected"===h.peerConnection.iceConnectionState||"completed"===h.peerConnection.iceConnectionState)d();else if(h.onIceCompleted=function(a){h.logger.log("ICE Gathering Completed");h.onIceCompleted=void 0;h.emit("iceComplete",a);d()},h.callOnIceCompleted)h.onIceCompleted()}function g(a,b){h.logger.error("peerConnection."+a+" failed");h.logger.error(b);h.ready=!0;f(b)}var h=this,k;h.ready=
!1;k=h.hasOffer("remote")?"createAnswer":"createOffer";h.peerConnection[k](function(b){h.peerConnection.setLocalDescription(b,a,g.bind(null,"setLocalDescription"))},g.bind(null,k),c)}},addStream:{writable:!0,value:function(b,f,c){try{this.peerConnection.addStream(b)}catch(d){this.logger.error("error adding stream");this.logger.error(d);c(d);return}f()}},toggleMuteHelper:{writable:!0,value:function(b,f){this.getLocalStreams().forEach(function(c){c[b]().forEach(function(b){b.enabled=!f})})}},toggleMuteAudio:{writable:!0,
value:function(b){this.toggleMuteHelper("getAudioTracks",b)}},toggleMuteVideo:{writable:!0,value:function(b){this.toggleMuteHelper("getVideoTracks",b)}}});return g}},{}],177:[function(h,k,l){k.exports=function(b){var g=function(e,f){if(!b.WebRTC.isSupported())throw new b.Exceptions.NotSupportedError("Media not supported");this.mediaHint=f||{constraints:{audio:!0,video:!0}};this.logger=e;this.initEvents(["userMediaRequest","userMedia","userMediaFailed"]);this.acquisitions={}};g.streamId=function(b){return b.getAudioTracks().concat(b.getVideoTracks()).map(function(b){return b.id}).join("")};
g.render=function(e,f){function c(b,c){(window.attachMediaStream||d)(b,c);a(b)}function d(a,b){if("undefined"!==typeof a.src)URL.revokeObjectURL(a.src),a.src=URL.createObjectURL(b);else if("undefined"!==typeof(a.srcObject||a.mozSrcObject))a.srcObject=a.mozSrcObject=b;else return!1;return!0}function a(a){a.ensurePlayingIntervalId=b.Timers.setInterval(function(){a.paused?a.play():b.Timers.clearInterval(a.ensurePlayingIntervalId)},100)}if(!f)return!1;f.video&&(f.audio&&(f.video.volume=0),c(f.video,e));
f.audio&&c(f.audio,e)};g.prototype=Object.create(b.EventEmitter.prototype,{acquire:{value:function(e,f,c){c=Object.keys(c||{}).length?c:this.mediaHint;var d=function(a,b,c){var d=g.streamId(b);this.acquisitions[d]=!!c;a(b)}.bind(this,e);if(c.stream)d(c.stream,!0);else{var a=c.constraints||this.mediaHint&&this.mediaHint.constraints||{audio:!0,video:!0};b.Timers.setTimeout(function(){this.emit("userMediaRequest",a);var c=function(a,b){var c=Array.prototype.slice.call(arguments,2),d=[a].concat(c);this.emit.apply(this,
d);b.apply(null,c)}.bind(this);b.WebRTC.getUserMedia(a,c.bind(this,"userMedia",d),c.bind(this,"userMediaFailed",f))}.bind(this),0)}}},release:{value:function(b){var f=g.streamId(b);!1===this.acquisitions[f]&&b.stop();delete this.acquisitions[f]}}});return g}},{}],178:[function(h,k,l){l.XMLHttpRequest=XMLHttpRequest},{}],179:[function(h,k,l){k.exports={name:"twilio-conversations",title:"Twilio Conversations",description:"Twilio Conversations JavaScript library",version:"0.7.1",homepage:"https://twilio.com",
author:"Mark Andrus Roberts <mroberts@twilio.com>",keywords:["twilio","webrtc","library","javascript"],devDependencies:{browserify:"^9.0.3",cheerio:"^0.18.0",closurecompiler:"^1.5.1",jsdoc:"^3.3.0-beta2",jshint:"^2.6.3","jshint-stylish":"^1.0.0",jsonwebtoken:"^5.0.0",mocha:"^1.21.5",promptly:"^0.2.0",q:"^1.0.1",twilio:"*"},engines:{node:">=0.12"},license:"MIT","private":!0,scripts:{test:"make test"},dependencies:{"es6-map":"^0.1.1","es6-set":"^0.1.1","sip.js":"^0.6.4",ws:"^0.6.3",xmlhttprequest:"https://github.com/markandrus/node-XMLHttpRequest.git"}}},
{}],180:[function(h,k,l){(function(b){function g(){Object.defineProperties(this,{Endpoint:{enumerable:!0,value:e},getUserMedia:{enumerable:!0,value:f},LocalMedia:{enumerable:!0,value:c}});return this}var e=h("../lib/endpoint"),f=h("../lib/webrtc/getusermedia"),c=h("../lib/media").LocalMedia;(b.Twilio=b.Twilio||new g).Endpoint||g.call(b.Twilio)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../lib/endpoint":2,"../lib/media":4,
"../lib/webrtc/getusermedia":26}]},{},[180]);
